<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Command-line Arguments</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Command-line Arguments</h1></strong><br />• <code>argc</code> is the number of arguments passed<br />• <code>argv[]</code> is a pointer array which points to each argument passed to the program<br />   ◇ <code>argv[0]</code> holds the name of the executable itself<br /><br />• All arguments have to be <code>char *</code><br />   ◇ You can convert them after<br />      ▪ <code>atoi()</code> for char * to int<br />      ▪ <code>strncpy()</code> for char * to char[]<br />      ▪ <code>wcscpy_s()</code> for wchar_t* to wchar_t[]<br /><br /><strong>Libraries for cmdline args:</strong><br /><a href="https://stackoverflow.com/questions/9642732/parsing-command-line-arguments-in-c">https://stackoverflow.com/questions/9642732/parsing-command-line-arguments-in-c</a><br />• POSIX library - <code>getopt</code> - <code>#include &lt;unistd.h&gt;</code> (can handle simple argument parsing)<br />• GNU C library - <code>argp</code> - <code>#include &lt;argp.h&gt;</code> (can handle more complex argument parsing)<br /><br /><strong><h2>Examples</h2></strong><br /><strong>Generic usage</strong><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;stdio.h&gt;<br />#include&nbsp;&lt;stdlib.h&gt;<br /><br />int&nbsp;main(int&nbsp;argc,&nbsp;char&nbsp;*argv[])<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(argc&nbsp;!=&nbsp;4)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(stderr,&nbsp;&quot;[error]&nbsp;not&nbsp;enough&nbsp;arguments&nbsp;:/&quot;);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Usage:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;./hello&nbsp;&lt;first&nbsp;name&gt;&nbsp;&lt;last&nbsp;name&gt;&nbsp;&lt;age&gt;&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Example&nbsp;#1:&nbsp;./hello&nbsp;timmy&nbsp;toucan&nbsp;43&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(EXIT_FAILURE);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;*arg_first&nbsp;=&nbsp;argv[1];<br />&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;*arg_last&nbsp;=&nbsp;argv[2];<br />&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;arg_age&nbsp;=&nbsp;atoi(argv[3]);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Hello,&nbsp;%s&nbsp;%s&nbsp;:)&nbsp;\n&quot;,&nbsp;arg_first,&nbsp;arg_last);<br />&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;-&nbsp;you&#39;re&nbsp;%d&nbsp;years&nbsp;old&nbsp;\n&quot;,&nbsp;arg_age);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><strong><code>wcscpy_s()</code></strong><strong> for wchar_t* to wchar_t[]</strong><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;stdio.h&gt;<br />#include&nbsp;&lt;Windows.h&gt;<br /><br />int&nbsp;wmain(int&nbsp;argc,&nbsp;wchar_t*&nbsp;argv[])<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;wchar_t&nbsp;arg_filename[MAX_PATH];<br />&nbsp;&nbsp;&nbsp;&nbsp;wcscpy_s(arg_filename,&nbsp;MAX_PATH,&nbsp;argv[1]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><strong>cba to write switch statements but still want modes - quick and easy way</strong><br />Source is from <code>xor_file</code><br />strcmp arguments to choose mode of program to run.<br /><div class="codebox"><div class="codebox">	//&nbsp;3&nbsp;arguments&nbsp;required&nbsp;to&nbsp;run<br />	if&nbsp;(argc&nbsp;!=&nbsp;3)<br />	{<br />		printf(&quot;\n[!]&nbsp;arguments&nbsp;used&nbsp;incorrectly&nbsp;\n&quot;);<br />		printUsage();<br />		return&nbsp;EXIT_FAILURE;<br />	}<br /><br />	/*<br />	This&nbsp;isn&#39;t&nbsp;a&nbsp;very&nbsp;good&nbsp;way&nbsp;of&nbsp;deciding&nbsp;what&nbsp;mode&nbsp;to&nbsp;run&nbsp;in&nbsp;-&nbsp;encrypt&nbsp;or&nbsp;decrypt.<br />	But&nbsp;it&#39;s&nbsp;quick,&nbsp;easy,&nbsp;doesn&#39;t&nbsp;use&nbsp;external&nbsp;libraries,&nbsp;can&nbsp;be&nbsp;changed&nbsp;later&nbsp;if&nbsp;needed,&nbsp;and&nbsp;no&nbsp;one&nbsp;is&nbsp;really&nbsp;going&nbsp;to&nbsp;use&nbsp;this&nbsp;code&nbsp;anyway&nbsp;so&nbsp;it&nbsp;doesn&#39;t&nbsp;matter.<br />	*/<br /><br />	//&nbsp;if&nbsp;&#39;encrypt&#39;&nbsp;specified&nbsp;-&gt;&nbsp;encrypt&nbsp;file<br />	if&nbsp;(wcsncmp(argv[1],&nbsp;L&quot;encrypt&quot;,&nbsp;8)&nbsp;==&nbsp;0)<br />	{<br />		printf(&quot;-&nbsp;running&nbsp;in&nbsp;encrypt&nbsp;mode&nbsp;\n&quot;);<br />		encryptDecrypt(arg_filename,&nbsp;L&quot;encrypted.dat&quot;);<br />	}<br />	//&nbsp;if&nbsp;&#39;decrypt&#39;&nbsp;specified&nbsp;-&gt;&nbsp;decrypt&nbsp;file<br />	else&nbsp;if&nbsp;(wcsncmp(argv[1],&nbsp;L&quot;decrypt&quot;,&nbsp;8)&nbsp;==&nbsp;0)<br />	{<br />		printf(&quot;-&nbsp;running&nbsp;in&nbsp;decrypt&nbsp;mode&nbsp;\n&quot;);<br />		encryptDecrypt(arg_filename,&nbsp;L&quot;unencrypted.exe&quot;);<br />	}<br />	//&nbsp;if&nbsp;&#39;encrypt&#39;&nbsp;or&nbsp;&#39;decrypt&#39;&nbsp;not&nbsp;specified/used&nbsp;wrong&nbsp;-&gt;&nbsp;print&nbsp;usage<br />	else<br />	<span style="color:#000000;font-weight:400">{</span><br />		printf(&quot;\n[!]&nbsp;arguments&nbsp;used&nbsp;incorrectly&nbsp;\n&quot;);<br />		printUsage();<br />		return&nbsp;EXIT_FAILURE;<br />	<span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><br /><strong><h2>## Using - (dashes)</h2></strong><br />Source: <a href="https://github.com/torvalds/pesconvert/blob/master/main.c">https://github.com/torvalds/pesconvert/blob/master/main.c</a><br /><div class="codebox"><div class="codebox">for&nbsp;(i&nbsp;=&nbsp;1;&nbsp;i&nbsp;&lt;&nbsp;argc;&nbsp;i++)&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />	const&nbsp;char&nbsp;*arg&nbsp;=&nbsp;argv[i];<br /><br />	if&nbsp;(*arg&nbsp;==&nbsp;&#39;-&#39;)&nbsp;{<br />		switch&nbsp;(arg[1])&nbsp;{<br />		case&nbsp;&#39;s&#39;:<br />			outputsize&nbsp;=&nbsp;atoi(argv[i+1]);<br />			i++;<br />			continue;<br />		case&nbsp;&#39;d&#39;:<br />			density&nbsp;=&nbsp;atof(argv[i+1]);<br />			i++;<br />			continue;<br />		}<br />		die(&quot;Unknown&nbsp;argument&nbsp;&#39;%s&#39;\n&quot;,&nbsp;arg);<br />	}<br /><br />	if&nbsp;(!pes.blocks)&nbsp;{<br />		if&nbsp;(read_path(arg,&nbsp;&amp;region))<br />			die(&quot;Unable&nbsp;to&nbsp;read&nbsp;file&nbsp;%s&nbsp;(%s)\n&quot;,&nbsp;arg,&nbsp;strerror(errno));<br /><br />		if&nbsp;(parse_pes(&amp;region,&nbsp;&amp;pes)&nbsp;&lt;&nbsp;0)<br />			die(&quot;Unable&nbsp;to&nbsp;parse&nbsp;PES&nbsp;file\n&quot;);<br />		continue;<br />	}<br /><br />	if&nbsp;(!output)&nbsp;{<br />		output&nbsp;=&nbsp;arg;<br />		continue;<br />	}<br /><br />	die(&quot;Too&nbsp;many&nbsp;arguments&nbsp;(%s)\n&quot;,&nbsp;arg);<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
