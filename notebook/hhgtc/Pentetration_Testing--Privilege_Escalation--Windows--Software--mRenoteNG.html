<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>mRenoteNG</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># mRemoteNG</h1></strong><br /><a href="https://mremoteng.org/">https://mremoteng.org/</a> <br />mRemoteNG is a remote connection manager for Windows. <br />It can store and manage a number of different connections, chief among them RDP,VNC, and SSH. <br />It&#39;s a popular tool among IT support people who have to remote into a lot of machines.<br /><br /><strong><h2>## Extract Passwords</h2></strong><br />mRemoteNG doesn&#39;t store passwords securely, so it&#39;s fairly trivial to extract passwords.<br />The config file, which holds all the connections and their passwords for mRemoteNG, is stored in:<br /><code>C:\Users\&lt;username&gt;\AppData\Roaming\mRemoteNG\confCons.xml</code><br /><br /><strong>Links</strong><br />• Metasploit module<br />   ◇ <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mremote.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/mremote.rb</a><br />• Explanation by the author of the metasploit tool<br />   ◇ <a href="https://cosine-security.blogspot.com/2011/06/stealing-password-from-mremote.html">https://cosine-security.blogspot.com/2011/06/stealing-password-from-mremote.html</a><br />• Alternative to metasploit exploit<br />   ◇ <a href="https://packetstormsecurity.com/files/126309/mRemoteOffPwdsDecrypt.rb.txt">https://packetstormsecurity.com/files/126309/mRemoteOffPwdsDecrypt.rb.txt</a><br />• Good tutorial on how to extract passwords - 3 methods - VERY USEFUL<br />   ◇ <a href="http://hackersvanguard.com/mremoteng-insecure-password-storage/">http://hackersvanguard.com/mremoteng-insecure-password-storage/</a><br /><br /><strong>Examples</strong><br />• hackthebox Bastion<br /><br /><strong><h3>### How-to (Example from hackthebox Bastion)</h3></strong><br />I used a windows 10 machine because windows 7 required .NET. <br />Download the portable version of the app, extract etc. - <a href="https://mremoteng.org/download">https://mremoteng.org/download</a><br /><br />Boot mRemoteNG once, then close it.<br />Inside mRemoteNG&#39;s folder you&#39;ll see a confCons.xml file.<br /><a href=""><img src="images/364-1.png" alt="images/364-1.png" /></a><br /><br />It should look like this:<br /><a href=""><img src="images/364-2.png" alt="images/364-2.png" /></a><br />(the <code>Protected</code> value changes every time)<br /><br />Open mRemoteNG and add a new connection with random junk data.<br /><a href=""><img src="images/364-3.png" alt="images/364-3.png" /></a><br /><br /><a href=""><img src="images/364-4.png" alt="images/364-4.png" /></a><br /><br />Your confCons.xml file should now look like this, with your newly input connection configuration in it:<br /><a href=""><img src="images/364-5.png" alt="images/364-5.png" /></a><br /><br />Now you have the format of the xml file in which you can dump the mRemoteNG configurations from the Bastion box.<br /><br />Close mRemoteNG.<br /><br />Copy/paste the configurations (both the <code>&lt;Node</code> values) from Bastion&#39;s confCons.xml file:<br /><a href=""><img src="images/364-6.png" alt="images/364-6.png" /></a><br /><br />into mRemoteNG&#39;s confCons.xml file and save it.<br />Open up mRemoteNG again and you should see 2 connections.<br /><a href=""><img src="images/364-7.png" alt="images/364-7.png" /></a><br /><br />Tools &gt; External Tools<br /><a href=""><img src="images/364-8.png" alt="images/364-8.png" /></a><br /><br />Create a ‘tool’ to extract the password:<br /><a href=""><img src="images/364-9.png" alt="images/364-9.png" /></a><br /><br />If you&#39;ve read the config file you&#39;ll notice that the <code>DC</code> connection uses the username <code>Administrator</code>, so try extracting the password from the DC config.<br /><br />Right click DC &gt; External Tools &gt; password revealer<br /><a href=""><img src="images/364-10.png" alt="images/364-10.png" /></a><br /><br />And you&#39;ll get a password.<br /><a href=""><img src="images/364-11.png" alt="images/364-11.png" /></a><br /><br /></div>
</body>
</html>
