<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Tip to hit the EIP overwrite correctly</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Tip to hit the EIP overwrite correctly</h1></strong><br />To give yourself some leniency, because the offset to EIP might differ between systems because of environment variables etc., just write your EIP overwrite to the stack multiple times within the buffer you&#39;re overflowing.<br /><br />For example, the offset to EIP is 80 bytes.<br />Instead of doing<br /><div class="codebox"><div class="codebox">payload&nbsp;&nbsp;=&nbsp;“A”*80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;EIP<br />payload&nbsp;+=&nbsp;“B”*4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;overwrite&nbsp;EIP<br /><br />print&nbsp;payload</div></div><br /><br />Do<br /><div class="codebox"><div class="codebox">payload&nbsp;&nbsp;=&nbsp;“A”*72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;EIP&nbsp;@&nbsp;80<br />payload&nbsp;+=&nbsp;“B”*12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;overwrite&nbsp;EIP<br /><br />print&nbsp;payload</div></div><br /><br />You&#39;ve now written <code>0x42424242</code> - your desired return address, 3 times to the stack instead of just once.</div>
</body>
</html>
