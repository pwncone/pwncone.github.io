<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>FindWindow</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># FindWindow</h1></strong><br />Search the window class names of open programs on the system.<br />If a debugger is found, close your program.<br />The class name is not the title of the window.<br />You can use a program like Nirsoft&#39;s <code>WinLister</code> to find Window class names.<br />e.g. x64dbg&#39;s class name is <code>Qt5QWindowIcon</code><br /><br /><a href=""><img src="images/1775-1.png" alt="images/1775-1.png" /></a><br /><a href=""><img src="images/1775-2.png" alt="images/1775-2.png" /></a><br /><a href=""><img src="images/1775-3.png" alt="images/1775-3.png" /></a><br /><br /><strong><h2>## Code</h2></strong><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;stdio.h&gt;<br />#include&nbsp;&lt;Windows.h&gt;<br /><br />/*<br />Use&nbsp;a&nbsp;program&nbsp;like&nbsp;Nirsoft&#39;s&nbsp;winlister&nbsp;to&nbsp;find&nbsp;Window&nbsp;class&nbsp;names.<br />*/<br />BOOL&nbsp;FindDebugWindows(void)<br />{<br />	HANDLE&nbsp;h_window&nbsp;=&nbsp;NULL;<br />	BOOL&nbsp;debugger_found&nbsp;=&nbsp;FALSE;<br /><br />	//&nbsp;array&nbsp;of&nbsp;window&nbsp;class&nbsp;names<br />	char*&nbsp;class_names[]&nbsp;=<br />	{<br />		&quot;Qt5QWindowIcon&quot;,	//&nbsp;x64dbg,&nbsp;x32dbg,&nbsp;IDA<br />		&quot;OLLYDBG&quot;,			//&nbsp;ollydbg<br />		&quot;ID&quot;				//&nbsp;immunity&nbsp;debugger<br />	};<br /><br />	//&nbsp;loop&nbsp;through&nbsp;array&nbsp;and&nbsp;find&nbsp;windows&nbsp;with&nbsp;that&nbsp;class&nbsp;name<br />	int&nbsp;i&nbsp;=&nbsp;0;<br />	int&nbsp;class_names_size&nbsp;=&nbsp;sizeof(class_names)&nbsp;/&nbsp;sizeof(class_names[0]);<br />	for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;class_names_size;&nbsp;i++)<br />	{<br />		h_window&nbsp;=&nbsp;FindWindowExA(NULL,&nbsp;NULL,&nbsp;class_names[i],&nbsp;0);<br />		if&nbsp;(h_window)<br />		{<br />			debugger_found&nbsp;=&nbsp;TRUE;<br />			printf(&quot;[!]&nbsp;found&nbsp;%s&nbsp;\n&quot;,&nbsp;class_names[i]);<br />			break;<br />		}<br />	}<br /><br />	return&nbsp;debugger_found;<br />}<br /><br />int&nbsp;main(void)<br /><span style="color:#000000;font-weight:400">{</span><br />	BOOL&nbsp;debugger_present&nbsp;=&nbsp;FALSE;<br /><br />	debugger_present&nbsp;=&nbsp;FindDebugWindows();<br />	if&nbsp;(debugger_present&nbsp;==&nbsp;TRUE)<br />		return&nbsp;1;<br /><br />	printf(&quot;hey&nbsp;:)&nbsp;\n&quot;);<br /><br />	return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />A NOT GOOD implementation also here. Kept for reference.<br />• <a href="https://github.com/vectless/vipercheats-loader-source/blob/0c9284aed43ae98d86d2cecb4307a3ed8d73b799/utils.h#L36">https://github.com/vectless/vipercheats-loader-source/blob/0c9284aed43ae98d86d2cecb4307a3ed8d73b799/utils.h#L36</a><br /><br /><strong><h2>## Bypass</h2></strong><br />• Set a breakpoint on FindWindow, single step, then change the return value to 0.<br />   ◇ Source: <br />   ◇ <a href="https://github.com/cetfor/AntiDBG/blob/89f8fb7fb572aae326c2b0538e9e2b2cf56cf102/antidbg/antidbg.c#L109">https://github.com/cetfor/AntiDBG/blob/89f8fb7fb572aae326c2b0538e9e2b2cf56cf102/antidbg/antidbg.c#L109</a><br />• Hook FindWindow and modify to always return 0?<br />• Change the name of the window (possible but don&#39;t know how atm)</div>
</body>
</html>
