<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Modify local variables</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Techniques - Modify local variables</h1></strong><br />Sometimes modifying the local variables within a function is enough to achieve what you want.<br /><br /><strong>Examples</strong><br />• Protostar Stack 0 and Stack 1<br /><br />1. Overflow the vulnerable buffer<br />2. Overwrite whatever local variables you want<br /><br /><strong><h2>## Template</h2></strong><br /><div class="codebox"><div class="codebox">#!/usr/bin/env&nbsp;python<br /><br />import&nbsp;struct<br /><br />#&nbsp;PAYLOAD<br />#&nbsp;-----------------------------------------------------------<br />buffer&nbsp;=&nbsp;&quot;A&quot;&nbsp;*&nbsp;0<br />overwrite_var&nbsp;=&nbsp;struct.pack(&#39;&lt;I&#39;,&nbsp;0x42424242)&nbsp;&nbsp;&nbsp;#&nbsp;bytes&nbsp;to&nbsp;overwrite&nbsp;var&nbsp;with<br /><br />payload&nbsp;=&nbsp;buffer&nbsp;+&nbsp;overwrite_var<br /><br />#&nbsp;EXPLOIT<br />#&nbsp;-----------------------------------------------------------<br />print&nbsp;payload</div></div><br /><br /><strong><h2>## Explanation of the Stack &amp; Local Variables</h2></strong><br />Variables local to a function get stored on the stack.<br />The stack is a first in, last out structure.<br />Therefore, the first variable in the source code - <code>modified</code>, will be placed onto the stack first.<br />Next, <code>buffer</code> will be placed onto the stack, which is the second variable in the source code.<br /><br />The stack grows to lower memory addresses.<br />In this diagram, the stack grows upwards.<br /><br />Here&#39;s a diagram of the stack.<br /><div class="codebox"><div class="codebox">&lt;&nbsp;low&nbsp;memory&nbsp;address&gt;<br /><br />_________________<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local&nbsp;Variable&nbsp;2<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;�&nbsp;64&nbsp;bytes&nbsp;large<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br />|________________|<br />|&nbsp;&nbsp;&nbsp;&nbsp;modified&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local&nbsp;Variable&nbsp;1<br />|&nbsp;_______________|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;�&nbsp;4&nbsp;bytes&nbsp;large<br />|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old&nbsp;EBP&nbsp;&nbsp;&nbsp;&nbsp;|<br />|________________|<br />|&nbsp;&nbsp;ret&nbsp;address&nbsp;&nbsp;&nbsp;|<br />|________________|&nbsp;<br /><br />&lt;high&nbsp;memory&nbsp;address</div></div><br /><br /></div>
</body>
</html>
