<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Set-up</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Set-up<br /></h1></strong>Kernel dev is a little different and requires some setting up.<strong><br /></strong><strong><br /></strong><strong><h2>## Set up a kernel dev environment</h2></strong><br /><strong>1. Download Visual Studio</strong><br /><strong>2. Download Windows Driver Kit</strong><br />• should be able to grab from Visual Studio installer?<br />• Latest vers here -<a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk">https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk</a><br />• Older downloads (check step 2) - <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/other-wdk-downloads">https://docs.microsoft.com/en-us/windows-hardware/drivers/other-wdk-downloads</a><br /><br /><strong>3. Download WinDbg</strong><br />Recommend the version from the Win10 app store<br />Download without account here: <a href="https://twitter.com/M_Cedervall/status/1192621915791351808">https://twitter.com/M_Cedervall/status/1192621915791351808</a><br /><br /><strong>4. Enable DbgPrint in WinDbg</strong><br /><code>ed kd_default_mask 0xf</code><br /><br /><strong>5. Enable DbgPrint in DebugView</strong><br />• <a href="https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/compiling-first-kernel-driver-kdprint-dbgprint-and-debugview#enable-dbgprint-monitoring-for-dbgview">https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/compiling-first-kernel-driver-kdprint-dbgprint-and-debugview#enable-dbgprint-monitoring-for-dbgview</a><br /><br />RUN DBGVIEW AS ADMINISTRATOR TO CAPTURE KERNEL.<br /><br /><h2>## Barebones Driver</h2><br />Here&#39;s a barebones Windows driver that can be loaded an unloaded.<br /><br /><div class="codebox"><div class="codebox">//&nbsp;Barebones&nbsp;driver&nbsp;that&nbsp;can&nbsp;be&nbsp;loaded&nbsp;and&nbsp;unloaded.<br />#include&nbsp;&lt;ntddk.h&gt;<br />#include&nbsp;&lt;wdf.h&gt;<br /><br />void&nbsp;DriverUnload(PDRIVER_OBJECT&nbsp;DriverObject)<br />{<br />	UNREFERENCED_PARAMETER(DriverObject);<br />	DbgPrint(&quot;driver&nbsp;unloaded&nbsp;\n&quot;);<br />}<br /><br />NTSTATUS&nbsp;DriverEntry(PDRIVER_OBJECT&nbsp;DriverObject,&nbsp;PUNICODE_STRING&nbsp;RegistryPath)&nbsp;<br /><span style="color:#000000;font-weight:400">{</span>	<br />	UNREFERENCED_PARAMETER(DriverObject);<br />	UNREFERENCED_PARAMETER(RegistryPath);<br />	NTSTATUS&nbsp;nt_status&nbsp;=&nbsp;STATUS_SUCCESS;<br /><br />	DriverObject-&gt;DriverUnload&nbsp;=&nbsp;DriverUnload;<br />	<br />	DbgPrint(&quot;driver&nbsp;loaded&nbsp;\n&quot;);<br /><br />	return&nbsp;nt_status;<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
