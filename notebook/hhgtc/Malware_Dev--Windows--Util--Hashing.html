<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Hashing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Hashing</h1></strong><br />A bunch of hashing functions.<br /><br />• <a href="http://www.cse.yorku.ca/~oz/hash.html">http://www.cse.yorku.ca/~oz/hash.html</a><br /><br /><strong><h2>## dbj2 Hashing Algorithm<br /></h2></strong>By Dan Bernstein.<br /><a href="http://www.cse.yorku.ca/~oz/hash.html">http://www.cse.yorku.ca/~oz/hash.html</a><br /><div class="codebox"><div class="codebox">/*<br />djb2&nbsp;hash&nbsp;algorithm&nbsp;by&nbsp;Dan&nbsp;Bernstein.<br />Hash&nbsp;length&nbsp;is&nbsp;longer&nbsp;for&nbsp;longer&nbsp;strings.<br />*/<br />ULONG&nbsp;hash(char*&nbsp;str)<br /><span style="color:#000000;font-weight:400">{</span><br />	ULONG&nbsp;hash&nbsp;=&nbsp;5381;<br />	int&nbsp;c;<br /><br />	while&nbsp;(c&nbsp;=&nbsp;*str++)<br />		hash&nbsp;=&nbsp;((hash&nbsp;&lt;&lt;&nbsp;5)&nbsp;+&nbsp;hash)&nbsp;+&nbsp;c;		//&nbsp;hash&nbsp;*&nbsp;33&nbsp;+&nbsp;c<br /><br />	return&nbsp;hash;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><strong><h2>## ? (found in Stephen Fewer&#39;s Refelective DLL Injection code)</h2></strong><br /><a href="https://github.com/stephenfewer/ReflectiveDLLInjection/blob/master/dll/src/ReflectiveLoader.h">https://github.com/stephenfewer/ReflectiveDLLInjection/blob/master/dll/src/ReflectiveLoader.h</a><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;intrin.h&gt;<br /><br />#define&nbsp;HASH_KEY						13<br />#define&nbsp;hash_LoadLibraryA				0xEC0E4E8E		//&nbsp;&quot;LoadLibraryA&quot;<br />#define&nbsp;hash_GetProcAddress				0x7C0DFCAA		//&nbsp;&quot;GetProcAddress&quot;<br />#define&nbsp;hash_VirtualAlloc				0x91AFCA54		//&nbsp;&quot;VirtualAlloc&quot;<br />#define&nbsp;hash_NtFlushInstructionCache	0x534C0AB8		//&nbsp;&quot;NtFlushInstructionCache&quot;<br /><br />#pragma&nbsp;intrinsic(&nbsp;_rotr&nbsp;)<br />__forceinline&nbsp;DWORD&nbsp;ror(DWORD&nbsp;d)<br />{<br />	return&nbsp;_rotr(d,&nbsp;HASH_KEY);<br />}<br /><br />__forceinline&nbsp;DWORD&nbsp;hashA(char*&nbsp;c)<br />{<br />	register&nbsp;DWORD&nbsp;h&nbsp;=&nbsp;0;<br />	do<br />	{<br />		h&nbsp;=&nbsp;ror(h);<br />		h&nbsp;+=&nbsp;*c;<br />	}&nbsp;while&nbsp;(*++c);<br /><br />	return&nbsp;h;<br />}<br /><br />__forceinline&nbsp;DWORD&nbsp;hashW(wchar_t*&nbsp;c)<br /><span style="color:#000000;font-weight:400">{</span><br />	register&nbsp;DWORD&nbsp;h&nbsp;=&nbsp;0;<br />	do<br />	{<br />		h&nbsp;=&nbsp;ror(h);<br />		h&nbsp;+=&nbsp;*c;<br />	}&nbsp;while&nbsp;(*++c);<br /><br />	return&nbsp;h;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><strong><h2>## murmur2</h2></strong><br />• <a href="https://github.com/abrandoned/murmur2/blob/master/MurmurHash2.c">https://github.com/abrandoned/murmur2/blob/master/MurmurHash2.c</a><br /><br />Used by Conti ransomware.</div>
</body>
</html>
