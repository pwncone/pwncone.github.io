<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>pwntools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Tools - pwntools</h1></strong><br />pwntools is a python toolkit.<br />It was designed to help solve ctf problems easier/quicker. It&#39;ll do a lot of the hard work for you in complicated techniques like ROP, and has a simplified wrapper of python&#39;s <code>struct.pack</code> library for dealing with endianness and memory addresses.<br /><br />I don&#39;t really know how to use it yet, though :)<br /><br />It&#39;s python2 only.<br />Installation - <a href="http://docs.pwntools.com/en/stable/install.html">http://docs.pwntools.com/en/stable/install.html</a><br /><br />Introductions-to<br />• <a href="http://www.auxy.xyz/tutorial/2018/09/01/Pwntools-Step-By-Step.html">http://www.auxy.xyz/tutorial/2018/09/01/Pwntools-Step-By-Step.html</a><br />• <a href="https://parzelsec.de/speed-up-your-exploits/">https://parzelsec.de/speed-up-your-exploits/</a><br />• <a href="https://ocw.cs.pub.ro/courses/cns/labs/lab-07">https://ocw.cs.pub.ro/courses/cns/labs/lab-07</a><br />• <a href="http://brieflyx.me/2015/python-module/pwntools-intro/">http://brieflyx.me/2015/python-module/pwntools-intro/</a> - in Chinese, will have to google translate<br />• <a href="https://github.com/Gallopsled/pwntools-tutorial">https://github.com/Gallopsled/pwntools-tutorial</a> - has examples<br /><br /><strong><h3>Packing</h3></strong><br /><div class="codebox"><div class="codebox">var&nbsp;=&nbsp;p32(0x080483f4)&nbsp;&nbsp;&nbsp;#&nbsp;pack&nbsp;as&nbsp;32-bit&nbsp;little&nbsp;endian<br />var&nbsp;=&nbsp;p64(0x00400811)&nbsp;&nbsp;&nbsp;#&nbsp;pack&nbsp;as&nbsp;64-bit&nbsp;little&nbsp;endian</div></div><br /><br /><strong><h3>Start binary</h3></strong><br /><div class="codebox"><div class="codebox">binary&nbsp;=&nbsp;process(&quot;/path/to/binary&quot;)</div></div><br /><br /><strong><h3>Start binary and open gdb</h3></strong><br />(requires gdbserver to be installed)<br /><div class="codebox"><div class="codebox">from&nbsp;pwn&nbsp;import&nbsp;*<br /><br />binary&nbsp;=&nbsp;gdb.debug(&quot;./stack5&quot;)<br />pause()</div></div><br /><br /><strong><h3>SSH + run remote binary</h3></strong><br /><div class="codebox"><div class="codebox">r&nbsp;=&nbsp;ssh(host&nbsp;=&nbsp;&#39;10.10.10.139&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remote&nbsp;connection&nbsp;info<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user&nbsp;=&nbsp;&#39;margo&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;=&nbsp;&#39;iamgod$08&#39;)<br /><br />b&nbsp;=&nbsp;r.process(&#39;/usr/bin/garbage&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;start&nbsp;process&nbsp;with&nbsp;pwntools<br />b.sendline(payload)</div></div><br /><br />If <code>process()</code> doesn&#39;t work, try <code>run()</code><br /><div class="codebox"><div class="codebox">b&nbsp;=&nbsp;r.run(&#39;/opt/protostar/bin/stack4&#39;)</div></div><br /><br /><strong><h3>Connect to service on remote port</h3></strong><br /><div class="codebox"><div class="codebox">b&nbsp;=&nbsp;remote(&#39;10.10.10.147&#39;,&nbsp;1337)<br />b.sendline(payload)<br />b.interactive()</div></div></div>
</body>
</html>
