<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Spawn cmdprompt with no popup</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Create seaparte cmd prompt (with no popup)</h1></strong><br />The cmd prompt won&#39;t pop up in front of the user, but it will still appear in Task Manager.<br /><br /><strong><h2>## CREATE_NEW_CONSOLE vs DETACHED_PROCESS</h2></strong><br /><strong><h3>### CREATE_NEW_CONSOLE</h3></strong><br /><code>CREATE_NEW_CONSOLE</code> will create a new cmd process with no parent<br />i.e. you won&#39;t be able to tell <code>master.exe</code> is its parent.<br /><div class="codebox"><div class="codebox">blah.exe<br />master.exe<br />lulz.exe<br />svchost.exe<br />child.exe</div></div><br /><br />Can successfully prevent from popping up with <code>SW_HIDE</code><br /><br /><strong><h3>### DETACHED_PROCESS</h3></strong><br /><code>DETACHED_PROCESS</code> will be detached from the process that spawned it, and can run independently, but is still linked to its parent process.<br /><div class="codebox"><div class="codebox">blah.exe<br />lulz.exe<br />master.exe<br />&nbsp;&nbsp;&nbsp;&nbsp;child.exe<br />svchost.exe</div></div><br /><br />Couldn&#39;t get DETACHED_PROCESS to not pop up with <code>SW_HIDE</code><br /><br /><strong><h3>### Example</h3></strong><br /><div class="codebox"><div class="codebox">//&nbsp;Create&nbsp;process<br />STARTUPINFOA&nbsp;startupInfo&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />PROCESS_INFORMATION&nbsp;processInfo&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br /><br />startupInfo.cb&nbsp;=&nbsp;sizeof(startupInfo);<br />startupInfo.dwFlags&nbsp;=&nbsp;STARTF_USESTDHANDLES&nbsp;|&nbsp;STARTF_USESHOWWINDOW;<br />startupInfo.wShowWindow&nbsp;=&nbsp;SW_HIDE;					//&nbsp;hide&nbsp;window&nbsp;of&nbsp;spawned&nbsp;process&nbsp;from&nbsp;showing&nbsp;up<br /><br />char&nbsp;command[512]&nbsp;=&nbsp;&quot;C:\\Windows\\System32\\cmd.exe&nbsp;/c&nbsp;timeout&nbsp;10&nbsp;&gt;&nbsp;nul&nbsp;&amp;&nbsp;del&nbsp;omegalul.exe&quot;;<br />if&nbsp;(CreateProcessA(NULL,&nbsp;command,&nbsp;NULL,&nbsp;NULL,&nbsp;TRUE,&nbsp;CREATE_NEW_CONSOLE,&nbsp;NULL,&nbsp;NULL,&nbsp;&amp;startupInfo,&nbsp;&amp;processInfo)&nbsp;==&nbsp;0)<br /><span style="color:#000000;font-weight:400">{</span><br />	fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;create&nbsp;process:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />	return&nbsp;1;<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
