<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>File Splitter + Hex Editor</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Antivirus Evasion - File Splitter + Hex Editor</h1></strong><br />Old technique.<br />Originally from here? - <a href="http://getdsplit.class101.org">http://getdsplit.class101.org</a><br /><br />You split the file into multiple pieces and scan them with antivirus to find the signature that&#39;s being detected.<br />Then you hex edit out the signature.<br />But you have to be careful not to break the functionality of the binary.<br /><br />Signature-based products will always struggle with this technique.<br /><br /><strong>Links</strong><br />• <a href="https://vishalhacker.wordpress.com/2012/09/16/hexing-using-dsplit-to-hide-trojans-from-antivirus-detection/">https://vishalhacker.wordpress.com/2012/09/16/hexing-using-dsplit-to-hide-trojans-from-antivirus-detection/</a><br />• Find-AVSignature - <a href="https://obscuresecurity.blogspot.com/2012/12/finding-simple-av-signatures-with.html">https://obscuresecurity.blogspot.com/2012/12/finding-simple-av-signatures-with.html</a><br /><br /><strong>Tools</strong><br />• <code>dsplit.exe</code><br />   ◇ Several of the versions of &quot;DSplit.exe&quot; available on the internet contain malware <br />• Python alternative to <code>dsplit.exe</code> - <a href="https://github.com/rzwck/pydsplit/blob/master/pydsplit.py">https://github.com/rzwck/pydsplit/blob/master/pydsplit.py</a><br />• PowerSploit&#39;s <code>Find-AVSignature</code><br /><br /><strong><h2>## General Premise</h2></strong><br />1. Split the binary into multiple parts, usually 1000 block intervals<br />2. Scan those files with your chosen antivirus software<br />3. Find the earliest block that gets detected<br />4. Split that binary block into 100 block intervals<br />5. Scan<br />6. Split the earliest block that gets detected into 10 block intervals<br />7. Scan<br />8. Split the earliest block that gets detected into 1 block intervals<br />9. Scan<br />10. Find earlist block that gets detected -&gt; open with hex editor to identify the byte<br />11. Open original binary, find byte, edit out with hex editor.<br /><br /><strong><h2>## How-to</h2></strong><br /><strong><h3>### Split binary</h3></strong><br />pydsplit.py<br /><code>python pydsplit.py [startoffset] [block size] [filename]</code><br /><code>python pydsplit.py 0 1000 binary.exe</code><br /><br />PowerSploit<br /><code>Find-AVSignature -Startbyte 0 -Endbyte max -Interval 10000 -Path c:\test\exempt\nc.exe</code><br /><br /><strong><h3>### Edit</h3></strong><br />Edit with HxD or HexWorkshop<br /><a href=""><img src="images/526-1.png" alt="images/526-1.png" /></a><br /></div>
</body>
</html>
