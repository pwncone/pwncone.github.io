<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ELF Header</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># ELF Header</h1></strong><br />The ELF header can be read using the <code>readelf -h</code> command<br /><div class="codebox"><div class="codebox">root@gotham:~/CODE#&nbsp;readelf&nbsp;-h&nbsp;hello<br />ELF&nbsp;Header:<br />&nbsp;&nbsp;Magic:&nbsp;&nbsp;&nbsp;7f&nbsp;45&nbsp;4c&nbsp;46&nbsp;01&nbsp;01&nbsp;01&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;<br />&nbsp;&nbsp;Class:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELF32<br />&nbsp;&nbsp;Data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2s&nbsp;complement,&nbsp;little&nbsp;endian<br />&nbsp;&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;(current)<br />&nbsp;&nbsp;OS/ABI:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNIX&nbsp;-&nbsp;System&nbsp;V<br />&nbsp;&nbsp;ABI&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br />&nbsp;&nbsp;Type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYN&nbsp;(Shared&nbsp;object&nbsp;file)<br />&nbsp;&nbsp;Machine:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intel&nbsp;80386<br />&nbsp;&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1<br />&nbsp;&nbsp;Entry&nbsp;point&nbsp;address:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1060<br />&nbsp;&nbsp;Start&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;52&nbsp;(bytes&nbsp;into&nbsp;file)<br />&nbsp;&nbsp;Start&nbsp;of&nbsp;section&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14280&nbsp;(bytes&nbsp;into&nbsp;file)<br />&nbsp;&nbsp;Flags:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0<br />&nbsp;&nbsp;Size&nbsp;of&nbsp;this&nbsp;header:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;52&nbsp;(bytes)<br />&nbsp;&nbsp;Size&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;(bytes)<br />&nbsp;&nbsp;Number&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11<br />&nbsp;&nbsp;Size&nbsp;of&nbsp;section&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;40&nbsp;(bytes)<br />&nbsp;&nbsp;Number&nbsp;of&nbsp;section&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30<br />&nbsp;&nbsp;Section&nbsp;header&nbsp;string&nbsp;table&nbsp;index:&nbsp;29</div></div><br /><br /><strong>Magic</strong> - The ‘magic’ is the settings denoted in the rest of the file (class, data, version etc.) in hex bytes format.<br />The first 4 bytes define the file as an ELF file - <code>7f 45 4c 46</code>.<br />And the rest are information from the rest of the file.<br /><br />• <code>7f</code> is always prefixed (dont&#39; know why :shrug:)<br />• <code>45</code> = E <br />• <code>4c</code> = L<br />• <code>46</code> = F<br />• <code>01</code> - 32-bit (class setting)<br />• <code>01</code> - Little endian (data setting)<br />• <code>01</code> - Version type = current (version setting)<br /><br /><strong>Class</strong> - determines the architecture for the file. <code>01</code> = 32-bit. <code>02</code> = 64-bit<br /><strong>Data</strong> - defines the endianness of the file. <code>01</code> = little endian. <code>02</code> = big endian<br /><strong>Version</strong> - determines the version number. There&#39;s only 1 version type - ‘current’ - which is <code>01</code>.<br /><strong>OS/ABI</strong> - every OS has minor differences between functions. The ABI defines which set of functions to use. <code>00</code> = no specific set<br /><strong>ABI Version</strong> - which version of the ABI (Application Binary Interface) to use for functions<br /><strong>Type</strong> - describes the purpose of the file<br />    • <strong>DYN</strong> (a shared object file) - for libraries<br />    • <strong>EXEC</strong> (an executable file) - for binaries<br />    • <strong>REL</strong> (relocatable file) - for linking to an executable file<br /><strong>Machine</strong> - the expected machine type on whcih the file will run? Intel 80386 = 32-bit. amd64 = 64-bit<br /><br />etc.</div>
</body>
</html>
