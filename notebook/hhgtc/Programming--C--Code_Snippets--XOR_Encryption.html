<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XOR Encryption</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># C - XOR Encryption</h1></strong><br />XOR encryption is used a lot in C because you don&#39;t have to include any extra libraries to do it. And it&#39;s small and simple.<br /><br />Notes below aren&#39;t necessarily optimal/correct, just my observations.<br /><br /><strong><h3>Setting a Key</h3></strong><br />This is bad:<br /><code>char key[] = &quot;ayylmao&quot;;</code><br />because this char string will be terminated with a null byte - <code>\0</code><br />(don&#39;t want to be encrypting with a reliably repeating character)<br /><br />Solution #1 - Cut off the null byte by declaring key length<br /><code>char key[7] = &quot;ayylmao&quot;;</code><br /><br />Solution #2 - BETTER - use a byte array<br /><code>char key[] = {&#39;a&#39;, &#39;y&#39;, &#39;y&#39;, &#39;l&#39;, &#39;m&#39;, &#39;a&#39;, &#39;o&#39;};</code><br />better because XOR encrypts using a key<br /><br /><strong><h3>Code</h3></strong><br />You XOR encrypt using the bitwise <code>^</code> (XOR) operator<br /><br /><strong><h3>Encrypting With Key</h3></strong><br /><code>key[i % sizeof(key)]</code><br />Modulus means XOR encryption will loop through key correctly despite target file/string length.<br />For example:<br />    key length = 19<br />    file length = 100<br />    <code>0 % 19 = 0</code><br />    <code>1 % 19 = 1</code><br />    <code>2 % 19 = 2</code><br />    <code>19 % 19 = 0</code><br />    <code>20 % 19 = 1</code><br />    <code>21 % 19 = 2</code><br />    <code>38 % 19 = 0</code><br />    etc.<br /><br /><strong><h3>Examples:</h3></strong><br />• <a href="https://github.com/KyleBanks/XOREncryption/blob/master/C/main.c">https://github.com/KyleBanks/XOREncryption/blob/master/C/main.c</a><br /><br />• Encrypts bytes in file map.<br />From scantime crypter I wrote.<br /><div class="codebox"><div class="codebox">//&nbsp;XOR&nbsp;ENCRYPT&nbsp;FILE&nbsp;MAP<br />//&nbsp;--------------------------------------------<br />char&nbsp;key[]&nbsp;=&nbsp;{&nbsp;&#39;m&#39;,&#39;u&#39;,&#39;c&#39;,&#39;h&#39;,&#39;c&#39;,&#39;r&#39;,&#39;y&#39;,&#39;p&#39;,&#39;t&#39;,&#39;v&#39;,&#39;e&#39;,&#39;r&#39;,&#39;y&#39;,&#39;s&#39;,&#39;e&#39;,&#39;c&#39;,&#39;r&#39;,&#39;e&#39;,&#39;t&#39;&nbsp;};<br /><br />DWORD&nbsp;i;<br />DWORD&nbsp;dwFileSize&nbsp;=&nbsp;GetFileSize(hFile,&nbsp;NULL);<br />for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;dwFileSize;&nbsp;i++)<br />{<br />	//&nbsp;grab&nbsp;byte<br />	BYTE&nbsp;readByte&nbsp;=&nbsp;*(LPBYTE)hFileMapBaseAddress&nbsp;+&nbsp;i;<br />	//&nbsp;xor&nbsp;byte&nbsp;with&nbsp;key<br />	/*<br />		modulus&nbsp;(%)&nbsp;means&nbsp;XOR&nbsp;encryption&nbsp;will&nbsp;loop&nbsp;through&nbsp;key&nbsp;correctly&nbsp;regardless&nbsp;of&nbsp;target&nbsp;file&nbsp;length<br />		0&nbsp;%&nbsp;19&nbsp;=&nbsp;0,&nbsp;2&nbsp;%&nbsp;19&nbsp;=&nbsp;2,&nbsp;19&nbsp;%&nbsp;19&nbsp;=&nbsp;0,&nbsp;21&nbsp;%&nbsp;19&nbsp;=&nbsp;2,&nbsp;38&nbsp;%&nbsp;19&nbsp;=&nbsp;0,&nbsp;40&nbsp;%&nbsp;19&nbsp;=&nbsp;2,&nbsp;etc.<br />	*/<br />	readByte&nbsp;=&nbsp;readByte&nbsp;^&nbsp;key[i&nbsp;%&nbsp;sizeof(key)];<br />}<br /></div></div><br /><br /><br /><br /><br /></div>
</body>
</html>
