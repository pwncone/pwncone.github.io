<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Kernel Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Kernel Exploits</h1></strong><br />Please note that not all of these are kernel exploits, but most of them are.<br />If it&#39;s not a kernel exploit, it&#39;ll be similar to a kernel exploit in the sense that it attacks a core part of the system.<br /><br />Running exploits against a box can be risky - you can crash the system and/or cause irrecoverable damage.<br />It&#39;s also pretty noisy: dropping files to disk, running binaries, compiling (maybe) etc.<br /><br /><strong><h2>## Tips</h2></strong><br />• If a compiler isn&#39;t available on target, create a replica VM and compile there<br />   ◇ Or grab a precompiled exploit from here (run at your own risk)<br />      ▪ <a href="https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits">bin-sploits - @offensive-security</a><br />      ▪ <a href="https://github.com/lucyoa/kernel-exploits/">kernel-exploits - @lucyoa</a><br /><br /><strong><h2>## Recon</h2></strong><br /><code>uname -mrs</code><br /><code>cat /etc/issue</code> - distro version<br /><code>cat /etc/*-release</code> - another way to check distro version<br /><code>cat /proc/cpuinfo</code> - CPU info<br /><code>cat /proc/version</code> - specifies the version of the Linux kernel and gcc version used to compile the kernel<br /><code>df -a</code> - file system info<br /><code>dpkg --list 2&gt;/dev/null| grep compiler |grep -v decompiler 2&gt;/dev/null &amp;&amp; yum list installed &#39;gcc*&#39; 2&gt;/dev/null| grep gcc 2&gt;/dev/null</code> - list available compilers<br /><br /><strong><h2>## Scripts that Check for Exploits</h2></strong><br />Use ALL of these.<br />The scripts that check for exploits often produce wildly different results.<br /><br /><strong><h3>### linuxprivchecker.py</h3></strong><br />Works well, will suggest some exploits over others depending on what it finds.<br /><br /><strong><h3>### linux-exploit-suggester2.pl</h3></strong><br />Will give quite a few results which you have to verify yourself.<br />It tends to find the heavy hitters that work for all systems/kernels - <code>dirtyc0w</code>, <code>get_rekt</code>, etc.<br /><br /><strong><h3>### Metasploit&#39;s local_exploit_suggester</h3></strong><br />Potentially not reliable against 64bit Linux machines (this is the case for Windows).<br /><br /><strong><h2>## Compiling</h2></strong><br />If you can, compile the exploit on the target machine as it&#39;s more likely to work that way.<br /><br /><strong><h3>### Cross-compile for 32bit</h3></strong><br />Requires <code>gcc-multilib</code> to be installed.<br /><code>gcc binary.c -o binary -m32</code><br /><br /><strong><h3>### Cross-compile Errors</h3></strong><br />• Get a <code>error while loading shared libraries: requires glibc 2.5 or later dynamic linker</code> error?<br />   ◇ Compile with:<br />      ▪ <code>gcc -m32 -Wl,--hash-style=both sock_sendpage.c -o sock_sendpage</code><br />   <br />   ◇ The <code>-Wl</code> flag allows you to pass comma-separated options on to the linker.<br />   ◇ <code>--hash-style</code> changes the format of the hash table (which is used for runtime symbol resolution).<br />   ◇ Most GCC installations use either <code>both</code> or <code>gnu</code> style of hash tables.<br /><br /><strong><h2>## Known-to-work-well Exploits</h2></strong><br />Most of these should be in a sub-node too.<br /><br /><strong><h3>### CVE-2016-5195 (DirtyCow)</h3></strong><br />Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8<br />Has a high risk of crashing the system.<br /><code>echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs<br />g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil<br />https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs<br />https://github.com/evait-security/ClickNRoot/blob/master/1/exploit.c</code><br /><br /><strong><h3>### CVE-2010-3904 (RDS)</h3></strong><br />Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8<br /><code>https://www.exploit-db.com/exploits/15285/</code><br /><br /><strong><h3>### CVE-2010-4258 (Full Nelson)</h3></strong><br />Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04)<br /><code>https://www.exploit-db.com/exploits/15704/</code><br /><br /><strong><h3>### CVE-2012-0056 (Mempodipper)</h3></strong><br />Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)<br /><code>https://www.exploit-db.com/exploits/18411</code></div>
</body>
</html>
