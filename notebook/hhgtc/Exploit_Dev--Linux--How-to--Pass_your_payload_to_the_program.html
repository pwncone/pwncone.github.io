<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Pass your payload to the program</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Linux - How-to - Pass your payload to the program</h1></strong><br />This can be more of a pain/problem than you think.<br /><br /><strong><h2>## As an argument</h2></strong><br />If the payload needs to be deliever via a cmdline argument, use in-line execution.<br /><br /><strong><h3>### python</h3></strong><br /><code>./binary `python -c ‘print “A”*200’`</code><br /><code>./binary $(python -c ‘print “A”*200’)</code><br />If your python script prints the payload, you can just run your exploit script - <code>./binary $(python pwn.py)</code><br /><br /><strong><h3>### text file</h3></strong><br /><code>./binary `cat payload.txt`</code><br /><code>./binary $(cat payload.txt)</code><br /><br /><strong><h2>## As an environment variable</h2></strong><br />If the payload needs to be delivered as an environment variable, you can just set one.<br /><br />1) Set an environment variable containg your payload value - <code>export GREENIE=&lt;payload&gt;</code><br />   1- In-line execution also works here<br />      1&gt; <code>export GREENIE=`python pwn.py`<br /></code>      2&gt; <code>export GREENIE=`python -c ‘print “A”*200&#39;`</code><br />      3&gt; <code>export GREENIE=`cat payload.txt`</code><br />2) Run the binary - <code>./binary</code><br /><br /><strong><h2>## Pass payload to user input</h2></strong><br />If the payload needs to be passed to a part of the program that&#39;s waiting for user input, this can be a little more complicated.<br />e.g. to a <code>gets()</code><br /><br /><strong><h3>### Only 1 user input?</h3></strong><br />Then you can simply pipe the payload to the user input.<br /><br /><code>python -c ‘print “A”*200’ | ./binary</code><br /><code>python pwn.py | ./binary</code><br /><code>cat payload.txt | ./binary</code><br /><br /><strong>+ spawning a shell</strong><br />If you&#39;re trying to spawn a shell with your payload, you&#39;ll need to halt the program so that you can interact with your shell.<br />If you don&#39;t halt the program, the shell will spawn as a result of your exploit but the program will quit immediately.<br /><br /><code>(python pwn.py; cat) | ./binary</code><br /><code>(cat payload.txt; cat) | ./binary</code><br /><br /><code>()</code> runs commands in a subshell.<br /><a href="https://unix.stackexchange.com/questions/26063/how-are-parentheses-interpreted-at-the-command-line">https://unix.stackexchange.com/questions/26063/how-are-parentheses-interpreted-at-the-command-line</a><br /><br /><strong><h3>### More than 1 user input?</h3></strong><br />e.g.<br />You start your program.<br />The 1st user input - <code>What&#39;s your name? - &lt;user input&gt;</code> - isn&#39;t vulnerable<br />but the 2nd user input - <code>Favourite colour? - &lt;user input&gt;</code> - is vulnerable.<br /><br />The only way I&#39;ve found to deal with this is pwntools.<br /><div class="codebox"><div class="codebox">p.recvuntil(&quot;name?&nbsp;&quot;)<br />p.sendline(&quot;John&quot;)<br />p.recvuntil(&quot;colour?&nbsp;&quot;)<br />p.sendline(payload)</div></div><br /><br />Or you could manually provide the payload yourself when prompted (which I&#39;m 99% sure won&#39;t work because you won&#39;t be submitting hex values).</div>
</body>
</html>
