<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Extract hashes locally</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Extract NTDS.dit Hashes Locally</h1></strong><br />This is when you&#39;re on a target system with an <code>NTDS.dit</code> file.<br /><br />As well as the methods below,<br />you can also use any of the methods in the &#39;Grab Protected Files&#39; node to extract NTDS.dit hashes locally:<br />• VSS<br />• DiskShadow <br />• Invoke-NinjaCopy.ps1<br />• Copy-VSS.ps1<br />• etc.<br /><br /><strong><h2>## ntdsutil</h2></strong><br />A genuine Microsoft tool.<br />Available since Windows Server 2008.<br />Its purpose is to enable administrators to access and manage the Windows Active Directory database.<br /><br />ntdsutil will take a snapshot of the current NTDS.dit file for offline inspection/use.<br /><br />Interactive version:<br /><code>ntdsutil<br />activate instance ntds<br />ifm<br />create full C:\Users\Public\ntds-bak<br />quit<br />quit</code><br /><br />Non-interactive version (don&#39;t know if this works):<br /><code>ntdsutil &quot;activate instance ntds&quot; &quot;ifm&quot; &quot;create full C:\Users\Public\ntds&quot; quit quit</code><br /><br />Files created:<br />• Active Directory - stores NTDS.dit<br />• Registry - stores SAM and SYSTEM registry hives<br /><br /><strong><h2>## Metasploit </h2></strong><br /><a href="Pentetration_Testing--Ports_&_Services--80,443_-_HTTP-s--Web_Apps--Ovidentia--Admin_Panel--Upload_File.html">Tools &gt; Metasploit/Meterpreter &gt; smart_hashdump</a><br /><a href="Pentetration_Testing--Ports_&_Services--80,443_-_HTTP-s--Web_Apps--Ovidentia--Admin_Panel--Upload_File.html">Tools &gt; Metasploit/Meterpreter &gt; domain_hashdump</a><br /><br /><strong><h2>## Mimikatz</h2></strong><br />Tools &gt; Mimikatz &gt; Extract from NTDS.dit locally on Domain Controller<br /><br /><strong><h2>## Invoke-Mimikatz</h2></strong><br />Tools &gt; Invoke-Mimikatz &gt; Dump NTDS.dit locally</div>
</body>
</html>
