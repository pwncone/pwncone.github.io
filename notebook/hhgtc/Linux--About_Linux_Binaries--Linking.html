<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Linking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Linux - ELF - Linking</h1></strong><br />When you use functions from libraries or other files, these functions have to be linked to your compiled executable in some way.<br /><br />Take, for example, this C program.<br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;stdio.h&gt;<br /><br />int&nbsp;main()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Hey&nbsp;:)\nI&#39;m&nbsp;exiting&nbsp;now...&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit(0);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br />}</div></div><br /><br />2 functions from the <code>libc</code> library have been used - <code>printf()</code> and <code>exit()</code>.<br /><br />Because these are functions from a library (not ones you&#39;ve written yourself), these functions have to be linked to your compiled executable/ELF file in order to be used.<br /><br />There are 2 type of linking - <strong>static</strong> and <strong>dynamic</strong>.<br /><br /><strong><h2>## Static Linking</h2></strong><br />Static linking is where the all the library code needed to run the <code>printf()</code> and <code>exit()</code> functions are contained within your compiled binary.<br /><br /><strong>Advantages</strong><br />• Makes the binary totally portable (all code required from libraries etc. is compiled into the ELF binary, not using system libraries)<br />• Fast (because the library functions are locally available/you don&#39;t have look up the memory address of library functions when you need them)<br /><br /><strong>Disadvantages</strong><br />• Large files sizes (because you&#39;re including your code + library code)<br /><br /><strong>Diagram</strong><br /><a href=""><img src="images/598-1.png" alt="images/598-1.png" /></a><br /><br /><strong><h2>## Dynamic Linking</h2></strong><br />Dynamic linking is much more common.<br />Dynamic linking is where the required libraries get loaded into memory when the binary is run, rather than being written into the ELF file on compilation.<br /><br />You can see the libraries that will be dynamically linked and their base address using <code>ldd</code><br /><code>ldd my_binary.elf</code><br /><br />In the Symbol Table, the <code>.dynsym</code> section contains information on symbols from external files (variables, functions etc.) that are dynamically linked.<br /><br /><strong>Advantages</strong><br />• Smaller file sizes (because all the extra library code isn&#39;t being inluded in the final executable)<br />• The library can receive updates and you can reap the benefits of those updates without having to recompile your binary<br /><br /><strong>Disadvantages</strong><br />• Slow (have to look up the location of the functions in the shared libraries when you need to run that function)<br />• Not reliably portable (a copy of the library the binary is using must be available on the system)<br /><br /><em><strong>Diagram</strong></em><br /><a href=""><img src="images/598-2.png" alt="images/598-2.png" /></a><br /><em>Diagram showing libraries being loaded into memory rather than the ELF file itself</em></div>
</body>
</html>
