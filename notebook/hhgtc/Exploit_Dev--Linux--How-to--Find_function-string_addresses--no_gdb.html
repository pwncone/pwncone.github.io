<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>no gdb</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># How-to - Find Function/String Addresses - no gdb</h1></strong><br /><br /><strong><h2>## libc Base</h2></strong><br /><strong><h3>### ldd</h3></strong><br /><code>ldd</code> is not meant to be accurate for determining load addresses <br />(but it can sometimes produce the correct address. I&#39;ve used it before.)<br /><br /><code>ldd &lt;binary&gt; | grep libc</code><br /><br /><strong><h3>### LD_TRACE_LOADED_OBJECTS</h3></strong><br /><code>LD_TRACE_LOADED_OBJECTS</code> is an enviroment variable that will accurately determine the load address of libc.<br /><br /><code>LD_TRACE_LOADED_OBJECTS=1 &lt;current shell&gt; | grep libc</code><br /><code>LD_TRACE_LOADED_OBJECTS=1 /bin/sh | grep libc</code><br /><code>LD_TRACE_LOADED_OBJECTS=1 /bin/bash | grep libc</code><br /><br />You can verify this by starting an instance of bash in the background and inspecting its maps file.<br /><div class="codebox"><div class="codebox">$&nbsp;bash&nbsp;&amp;<br />[1]&nbsp;30398<br />[1]&nbsp;&nbsp;+&nbsp;30398&nbsp;suspended&nbsp;(tty&nbsp;input)&nbsp;&nbsp;bash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />$&nbsp;grep&nbsp;libc&nbsp;/proc/30398/maps&nbsp;|&nbsp;head&nbsp;-n1<br />7ffff75e7000-7ffff77a2000&nbsp;r-xp&nbsp;00000000&nbsp;08:01&nbsp;525269&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/lib/x86_64-linux-gnu/libc-2.19.so</div></div><br /><br />If starting a backgrounded shell didn&#39;t give you a PID, you can look for your shell instance in ps aux<br /><div class="codebox"><div class="codebox">$&nbsp;ps&nbsp;aux&nbsp;|&nbsp;grep&nbsp;&lt;username&gt;<br />user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2988&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;1744&nbsp;&nbsp;&nbsp;440&nbsp;pts/0&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;17:07&nbsp;&nbsp;&nbsp;0:00&nbsp;sh<br />$&nbsp;grep&nbsp;libc&nbsp;/proc/2988/maps&nbsp;|&nbsp;head&nbsp;-n1<br />b7e97000-b7fd5000&nbsp;r-xp&nbsp;00000000&nbsp;00:10&nbsp;759&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/lib/libc-2.11.2.so</div></div><br /><br /><strong><h2>## Functions</h2></strong><br />1. To find function addresses without gdb, you&#39;ll first need to find the libc base address<br />(refer to section above)<br /><br />2. Next, search libc for the offset to the function you want - e.g. sytsem()<br /><code>readelf -s /lib/libc-2.11.2.so | grep system</code><br /><code>readelf -s /lib/i386-linux-gnu/libc.so.6 | grep &lt;function&gt;</code><br /><br />3. Add libc base and function offset together<br /><br /><strong>Google / Calculator</strong><br />Just add the 2 values together in google<br />   ◇ <code>libc base</code> + <code>system() offset</code> = <code>system() address</code><br />   ◇ e.g. <code>0xb7e97000</code> + <code>0x00038fb0</code> = <code>0xb7ecffb0</code><br /> <br /><strong>Python</strong><br />Or you could do this within your python code:<br /><em>struct.pack 32-bit</em><br /><div class="codebox"><div class="codebox">import&nbsp;struct<br /><br />libc_base_addr&nbsp;&nbsp;=&nbsp;0xb7dd1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;libc&nbsp;base&nbsp;address<br /><br />libc_system_off&nbsp;=&nbsp;0x0003ec00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;system()<br />libc_exit_off&nbsp;&nbsp;&nbsp;=&nbsp;0x00031be0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;exit()<br />libc_binsh_off&nbsp;&nbsp;=&nbsp;0x0017eaaa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;/bin/sh&nbsp;in&nbsp;libc<br /><br />libc_system_addr&nbsp;=&nbsp;struct.pack(&#39;&lt;I&#39;,&nbsp;libc_base_addr&nbsp;+&nbsp;libc_system_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7e0fc00<br />libc_exit_addr&nbsp;=&nbsp;struct.pack(&#39;&lt;I&#39;,&nbsp;libc_base_addr&nbsp;+&nbsp;libc_exit_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7e02be0<br />libc_binsh_addr&nbsp;=&nbsp;struct.pack(&#39;&lt;I&#39;,&nbsp;libc_base_addr&nbsp;+&nbsp;libc_binsh_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7f4faaa</div></div><br /><br /><em>pwntools 32-bit</em><br /><div class="codebox"><div class="codebox">from&nbsp;pwn&nbsp;import&nbsp;*<br /><br />libc_base_addr&nbsp;&nbsp;=&nbsp;0xb7dd1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;libc&nbsp;base&nbsp;address<br /><br />libc_system_off&nbsp;=&nbsp;0x0003ec00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;system()<br />libc_exit_off&nbsp;&nbsp;&nbsp;=&nbsp;0x00031be0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;exit()<br />libc_binsh_off&nbsp;&nbsp;=&nbsp;0x0017eaaa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;offset&nbsp;to&nbsp;/bin/sh&nbsp;in&nbsp;libc<br /><br />libc_system_addr&nbsp;=&nbsp;p32(libc_base_addr&nbsp;+&nbsp;libc_system_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7e0fc00<br />libc_exit_addr&nbsp;=&nbsp;p32(libc_base_addr&nbsp;+&nbsp;libc_exit_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7e02be0<br />libc_binsh_addr&nbsp;=&nbsp;p32(libc_base_addr&nbsp;+&nbsp;libc_binsh_off)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;0xb7f4faaa</div></div><br /><br /><strong><h2>## Strings</h2></strong><br />Grep libc for the offset to a string<br /><code>strings -a -t x /lib/libc-2.11.2.so | grep /bin/sh</code></div>
</body>
</html>
