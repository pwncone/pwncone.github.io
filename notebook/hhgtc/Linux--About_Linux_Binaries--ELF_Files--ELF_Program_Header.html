<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ELF Program Header</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># ELF Program Header</h1></strong><br />The ELF Program Header defines the segments of the binary, which sections are in which segment, and the address of each of the segments when they&#39;re loaded into memory.<br /><br />Sections can be put into segments. <br />A segment can have 0 or more sections.<br /><br />The segments can be read with <code>readelf -l &lt;binary&gt;</code><br /><div class="codebox"><div class="codebox">root@gotham:~/CODE#&nbsp;readelf&nbsp;-l&nbsp;hello<br /><br />Elf&nbsp;file&nbsp;type&nbsp;is&nbsp;DYN&nbsp;(Shared&nbsp;object&nbsp;file)<br />Entry&nbsp;point&nbsp;0x1060<br />There&nbsp;are&nbsp;11&nbsp;program&nbsp;headers,&nbsp;starting&nbsp;at&nbsp;offset&nbsp;52<br /><br />Program&nbsp;Headers:<br />&nbsp;&nbsp;Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;&nbsp;&nbsp;VirtAddr&nbsp;&nbsp;&nbsp;PhysAddr&nbsp;&nbsp;&nbsp;FileSiz&nbsp;MemSiz&nbsp;&nbsp;Flg&nbsp;Align<br />&nbsp;&nbsp;PHDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000034&nbsp;0x00000034&nbsp;0x00000034&nbsp;0x00160&nbsp;0x00160&nbsp;R&nbsp;&nbsp;&nbsp;0x4<br />&nbsp;&nbsp;INTERP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000194&nbsp;0x00000194&nbsp;0x00000194&nbsp;0x00013&nbsp;0x00013&nbsp;R&nbsp;&nbsp;&nbsp;0x1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Requesting&nbsp;program&nbsp;interpreter:&nbsp;/lib/ld-linux.so.2]<br />&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000000&nbsp;0x00000000&nbsp;0x00000000&nbsp;0x003b8&nbsp;0x003b8&nbsp;R&nbsp;&nbsp;&nbsp;0x1000<br />&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x001000&nbsp;0x00001000&nbsp;0x00001000&nbsp;0x00258&nbsp;0x00258&nbsp;R&nbsp;E&nbsp;0x1000<br />&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002000&nbsp;0x00002000&nbsp;0x00002000&nbsp;0x00184&nbsp;0x00184&nbsp;R&nbsp;&nbsp;&nbsp;0x1000<br />&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002ef4&nbsp;0x00003ef4&nbsp;0x00003ef4&nbsp;0x00128&nbsp;0x0012c&nbsp;RW&nbsp;&nbsp;0x1000<br />&nbsp;&nbsp;DYNAMIC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002efc&nbsp;0x00003efc&nbsp;0x00003efc&nbsp;0x000f0&nbsp;0x000f0&nbsp;RW&nbsp;&nbsp;0x4<br />&nbsp;&nbsp;NOTE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0001a8&nbsp;0x000001a8&nbsp;0x000001a8&nbsp;0x00044&nbsp;0x00044&nbsp;R&nbsp;&nbsp;&nbsp;0x4<br />&nbsp;&nbsp;GNU_EH_FRAME&nbsp;&nbsp;&nbsp;0x002018&nbsp;0x00002018&nbsp;0x00002018&nbsp;0x00044&nbsp;0x00044&nbsp;R&nbsp;&nbsp;&nbsp;0x4<br />&nbsp;&nbsp;GNU_STACK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000000&nbsp;0x00000000&nbsp;0x00000000&nbsp;0x00000&nbsp;0x00000&nbsp;RW&nbsp;&nbsp;0x10<br />&nbsp;&nbsp;GNU_RELRO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x002ef4&nbsp;0x00003ef4&nbsp;0x00003ef4&nbsp;0x0010c&nbsp;0x0010c&nbsp;R&nbsp;&nbsp;&nbsp;0x1<br /><br />&nbsp;Section&nbsp;to&nbsp;Segment&nbsp;mapping:<br />&nbsp;&nbsp;Segment&nbsp;Sections...<br />&nbsp;&nbsp;&nbsp;00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.interp&nbsp;<br />&nbsp;&nbsp;&nbsp;02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.interp&nbsp;.note.ABI-tag&nbsp;.note.gnu.build-id&nbsp;.gnu.hash&nbsp;.dynsym&nbsp;.dynstr&nbsp;.gnu.version&nbsp;.gnu.version_r&nbsp;.rel.dyn&nbsp;.rel.plt&nbsp;<br />&nbsp;&nbsp;&nbsp;03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.init&nbsp;.plt&nbsp;.plt.got&nbsp;.text&nbsp;.fini&nbsp;<br />&nbsp;&nbsp;&nbsp;04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.rodata&nbsp;.eh_frame_hdr&nbsp;.eh_frame&nbsp;<br />&nbsp;&nbsp;&nbsp;05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.init_array&nbsp;.fini_array&nbsp;.dynamic&nbsp;.got&nbsp;.got.plt&nbsp;.data&nbsp;.bss&nbsp;<br />&nbsp;&nbsp;&nbsp;06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.dynamic&nbsp;<br />&nbsp;&nbsp;&nbsp;07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.note.ABI-tag&nbsp;.note.gnu.build-id&nbsp;<br />&nbsp;&nbsp;&nbsp;08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.eh_frame_hdr&nbsp;<br />&nbsp;&nbsp;&nbsp;09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.init_array&nbsp;.fini_array&nbsp;.dynamic&nbsp;.got</div></div><br /><br />This <code>hello</code> executable has 11 segments.<br />Here you can read the permissions of the sections.<br />   •  e.g. the <code>.text</code> section is in <code>segment 03</code> - with the segment name <code>LOAD</code> - and has <code>R</code> (read) and <code>E</code> (execute) permissions<br />   •  <code>LOAD           0x001000 0x00001000 0x00001000 0x00258 0x00258 R E 0x1000</code><br /><br />The Offset and VirtAddr describe the location of where the segment will be when loaded in memory.</div>
</body>
</html>
