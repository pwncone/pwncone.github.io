<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>VAC</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># VAC</h1></strong><br />Valve Anti-Cheat.<br /><br />The anticheat isn&#39;t great. It mostly works with signature detection.<br />If you&#39;re using public code, you cheat will be detected. <br />If it&#39;s coded yourself, it&#39;ll probably stay undetected.<br /><br /><strong>Links</strong><br />• <a href="https://guidedhacking.com/threads/how-to-bypass-vac-valve-anti-cheat-info.8125">https://guidedhacking.com/threads/how-to-bypass-vac-valve-anti-cheat-info.8125</a><br />• <a href="https://github.com/danielkrupinski/VAC-Bypass">https://github.com/danielkrupinski/VAC-Bypass</a><br /><br /><strong>Bypasses include:</strong><br />• Mid-function hooking (apparently they detect hooks on some functions) <br /><br /><strong><h2>## Blocking LoadLibraryA</h2></strong><br />As of 2020, Valve implemented some new injection prevention techinques <br />which blocks a basic LoadLibrary inject.<br />If you still want to use LoadLibrary, then there are bypasses to get it to work.<br />Otherwise you can just manual map / any other DLL injection technique.<br /><br />Info:<br />• <a href="https://github.com/hinnie123/csgo-load-library-bypass-injector">https://github.com/hinnie123/csgo-load-library-bypass-injector</a> - C++ injection source<br />• <a href="https://github.com/danielkrupinski/OneByteLdr">https://github.com/danielkrupinski/OneByteLdr</a> - Python patch<br />• <a href="https://www.unknowncheats.me/forum/counterstrike-global-offensive/404112-loadlibrary-prevention-mechanism-byte-patch.html">https://www.unknowncheats.me/forum/counterstrike-global-offensive/404112-loadlibrary-prevention-mechanism-byte-patch.html</a><br /><br />They hook NtOpenFile and verify if the module being loaded is a DLL.<br />If it&#39;s a DLL, they check if it&#39;s a trusted module.<br /><br /><strong><h3>### Bypass Trusted Module Protection</h3></strong><br /><h4>#### Unhook NtOpenFile</h4><br />You could unhook NtOpenFile within Ntdll.dll in CSGO, inject your DLL using LoadLibrary,<br />and then restore the hooked bytes after injection has finished.<br /><br /><h4>#### Place in your DLL in a C:\Windows subfolder</h4><br />Documented here:<br /><a href="https://www.unknowncheats.me/forum/counterstrike-global-offensive/406285-bypassing-valves-trusted-mode.html">https://www.unknowncheats.me/forum/counterstrike-global-offensive/406285-bypassing-valves-trusted-mode.html</a><br /><a href="https://i.imgur.com/qieasIr.png"><img src="images/1306-1.png" alt="images/1306-1.png" /></a><br /><br /><strong><h4>#### Modify dword_474900 to 5 and restore after injection</h4></strong><br />Documented here:<br /><a href="https://github.com/hinnie123/csgo-load-library-bypass-injector">https://github.com/hinnie123/csgo-load-library-bypass-injector</a><br /><br />The hook in NtOpenFile calls <code>sub_40D460</code><br /><code>sub_40D460</code> is basically an <code>IsTrustedModule</code> function, which returns TRUE if the module is trusted.<br /><br />At the end is a check:<br /><a href=""><img src="images/1306-2.png" alt="images/1306-2.png" /></a><br /><br />If <code>dword_4748FC</code> is <code>0</code> or <code>dword_474900</code> is higher than <code>dword_4748FC</code>,<br />the function will TRUE - it&#39;s a trusted module.<br /><br />Modify either <code>dword_4748FC</code> or <code>dword_4748FC</code>, inject, and restore after injection.<br /><br /><h4>#### Manual Map</h4><br />You could also just manual map</div>
</body>
</html>
