<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>NTDS.dit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Dumping &amp; Cracking - NTDS.dit</h1></strong><br />NTDS.dit is located at:<br /><code>C:\Windows\System32\NTDS\ntds.dit</code><br /><br />Remember to grab both:<br />• <code>NTDS.dit</code> <br />• and <code>SYSTEM</code> - <code>reg.exe save HKLM\SYSTEM system</code><br /><br />There&#39;s multiple techniques to extract NTDS.dit, but all fall under one of these methods:<br />1. Domain Controller Replication Services<br />2. Native Windows binaries<br />3. WMI<br />4. Custom binaries<br /><br /><strong>Links</strong><br />• <a href="https://blog.ropnop.com/extracting-hashes-and-domain-info-from-ntds-dit/">https://blog.ropnop.com/extracting-hashes-and-domain-info-from-ntds-dit/</a><br />• <a href="https://pentestlab.blog/tag/ntds-dit/">https://pentestlab.blog/tag/ntds-dit/</a><br />• <a href="https://adsecurity.org/?p=2398">https://adsecurity.org/?p=2398</a><br /><br /><strong><h2>## Extract hashes from offline NTDS.dit and SYSTEM files</h2></strong><br />Use Impacket&#39;s <code>secretsdump.py</code><br />The <code>LOCAL</code> option extracts hashes from a local copy of NTDS.dit<br /><br /><code>secretsdump.py -ntds &lt;NTDS.dit file&gt; -system &lt;SYSTEM file&gt; LOCAL -outputfile ntds-dump.txt</code><br /><br /><strong><h2>## Notes on Users</h2></strong><br />• Users that end in <code>$</code> are machine accounts, and will have super strong passwords<br />   ◇ e.g. WIN2K8$, WINXP1$, WIN2K31$, WIN7$<br />• krbtgt<br />   ◇ Found a krbtgt user? You won&#39;t crack this password<br />   ◇ This is a golden ticket<br />   ◇ You can use this to forge a ticket to look like any user</div>
</body>
</html>
