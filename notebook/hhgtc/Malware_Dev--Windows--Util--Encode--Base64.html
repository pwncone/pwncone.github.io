<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Base64</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Base64</h1></strong><br />â€¢ <a href="https://github.com/maldevel/RSA2048/blob/master/RSA2048/base64.c">https://github.com/maldevel/RSA2048/blob/master/RSA2048/base64.c</a><br /><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;Windows.h&gt;<br /><br />/*<br />Returns&nbsp;a&nbsp;base64&nbsp;encoded&nbsp;string.<br />Use&nbsp;free()&nbsp;after&nbsp;you&#39;re&nbsp;finished&nbsp;with&nbsp;the&nbsp;string!<br />*/<br />char*&nbsp;b64EncodeA(char*&nbsp;src,&nbsp;DWORD&nbsp;src_len)<br />{<br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br />	char*&nbsp;encoded_str&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;encoded_len&nbsp;=&nbsp;0;<br /><br />	//&nbsp;Get&nbsp;size&nbsp;of&nbsp;encoded&nbsp;string<br />	b&nbsp;=&nbsp;CryptBinaryToStringA(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64&nbsp;|&nbsp;CRYPT_STRING_NOCRLF,&nbsp;NULL,&nbsp;&amp;encoded_len);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />		return&nbsp;NULL;<br /><br />	encoded_str&nbsp;=&nbsp;malloc(encoded_len&nbsp;*&nbsp;sizeof(char));<br />	if&nbsp;(encoded_str&nbsp;==&nbsp;NULL)<br />		return&nbsp;NULL;<br />	memset(encoded_str,&nbsp;0,&nbsp;encoded_len);<br /><br />	//&nbsp;Encode&nbsp;string<br />	b&nbsp;=&nbsp;CryptBinaryToStringA(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64&nbsp;|&nbsp;CRYPT_STRING_NOCRLF,&nbsp;encoded_str,&nbsp;&amp;encoded_len);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		free(encoded_str);<br />		return&nbsp;NULL;<br />	}<br /><br />	return&nbsp;encoded_str;<br />}<br /><br />/*<br />Returns&nbsp;a&nbsp;base64&nbsp;decoded&nbsp;string.<br />Use&nbsp;free()&nbsp;after&nbsp;you&#39;re&nbsp;finished&nbsp;with&nbsp;the&nbsp;string!<br />*/<br />char*&nbsp;b64DecodeA(char*&nbsp;src,&nbsp;DWORD&nbsp;src_len)<br />{<br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br />	char*&nbsp;decoded_str&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;decoded_len&nbsp;=&nbsp;0;<br /><br />	//&nbsp;Get&nbsp;size&nbsp;of&nbsp;decoded&nbsp;string<br />	b&nbsp;=&nbsp;CryptStringToBinaryA(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64,&nbsp;NULL,&nbsp;&amp;decoded_len,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />		return&nbsp;NULL;<br /><br />	decoded_str&nbsp;=&nbsp;malloc(decoded_len&nbsp;*&nbsp;sizeof(char)&nbsp;+&nbsp;1);<br />	if&nbsp;(decoded_str&nbsp;==&nbsp;NULL)<br />		return&nbsp;NULL;<br />	memset(decoded_str,&nbsp;0,&nbsp;decoded_len&nbsp;+&nbsp;1);<br /><br />	//&nbsp;Decode&nbsp;string<br />	b&nbsp;=&nbsp;CryptStringToBinaryA(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64,&nbsp;decoded_str,&nbsp;&amp;decoded_len,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		free(decoded_str);<br />		return&nbsp;NULL;<br />	}<br /><br />	return&nbsp;decoded_str;<br />}<br /><br />/*<br />DOESN&#39;T&nbsp;WORK&nbsp;OMEGALUL.<br />Returns&nbsp;a&nbsp;base64&nbsp;encoded&nbsp;string.<br />Use&nbsp;free()&nbsp;after&nbsp;you&#39;re&nbsp;finished&nbsp;with&nbsp;the&nbsp;string!<br />*/<br />wchar_t*&nbsp;b64EncodeW(wchar_t*&nbsp;src,&nbsp;DWORD&nbsp;src_len)<br />{<br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br />	wchar_t*&nbsp;encoded_str&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;encoded_len&nbsp;=&nbsp;0;<br /><br />	//&nbsp;Get&nbsp;size&nbsp;of&nbsp;encoded&nbsp;string<br />	b&nbsp;=&nbsp;CryptBinaryToStringW((BYTE*)src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64&nbsp;|&nbsp;CRYPT_STRING_NOCRLF,&nbsp;NULL,&nbsp;&amp;encoded_len);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />		return&nbsp;NULL;<br /><br />	encoded_str&nbsp;=&nbsp;malloc(encoded_len&nbsp;*&nbsp;sizeof(wchar_t));<br />	if&nbsp;(encoded_str&nbsp;==&nbsp;NULL)<br />		return&nbsp;NULL;<br />	memset(encoded_str,&nbsp;0,&nbsp;encoded_len);<br /><br />	//&nbsp;Encode&nbsp;string<br />	b&nbsp;=&nbsp;CryptBinaryToStringW((BYTE*)src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64&nbsp;|&nbsp;CRYPT_STRING_NOCRLF,&nbsp;encoded_str,&nbsp;&amp;encoded_len);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		free(encoded_str);<br />		return&nbsp;NULL;<br />	}<br /><br />	return&nbsp;encoded_str;<br />}<br /><br />/*<br />DOESN&#39;T&nbsp;WORK&nbsp;OMEGALUL.<br />Returns&nbsp;a&nbsp;base64&nbsp;decoded&nbsp;string.<br />Use&nbsp;free()&nbsp;after&nbsp;you&#39;re&nbsp;finished&nbsp;with&nbsp;the&nbsp;string!<br />*/<br />wchar_t*&nbsp;b64DecodeW(wchar_t*&nbsp;src,&nbsp;DWORD&nbsp;src_len)<br />{<br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br />	wchar_t*&nbsp;decoded_str&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;decoded_len&nbsp;=&nbsp;0;<br /><br />	//&nbsp;Get&nbsp;size&nbsp;of&nbsp;decoded&nbsp;string<br />	b&nbsp;=&nbsp;CryptStringToBinaryW(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64,&nbsp;NULL,&nbsp;&amp;decoded_len,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />		return&nbsp;NULL;<br /><br />	decoded_str&nbsp;=&nbsp;malloc(decoded_len&nbsp;*&nbsp;sizeof(wchar_t)&nbsp;+&nbsp;1);<br />	if&nbsp;(decoded_str&nbsp;==&nbsp;NULL)<br />		return&nbsp;NULL;<br />	memset(decoded_str,&nbsp;0,&nbsp;decoded_len&nbsp;+&nbsp;1);<br /><br />	//&nbsp;Decode&nbsp;string<br />	b&nbsp;=&nbsp;CryptStringToBinaryW(src,&nbsp;src_len,&nbsp;CRYPT_STRING_BASE64,&nbsp;(BYTE*)decoded_str,&nbsp;&amp;decoded_len,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		free(decoded_str);<br />		return&nbsp;NULL;<br />	}<br /><br />	return&nbsp;decoded_str;<br />}<br /><br />int&nbsp;main(void)<br /><span style="color:#000000;font-weight:400">{</span><br />	//&nbsp;Base64&nbsp;A<br />	char&nbsp;str_orig[]&nbsp;=&nbsp;&quot;hey&nbsp;there&nbsp;how&#39;s&nbsp;it&nbsp;goin&#39;&nbsp;:)&quot;;<br />	char*&nbsp;str_b64&nbsp;=&nbsp;NULL;<br />	char*&nbsp;str_plain&nbsp;=&nbsp;NULL;<br />	<br />	str_b64&nbsp;=&nbsp;b64EncodeA(str_orig,&nbsp;strlen(str_orig));<br />	if&nbsp;(str_b64&nbsp;==&nbsp;NULL)<br />		return&nbsp;1;<br /><br />	str_plain&nbsp;=&nbsp;b64DecodeA(str_b64,&nbsp;strlen(str_b64));<br />	if&nbsp;(str_plain&nbsp;==&nbsp;NULL)<br />		return&nbsp;1;<br /><br />	printf(&quot;str_orig:&nbsp;%s&nbsp;\n&quot;,&nbsp;str_orig);<br />	printf(&quot;str_b64:&nbsp;%s&nbsp;\n&quot;,&nbsp;str_b64);<br />	printf(&quot;str_plain:&nbsp;%s&nbsp;\n&quot;,&nbsp;str_plain);<br /><br />	free(str_b64);<br />	free(str_plain);<br />	<br />	return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
