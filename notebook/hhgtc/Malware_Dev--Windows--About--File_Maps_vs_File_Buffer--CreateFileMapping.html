<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>CreateFileMapping</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># CreateFileMapping</h1></strong><br />This maps a file on disk into local memory inside your process.<br /><br /><div class="codebox"><div class="codebox">LPVOID&nbsp;MapFileIntoMemory(char*&nbsp;file_name)<br /><span style="color:#000000;font-weight:400">{</span><br />	LPVOID&nbsp;file_mapping&nbsp;=&nbsp;NULL;<br />	HANDLE&nbsp;h_file&nbsp;=&nbsp;NULL;<br />	HANDLE&nbsp;h_mapping&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;file_size&nbsp;=&nbsp;0;<br /><br />	//&nbsp;open&nbsp;target&nbsp;file<br />	h_file&nbsp;=&nbsp;CreateFileA(file_name,&nbsp;GENERIC_ALL,&nbsp;0,&nbsp;NULL,&nbsp;OPEN_EXISTING,&nbsp;FILE_ATTRIBUTE_NORMAL,&nbsp;NULL);<br />	if&nbsp;(h_file&nbsp;==&nbsp;INVALID_HANDLE_VALUE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;open&nbsp;target&nbsp;file:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		return&nbsp;NULL;<br />	}<br />	printf(&quot;file&nbsp;handle:&nbsp;0x%p&nbsp;\n&quot;,&nbsp;h_file);<br /><br />	h_mapping&nbsp;=&nbsp;CreateFileMappingA(h_file,&nbsp;NULL,&nbsp;PAGE_EXECUTE_READWRITE,&nbsp;0,&nbsp;0,&nbsp;NULL);<br />	if&nbsp;(h_mapping&nbsp;==&nbsp;NULL)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;create&nbsp;mapping&nbsp;object:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		return&nbsp;NULL;<br />	}<br />	printf(&quot;mapping&nbsp;handle:&nbsp;0x%p&nbsp;\n&quot;,&nbsp;h_mapping);<br /><br />	file_mapping&nbsp;=&nbsp;MapViewOfFile(h_mapping,&nbsp;FILE_MAP_ALL_ACCESS,&nbsp;0,&nbsp;0,&nbsp;0);<br />	if&nbsp;(file_mapping&nbsp;==&nbsp;NULL)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;map&nbsp;file&nbsp;into&nbsp;memory:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		return&nbsp;NULL;<br />	}<br />	printf(&quot;file_mapping:&nbsp;0x%p&nbsp;\n&quot;,&nbsp;file_mapping);<br /><br />	return&nbsp;file_mapping;<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
