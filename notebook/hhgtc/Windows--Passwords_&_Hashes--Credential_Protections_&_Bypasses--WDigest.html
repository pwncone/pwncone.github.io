<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WDigest</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># WDigest</h1></strong><br />WDigest was implemented in Windows XP.<br />It was designed to be an authentication mechanism used with the HTTP protocol.<br /><br /><strong><h2>## Location / Check if enabled</h2></strong><br />It&#39;s found in the registry at:<br /><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurityProviders\WDigest</code><br />with the registry keys:<br /><code>UseLogonCredential</code><br /><code>Negotiate</code><br /><br />Keys set to 1? = WDigest enabled<br />Keys set to 0 or keys don&#39;t exist? = WDigest disabled<br /><br />Enabled by default in<br />• Windows XP -&gt; Windows 8.0<br />• Windows Server 2003 -&gt; Windows Server 2012<br /><br /><strong><h2>## Re-Enable</h2></strong><br />To re-enable WDigest, add a <code>UseLogonCredential</code> key with a value of 1:<br /><code>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /f /d 1</code><br /><br /> To take effect, conditions are required :<br />• Win7 / 2008R2 / 8 / 2012 / 8.1 / 2012R2:• Adding requires lock<br />• Removing requires signout<br /><br />• Win10:• Adding requires signout<br />• Removing requires signout<br /><br />• Win2016:• Adding requires lock<br />• Removing requires reboot<br /><br /><strong><h2>## Dump</h2></strong><br /><strong><h3>### Mimikatz</h3></strong><br />Dump credentials from WDigest with Mimikatz<br /><code>sekurlsa::wdigest</code><br /><br /></div>
</body>
</html>
