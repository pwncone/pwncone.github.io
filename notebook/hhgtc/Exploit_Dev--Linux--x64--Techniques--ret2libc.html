<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ret2libc</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Exploit Development - Linux - x64 - ret2libc</h1></strong><br />The difference with ret2libc on a 64-bit machine is that function parameters are stored in registers - <code>RDI, RSI, RDX, RCX, R8, R9</code> (in that order).<br /><br /><strong>To store a function parameter in a register:</strong><br />1. Write the parameter to the stack.<br />2. Use a <code>pop ?; ret</code> gadget to pop that value into your specified register.<br /><br /><strong><h2>## How-to - Find a pop ?; ret gadget</h2></strong><br />• Refer to the <em><code>Tools</code></em> node for more comprehensive info<br /><br /><strong><h3>### gdb-peda</h3></strong><br /><code>ropsearch &quot;pop rdi&quot;</code><br /><code>ropsearch &quot;pop rdi&quot; libc</code><br /><br /><strong><h3>### ropper</h3></strong><br /><code>ropper --file myBinary --badbytes 6269632f20666e73 --search &quot;pop rdi&quot;</code><br /><br /><strong><h3>### rp++</h3></strong><br /><code>rp++ -f &lt;binary&gt; -r 1 | grep ret</code><br /><br /><strong><h3>### objdump</h3></strong><br /><code>objdump -M intel -d &lt;binary&gt; | grep rdi</code><br /></div>
</body>
</html>
