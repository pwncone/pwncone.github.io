<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Credential Guard</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Credential Guard</h1></strong><br />Implemented in Windows 10 (Enterprise and Education).<br />Helps to protect credentials from pass-the-hash attacks.<br /><br /><a href="https://www.itprotoday.com/windows-10/what-credential-guard">https://www.itprotoday.com/windows-10/what-credential-guard</a><br /><a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-manage">https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-manage</a><br /><br /><strong><h2>## VSM - Virtual Secure Mode</h2></strong><br />Credential Guard uses a technology called VSM - <em>Virtual Secure Mode</em>.<br />Also referred to as VBS - <em>Virtualisation Based Seucrity </em><br /><br />VSM uses the virtualisation capabiltiies of the CPU to create protected areas of memory where processes can run.<br />   ◇ Only specific trusted processes - <em>trustlets</em> - can communicate with the processes inside VSM<br />   ◇ Even kernel processes can&#39;t read processes in VSM<br /><br />LSA is a trustlet - a trusted process - in VSM.<br /><br /><strong><h3>### Enable VSM</h3></strong><br />• VSM is NOT ENABLED BY DEFAULT<br /><br /><strong><h3>### Detect if VSM enabled</h3></strong><br />There&#39;s no obvious way.<br />Can check <code>LsaCfgFlags</code> key in:<br /><code>HKLM\System\CurrentControlSet\Control\LSA</code><br /><br />2 = VSM enabled wihtout UEFI lock<br />1 = VSM enabled with UEFI lock<br />0 = VSM not enabled<br /><br />This isn&#39;t 100%, but a good indicator of whether Credential Guard is enabeld or not.<br /> <br /><strong><h2>## Bypass Credential Guard</h2></strong><br />Good luck lmao.<br />Nothing exists yet (that I know of).</div>
</body>
</html>
