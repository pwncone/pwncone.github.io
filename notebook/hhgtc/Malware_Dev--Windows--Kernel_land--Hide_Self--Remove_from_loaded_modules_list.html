<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Remove from loaded modules list</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'>The PsLoadedModuleList is a kernel global.<br />It&#39;s an array of poits to all loaded kernel modules on the system.<br />It&#39;s protected by PatchGuard, so by modifying it you BSOD. <br />It&#39;s a no-go.<br />Reference:<br />â€¢ <a href="https://revers.engineering/hiding-drivers-on-windows-10/">https://revers.engineering/hiding-drivers-on-windows-10/</a><br /><br />To remove an entry from the PsLoadedModuleList,<br />you can use <code>MiProcessLoaderEntry</code>.<br /><div class="codebox"><div class="codebox">//&nbsp;FALSE&nbsp;to&nbsp;remove.<br />MiProcessLoaderEntry(&nbsp;(&nbsp;PKLDR_DATA_TABLE_ENTRY&nbsp;)(&nbsp;DriverLdrEntry&nbsp;),&nbsp;FALSE&nbsp;);</div></div></div>
</body>
</html>
