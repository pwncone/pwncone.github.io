<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>GraphQL</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1>#JSON - GraphQL</h1></strong><br /><a href="https://blog.doyensec.com/2018/05/17/graphql-security-overview.html">https://blog.doyensec.com/2018/05/17/graphql-security-overview.html</a><br /><a href="https://github.com/doyensec/graph-ql/">https://github.com/doyensec/graph-ql/</a><br /><a href="https://medium.com/@localh0t/discovering-graphql-endpoints-and-sqli-vulnerabilities-5d39f26cea2e">https://medium.com/@localh0t/discovering-graphql-endpoints-and-sqli-vulnerabilities-5d39f26cea2e</a><br /><br /><strong><h2>## What is GraphQL?</h2></strong><br />GraphQL is an alternative to REST API. <br />It&#39;s a data query language developed by Facebook and publicly released in 2015. <br />Nowadays, GraphQL by a lots of big tech giants - GitHub, Pinterest, Twitter, HackerOne, and more.<br /><br />In REST APIs, the client interacts with programmer written code to retrieve JSON data.<br />In GraphQL, the client interacts with GraphQL, and then GraphQL interacts with the programmer written code to retrieve JSON data.<br /><a href=""><img src="images/268-1.png" alt="images/268-1.png" /></a><br />(Image credits: <a href="http://bearcatjs.org/graphql-versus-rest-api/">http://bearcatjs.org/graphql-versus-rest-api/</a>)<br /><br />This means that requests for data can be simpler, and you can retrieve multiple pieces of data from multiple sources with 1 request (unlike REST which would take multiple).<br /><br /><strong><h2>## Why is GraphQL vulnerable?</h2></strong><br />GraphQL can be a lot of work to set up because GraphQL won&#39;t interact with your databases automatically.<br />The backend programmer has to code all of the available GraphQL queries they want.<br /><br />Since developers are writing all this code and are in charge of implementing access control, GraphQL applications are prone to classical web application vulnerabilities like Broken Access Controls, Insecure Direct Object References, Cross Site Scripting (XSS), Classic Injection Bugs, and SQL Injection vulnerabilities.<br /><br />More info can be found here:<br /><a href="https://blog.doyensec.com/2018/05/17/graphql-security-overview.html">https://blog.doyensec.com/2018/05/17/graphql-security-overview.html</a><br /><br /><strong><h2>## Identify GraphQL Backend</h2></strong><br /><strong><h3>### URLs</h3></strong><br />If you find any of these URLs, you&#39;ve probably found GraphQL.<br /><code>/graphql<br />/graphql/console/<br />/graphql.php<br />/graphql.php?debug=1</code> (debugging mode with additional error reporting, may be left open by developers)<code><br />/graphiql<br />/graphiql.php</code><br /><br /><strong><h3>### Error Message</h3></strong><br />You can check for a GraphQL backend by sending an intentionally wrong query and reading the error message:<br /><code>http://example.com/graphql?query={}</code><br /><a href=""><img src="images/268-2.png" alt="images/268-2.png" /></a><br /><br /><strong><h2>## Retrieve Data from GraphQL</h2></strong><br />Once you&#39;ve found the GraphQL endpoint, you need to find what data you can get.<br />The GraphQL <code>IntrospectionQuery</code> is how this is normally done.<br /><br /><strong><h3>### doyensec&#39;s Script</h3></strong><br />Rather than using <code>IntrospectionQuery</code> yourself, doyensec has a useful script.<br /><a href="https://github.com/doyensec/graph-ql/">https://github.com/doyensec/graph-ql/</a><br /><br /><code>python GraphQL_Introspection.py -t http://10.10.10.121:3000/graphql</code><br /><br />Check the ‘query’ folder from the results, should see something like this:<br /><code>{&quot;query&quot;:&quot;query{user(){username password }}&quot;}</code><br /><br />Use the query in the URL like so to retrieve data: <br /><code>http://10.10.10.121:3000/graphql?query={user{username password}}</code></div>
</body>
</html>
