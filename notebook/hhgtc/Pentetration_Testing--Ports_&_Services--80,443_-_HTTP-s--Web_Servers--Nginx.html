<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Nginx</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Nginx</h1></strong><br />Nginx is a modern lightweight web server that can also be configured as a reverse proxy, a load balancer, a mail proxy, and a HTTP cache.<br /><br />It&#39;s not often that Nginx has vulnerabilities.<br /><br /><strong><h2>## Nginx Configuration</h2></strong><br /><strong><h3>### Alias LFI Misconfiguration</h3></strong><br />Inside the Nginx configuration look at the &quot;location&quot; statements<br />If one of the statements looks like this:<br /><div class="codebox"><div class="codebox">location&nbsp;/imgs&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;alias&nbsp;/path/images/&nbsp;<br />}</div></div><br /><br />Then you&#39;ve found an LFI vulnerability.<br />This is because the file path in the <code>location</code> statement is missing a trailing <code>/</code><br />It should look like this:<br /><div class="codebox"><div class="codebox">location&nbsp;/imgs/&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;alias&nbsp;/path/images/&nbsp;<br />}</div></div><br /><br />Because of the missing <code>/</code>, you could enter a location like this and access the directory above.<br /><div class="codebox"><div class="codebox">/imgs../flag.txt</div></div><br /><br />The above location would be translated in this file path:<br /><div class="codebox"><div class="codebox">/path/images/../flag.txt</div></div><br /><br />It&#39;s also possible to discover this LFI misconfiguration if you find that your files/directories bruteforce is behaving weird.<br />More info: <a href="https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/">https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/</a>​<br /><br /><strong>#### Accunetix Tests</strong><br /><div class="codebox"><div class="codebox">alias../&nbsp;=&gt;&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;403<br />alias.../&nbsp;=&gt;&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;404<br />alias../../&nbsp;=&gt;&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;403<br />alias../../../../../../../../../../../&nbsp;=&gt;&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;400<br />alias../&nbsp;=&gt;&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;403</div></div><br /><br /><strong><h3>### GIXY - Analyse Nginx Config</h3></strong><br />​<a href="https://github.com/yandex/gixy">GIXY</a>​<br />Gixy is a tool to analyse the Nginx configuration.</div>
</body>
</html>
