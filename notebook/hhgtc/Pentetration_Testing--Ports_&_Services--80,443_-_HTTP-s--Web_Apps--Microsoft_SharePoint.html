<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Microsoft SharePoint</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Microsoft SharePoint</h1></strong><br />• <a href="https://resources.bishopfox.com/files/tools/sharepointdiggity/SharePoint%20-%20URL%20Extensions%20-%2018MAR2012.pdf">https://resources.bishopfox.com/files/tools/sharepointdiggity/SharePoint%20-%20URL%20Extensions%20-%2018MAR2012.pdf</a> - All about SharePoint + endpoints + extra:<br />• <a href="https://resources.bishopfox.com/resources/tools/sharepoint-hacking-diggity/attack-tools/#sharepoint-userdispenum">https://resources.bishopfox.com/resources/tools/sharepoint-hacking-diggity/attack-tools/#sharepoint-userdispenum</a> - Attack tools<br /><br /><strong><h2>## Wordlists</h2></strong><br /><code>/usr/share/wfuzz/wordlist/vulns/sharepoint.txt</code><br /><br /><strong><h2>## Info</h2></strong><br />• SharePoint is tied closely with the hostname<br />   ◇ Write into /etc/hosts the hostname of the machine <br />      ▪ e.g. <code>10.10.10.52 machine1</code><br />      ▪ not <code>10.10.10.52 machine1.com</code><br />   ◇ Some pages will only respond/list files correctly if using the hostname in the url<br />      ▪ example from <em>hackthebox Tally</em><br />         - This lists the site page - <a href="http://tally/_layouts/15/start.aspx#/SitePages/Forms/AllPages.aspx">http://tally/_layouts/15/start.aspx#/SitePages/Forms/AllPages.aspx</a><br />         - This doesn&#39;t <a href="http://tally/_layouts/15/start.aspx#/SitePages/Forms/AllPages.aspx">http://tally.htb/_layouts/15/start.aspx#/SitePages/Forms/AllPages.aspx</a><br /><br /><strong><h2>## SharePoint Endpoints</h2></strong><br />• <code>/_layouts/viewlsts.aspx</code> - list files on server<br />   ◇ used in <em>hackthebox Tally</em><br />• <code>/_layouts/userdisp.aspx?ID=1</code> -  might be able to enumerate users<br />• Lists of Endpoints<br />   ◇ <a href="https://resources.bishopfox.com/files/tools/sharepointdiggity/SharePoint%20-%20URL%20Extensions%20-%2018MAR2012.pdf">https://resources.bishopfox.com/files/tools/sharepointdiggity/SharePoint%20-%20URL%20Extensions%20-%2018MAR2012.pdf</a> - very good<br />   ◇ <a href="https://gist.github.com/lgrangeia/3696de8363e2cbe6869871878ae00e30">https://gist.github.com/lgrangeia/3696de8363e2cbe6869871878ae00e30</a><br />   ◇ <code>/usr/share/wfuzz/wordlist/vulns/sharepoint.txt</code><br /><br /><strong><h2>## Verifying SharePoint</h2></strong><br />If you were unsure that the website is SharePoint, you can identify it:<br />• viewing the source of the web page?<br />• visually via Microsoft&#39;s website - <a href="https://support.office.com/en-us/article/which-version-of-sharepoint-am-i-using-3575ff57-037f-48cf-9398-99080c34b25f">https://support.office.com/en-us/article/which-version-of-sharepoint-am-i-using-3575ff57-037f-48cf-9398-99080c34b25f</a><br />• checking the reponse from the webserver<br />   ◇ <a href=""><img src="images/238-1.png" alt="images/238-1.png" /></a><br /><br /><strong><h2>## SharePoint &amp; Directory Bruteforcing</h2></strong><br />• Gobuster/directory bruteforcing runs slowly against SharePoint<br />   ◇ No idea why<br /><br /><br /><br /></div>
</body>
</html>
