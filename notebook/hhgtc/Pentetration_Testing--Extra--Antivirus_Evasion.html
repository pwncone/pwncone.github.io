<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Antivirus Evasion</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Antivirus Evasion</h1></strong><br />In this node specifically I&#39;m looking at Antivirus Evasion within pentests.<br />This is less about writing your code which avoids antivirus, but about hiding existing binaries you already have from being detected when you drop them onto a target.<br /><br />Antivirus evasion is all about research.<br />You find our what the target is running, set up a VM that mimics the target system as closely as possible, and experiment with different AV techniques to create an undetectable payload.<br />That&#39;s all there is to it.<br /><br /><strong><h2>## Links</h2></strong><br />• <a href="https://github.com/topics/antivirus-evasion">https://github.com/topics/antivirus-evasion</a><br />• <a href="https://book.hacktricks.xyz/windows/av-bypass">https://book.hacktricks.xyz/windows/av-bypass</a><br />• <a href="https://www.rapid7.com/info/encapsulating-antivirus-av-evasion-techniques-in-metasploit-framework/">https://www.rapid7.com/info/encapsulating-antivirus-av-evasion-techniques-in-metasploit-framework/</a><br />• <a href="https://resources.infosecinstitute.com/antivirus-evasion-tools/">https://resources.infosecinstitute.com/antivirus-evasion-tools/</a><br /><br /><strong>Blog links (unique/independent stuff)</strong><br />• <a href="https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15">https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15</a><br />• <a href="http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/">http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/</a><br />• <a href="https://netsec.expert/2020/02/06/write-a-crypter-in-any-language.html">https://netsec.expert/2020/02/06/write-a-crypter-in-any-language.html</a> - Write your own crypter<br />• <a href="http://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/">http://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/</a> - python custom crypter<br /><br /><strong>Tools</strong><br />• Hyperion - encrypts binary<br />• Veil Framework - turns a script or shellcode into a Windows executable<br />• peCloak - Author wrote for self, but published a beta version<br />• TheFatRat - Compiles a malware with popular payload. Supports Windows, Android, Mac<br />• Shelter - dynamic shellcode injection tool. Has pro version<br />• Phantom Evasion<br /><br /><strong>Test your AV Evasion</strong><br />These sites will run your executable through a multiple of Antivirus vendors and tell you which vendors flag your file as malicious.<br /><br />• <a href="https://www.virustotal.com">https://www.virustotal.com</a> - Google owned. Shares your file with Antivirus Companies.<br />• <a href="https://www.nodistribute.com/">https://www.nodistribute.com/</a> - Same as above (almost) but doesn&#39;t share file</div>
</body>
</html>
