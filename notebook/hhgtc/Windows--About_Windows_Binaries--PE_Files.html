<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PE Files</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># The PE File Format</h1></strong><br />PE stands for <em>Portable Executable</em>, and is the file format for executable files on Windows.<br /><br /><strong>Resources</strong><br />• <a href="http://www.skyfree.org/linux/references/coff.pdf">http://www.skyfree.org/linux/references/coff.pdf</a> - PE Specification - BEST PLACE TO LOOK<br />• <a href="https://www.youtube.com/watch?v=l6GjU8fm8sM">https://www.youtube.com/watch?v=l6GjU8fm8sM</a> - MalwareAnalysisForHedgehogs<br />• <a href="https://resources.infosecinstitute.com/2-malware-researchers-handbook-demystifying-pe-file/">https://resources.infosecinstitute.com/2-malware-researchers-handbook-demystifying-pe-file/</a> - Basic<br />• <a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#File_Format">https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#File_Format</a> - Indepth but good<br />• Matt Pietrek - updated version of 1994 article<br />   ◇ Part 1 - <a href="http://www.delphibasics.info/home/delphibasicsarticles/anin-depthlookintothewin32portableexecutablefileformat-part1">http://www.delphibasics.info/home/delphibasicsarticles/anin-depthlookintothewin32portableexecutablefileformat-part1</a><br />   ◇ Part 2 - <a href="http://www.delphibasics.info/home/delphibasicsarticles/anin-depthlookintothewin32portableexecutablefileformat-part2">http://www.delphibasics.info/home/delphibasicsarticles/anin-depthlookintothewin32portableexecutablefileformat-part2</a><br />• <a href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format">https://docs.microsoft.com/en-us/windows/win32/debug/pe-format</a> - Microsoft Official<br />• <a href="https://blog.kowalczyk.info/articles/pefileformat.html">https://blog.kowalczyk.info/articles/pefileformat.html</a><br />• <a href="https://raw.githubusercontent.com/thecyberhex/books/master/Reverse%20Engineering%20for%20Beginners.pdf">https://raw.githubusercontent.com/thecyberhex/books/master/Reverse%20Engineering%20for%20Beginners.pdf</a> - Chatper 68 - Windows NT<br /><br /><strong><h2>## The PE File Format</h2></strong><br />PE stands for <em>Portable Executable</em>/<br />The PE file format contains all the information Windows needs to load the executable into memory and execute it.<br />They&#39;re called Portable Executables because they were designed by Microsoft to run on all Windows flavours and support all CPUs.<br /><br />A 32-bit PE is <code>PE32</code><br />A 64-bit PE is <code>PE32+</code><br /><br /><code>.exe</code> and <code>.dll</code> files both use the exact same PE format.<br /><br />There are 6 main parts to the PE format:<br />• <strong>DOS Header</strong> - identifies the file as a DOS file and points to the PE header<br />• <strong>DOS Stub</strong> - a mini DOS program that prints &quot;this program cannot be run in DOS mode&quot;<br />• <strong>PE Header</strong> - identifies the file as a PE file and points to more file information<br />   ◇ <code>COFF Header</code> - defines system architecture (x86 vs x64) and the number of sections<br />   ◇ <code>Optional Header</code> - contains info related to loading the PE - architecture, base address, entry point<br />• <strong>Data Directories</strong> - contains info about exported functions, imported functions, relocations, etc.<br />• <strong>Section Table</strong> - describes the sections of the PE and their size &amp; address in the binary - <code>.text</code> <code>.data</code> etc.<br />• <strong>Sections</strong> - last are the PE&#39;s sections themselves - <code>.text</code> <code>.data</code> etc.<br /><br />Here&#39;s a small diagram:<br /><a href=""><img src="images/862-1.png" alt="images/862-1.png" /></a></div>
</body>
</html>
