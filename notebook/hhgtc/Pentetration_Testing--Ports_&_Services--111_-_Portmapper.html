<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>111 - Portmapper</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 111 - Portmapper</h1></strong><br />Portmapper provides information between Unix-based systems.<br />It can be used to fingerprint the OS, obtain information about services.<br />Portmapper is often used with NFS, NIS, or RPC in general.<br /><br /><strong><h2>## Grab info</h2></strong><br /><code>rpcinfo irked.htb</code><br /><code>nmap -p 111 -sSUC 10.11.0.4</code><br /><br /><strong><h2>## Check for NFS</h2></strong><br />Nmap scripts:<br /><div class="codebox"><div class="codebox">nfs-ls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#List&nbsp;NFS&nbsp;exports&nbsp;and&nbsp;check&nbsp;permissions<br />nfs-showmount&nbsp;&nbsp;&nbsp;#Like&nbsp;showmount&nbsp;-e<br />nfs-statfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Disk&nbsp;statistics&nbsp;and&nbsp;info&nbsp;from&nbsp;NFS&nbsp;share</div></div><br /><br />Metasploit:<br /><code>scanner/nfs/nfsmount</code><br /><br /><strong><h2>## Find Active RPC User Sessions</h2></strong><br />The RPC endpiont <code>rusersd</code> will reveal active user sessions<br /><div class="codebox"><div class="codebox">root@kali:~#&nbsp;apt-get&nbsp;install&nbsp;rusers<br />root@kali:~#&nbsp;rusers&nbsp;-l&nbsp;192.168.10.1<br />Sending&nbsp;broadcast&nbsp;for&nbsp;rusersd&nbsp;protocol&nbsp;version&nbsp;3...<br />Sending&nbsp;broadcast&nbsp;for&nbsp;rusersd&nbsp;protocol&nbsp;version&nbsp;2...<br />tiff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;potatohead:console&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sep&nbsp;&nbsp;2&nbsp;13:03&nbsp;&nbsp;&nbsp;22:03<br />katykat&nbsp;&nbsp;&nbsp;&nbsp;potatohead:ttyp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sep&nbsp;&nbsp;1&nbsp;09:35&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</div></div><br /><br /><strong><h2>## NIS</h2></strong><br />Upon obtaining the NIS domain name for the environment (example.org in this case), use the <code>ypwhich</code> command to ping the NIS server and <code>ypcat</code> to obtain sensitive material.<br /><div class="codebox"><div class="codebox">root@kali:~#&nbsp;apt-get&nbsp;install&nbsp;nis<br />root@kali:~#&nbsp;ypwhich&nbsp;-d&nbsp;example.org&nbsp;192.168.10.1<br />potatohead.example.org<br />root@kali:~#&nbsp;ypcat&nbsp;–d&nbsp;example.org&nbsp;–h&nbsp;192.168.10.1&nbsp;passwd.byname<br />tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash&nbsp;<br />katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash&nbsp;<br />james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh&nbsp;<br />florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh&nbsp;<br />dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash&nbsp;<br />yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash</div></div><br /><br />Crack dem hashes.</div>
</body>
</html>
