<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ActiveDirectory</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Internal Recon - of the Domain - with ActiveDirectory</h1></strong><br /><br /><strong>General domain info</strong><br /><code>Get-ADDomain</code> - get current domain<br /><code>Get-ADDomain -Identity moneycorp.local</code> - get object of another domain<br /><code>(Get-ADDomain).DomainSID</code> - get domain SID for the current domain<br /><br /><strong>Find Domain Controller</strong><br /><code>Get-ADDomainController</code> - get domain controllers for current domain<br /><code>Get-ADDomainController -DomainName moneycorp.local -Discover</code> - get domain controllers for another domain<br /><br /><strong>Enumerate Organisation Units</strong><br /><code>Get-ADOrganizationUnit -Filter * -Properties *</code> - get OUs in a domain<br /><br />Get GPO applied on an OU (read GPOname from gplink attribute from command above)<br /><code>Get-GPO -Guid AB306569-220D-43FF-B03B-83E8F4EF8081}</code><br /><br /><strong>Enumerate Users</strong><br /><code>Get-ADUser -Filter * -Properties *</code> - list users in the current domain<br />    <code>Get-ADUser -Filter * -Properties * | select Name</code> - list all users, get only <code>name</code> field<br />    <code>Get-ADUser -Identity student 1 -Properties *</code> - specific user<br /><br /><code>Get-ADPrincipalGroupMembership -Identity student1</code> - get group memership of a user<br /><br /><code>Get-ADUser -Filter * -Properties * | select -First 1 | Get-Member -MemberType *Property | select Name</code> - list all properties for users in the current domain<br /><br /><code>Get-ADUser -Filter * -Properties * | select name,@{expresssion={[datetime]::fromFileTime($_.pwdlastset)}}</code> - get pwdlastset property<br /><br />Search for a string in a user&#39;s attributes:<br /><code>Get-ADUser -Filter &#39;Description -like &quot;*built*&quot;&#39; -Properties Description | select name,Description</code><br /><br /><strong>Enumerate Groups</strong><br /><code>Get-ADGroup -Filter * | select Name</code><br /><code>Get-ADGroup -Filter * -Properties *</code><br /><br /><code>Get-ADGroup -Filter &#39;Name -like &quot;*admin*&quot;&#39; | select Name</code> - all groups with &quot;admin&quot; in the name<br /><br /><strong>Enumerate Group Members</strong><br /><code>Get-ADGroupMember -Identity &quot;Domain Admins&quot;</code><br /><code>Get-ADGroupMember -Identity &quot;Domain Admins&quot; -Recursive</code><br /><br /><strong>Enumerate Systems</strong><br /><code>Get-ADComputer -Filter * | select Name</code><br /><br /><code>Get-ADComputer -Filter &#39;OperatingSystem -like &quot;*Server 2016*&quot;&#39; -Properties OperatingSystem | select Name,OperatingSystem</code> - find systems by operating sysytem<br /><br /><code>Get-ADComputer -Filter * -Properties DNSHostName | %{Test-Connection -Count 1 -ComputerName $_.DNSHostName}</code> - ping a machine?<br /><br /><code>Get-ADComputer -Filter * -Properties *</code> - get all info about a computer<br /></div>
</body>
</html>
