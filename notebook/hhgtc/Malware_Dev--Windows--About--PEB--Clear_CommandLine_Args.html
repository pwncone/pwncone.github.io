<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Clear CommandLine Args</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Clear CommandLine Args</h1></strong><br />The PEB stores the command line arguments passed to the process.<br />Delete them if you want.<br /><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;Windows.h&gt;<br />#include&nbsp;&lt;winternl.h&gt;<br /><br />void&nbsp;ClearCmdlineFromPEB()<br /><span style="color:#000000;font-weight:400">{</span><br />	PPEB&nbsp;p_peb&nbsp;=&nbsp;NULL;<br /><br />	//&nbsp;grab&nbsp;PEB<br />#ifdef&nbsp;_WIN64<br />	p_peb&nbsp;=&nbsp;(PPEB)__readgsqword(0x60);<br />#else<br />	p_peb&nbsp;=&nbsp;(PPEB)__readfsdword(0x30);<br />#endif<br /><br />	void*&nbsp;args_addr&nbsp;=&nbsp;p_peb-&gt;ProcessParameters-&gt;CommandLine.Buffer;<br />	USHORT&nbsp;args_len&nbsp;=&nbsp;p_peb-&gt;ProcessParameters-&gt;CommandLine.Length;<br />	memset(args_addr,&nbsp;0x00,&nbsp;args_len);<br />	<br />	return;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /></div>
</body>
</html>
