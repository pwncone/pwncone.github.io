<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>glibc '$ORIGIN'</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># glibc &#39;$ORIGIN&#39; Expansion Privilege Escalation</h1></strong><br />CVE 2010-3847<br /><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-3847">https://nvd.nist.gov/vuln/detail/CVE-2010-3847</a><br /><a href="https://www.rapid7.com/db/modules/exploit/linux/local/glibc_origin_expansion_priv_esc">https://www.rapid7.com/db/modules/exploit/linux/local/glibc_origin_expansion_priv_esc</a><br /><br />&quot;elf/dl-load.c in ld.so in the GNU C Library (aka glibc or libc6) through 2.11.2, and 2.12.x through 2.12.1, does not properly handle a value of $ORIGIN for the LD_AUDIT environment variable, which allows local users to gain privileges via a crafted dynamic shared object (DSO) located in an arbitrary directory.&quot;<br /><br /><strong>Examples</strong><br />• oscp 10.11.1.35 - Pain<br /><br /><strong><h2>## Notes</h2></strong><br />• I&#39;ve only seen metasploit&#39;s <code>local_exploit_suggester</code> test for it<br />• Check <code>ld.so</code> version yourself with <code>ldd --version</code><br /><br /><strong><h2>## Exploits</h2></strong><br />• Metasploit module<br />   ◇ <code>exploit/linux/local/glibc_origin_expansion_priv_esc</code><br />      ▪ used in oscp 10.11.1.35 Pain<br />• Shell script<br />   ◇ Kabot - <a href="https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack/blob/master/2010/CVE-2010-3847.sh">https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack/blob/master/2010/CVE-2010-3847.sh</a><br />   ◇ hamano - <a href="https://gist.github.com/hamano/638467">https://gist.github.com/hamano/638467</a></div>
</body>
</html>
