<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Get Game Resolution</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Get Game Resolution</h1></strong><br />You&#39;ll need the game&#39;s resolution so you can draw on top of / within it.<br /><br />DONT&#39; FORGET ABOUT <code>GetForegroundWindow()</code>.<br />I haven&#39;t used it yet.<br /><br /><strong><h2>## FindWindowA and GetWindowRect</h2></strong><br /><code>FindWindowA</code> will grab a handle to the game&#39;s window.<br /><code>GetWindowRect</code> will grab its size.<br /><br />Window size is slightly larger than game&#39;s resolution<br />e.g. <br />game res = 1360 * 768<br />window size will be reported as 1366 * 797<br /><br />This is because of the size of the window border pixels on the left and top.<br />To fix, you can just manulally subtract.<br /><br /><div class="codebox"><div class="codebox">int&nbsp;gamewindow_width&nbsp;=&nbsp;0;<br />int&nbsp;gamewindow_height&nbsp;=&nbsp;0;<br /><br />/*<br />Grabs&nbsp;a&nbsp;handle&nbsp;to&nbsp;the&nbsp;game&#39;s&nbsp;window&nbsp;and&nbsp;then&nbsp;queries&nbsp;for&nbsp;its&nbsp;height&nbsp;and&nbsp;width.<br />Window&nbsp;size&nbsp;is&nbsp;slightly&nbsp;larger&nbsp;than&nbsp;game&#39;s&nbsp;resolution,&nbsp;so&nbsp;subtract&nbsp;6&nbsp;&amp;&nbsp;29&nbsp;to&nbsp;adjust.<br />*/<br />void&nbsp;gfx_GetWindowSize()<br /><span style="color:#000000;font-weight:400">{</span><br />	HWND&nbsp;h_gamewindow&nbsp;=&nbsp;FindWindowA(NULL,&nbsp;&quot;Counter-Strike:&nbsp;Global&nbsp;Offensive&quot;);	<br />	RECT&nbsp;window_size&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />	GetWindowRect(h_gamewindow,&nbsp;&amp;window_size);<br />	gamewindow_width&nbsp;=&nbsp;(window_size.right&nbsp;-&nbsp;window_size.left)&nbsp;-&nbsp;6;<br />	gamewindow_height&nbsp;=&nbsp;(window_size.bottom&nbsp;-&nbsp;window_size.top)&nbsp;-&nbsp;29;<br /><br />	printf(&quot;[*]&nbsp;Game&nbsp;window&nbsp;size:&nbsp;%d&nbsp;*&nbsp;%d&nbsp;\n&quot;,&nbsp;gamewindow_width,&nbsp;gamewindow_height);<br /><br />	return;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><strong><h2>## OpenGL - glGetIntegerv</h2></strong><br /><div class="codebox"><div class="codebox">glPushAttrib(GL_ALL_ATTRIB_BITS);<br />glPushMatrix();<br /><br />//&nbsp;Can&nbsp;only&nbsp;be&nbsp;done&nbsp;after&nbsp;glPushAttrib&nbsp;and&nbsp;glPushMatrix<br />GLint&nbsp;viewport[4]&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />glGetIntegerv(GL_VIEWPORT,&nbsp;viewport);<br />int&nbsp;gamewindow_width&nbsp;=&nbsp;viewport[2];<br />int&nbsp;gamewindow_height&nbsp;=&nbsp;viewport[3];</div></div><br /><br /><strong><h2>## EnumWindows &amp; custom EnumWindowsProc</h2></strong><br />Use EnumWindows to loop through all the handles to windows on the system.<br />Your custom EnumWindowsProc will keep looping until it grabs a handle to the game&#39;s window.<br />If you&#39;ve got a console window running, you&#39;ll have to skip it.<br /><br />Then you can use <code>GetWindowRect</code> to get the size of the window.<br /><br /><div class="codebox"><div class="codebox">HWND&nbsp;h_gamewindow&nbsp;=&nbsp;NULL;<br />int&nbsp;gamewindow_width&nbsp;=&nbsp;0;<br />int&nbsp;gamewindow_height&nbsp;=&nbsp;0;<br /><br />/*<br />Loop&nbsp;through&nbsp;windows&nbsp;on&nbsp;the&nbsp;system&nbsp;until&nbsp;we&nbsp;find&nbsp;the&nbsp;game&#39;s&nbsp;window.<br />This&nbsp;is&nbsp;our&nbsp;custom&nbsp;callback&nbsp;function&nbsp;to&nbsp;be&nbsp;used&nbsp;with&nbsp;EnumWindows().<br />*/<br />BOOL&nbsp;CALLBACK&nbsp;EnumWindowsProc(HWND&nbsp;hWnd,&nbsp;LPARAM&nbsp;lParam)<br />{<br />	//&nbsp;Get&nbsp;our&nbsp;game&#39;s&nbsp;process&nbsp;ID<br />	DWORD&nbsp;game_pid&nbsp;=&nbsp;GetCurrentProcessId();<br /><br />	/*<br />	Check&nbsp;the&nbsp;current&nbsp;window&#39;s&nbsp;process&nbsp;ID.<br />	We&#39;re&nbsp;looking&nbsp;for&nbsp;a&nbsp;handle&nbsp;to&nbsp;the&nbsp;game&#39;s&nbsp;window.<br />	If&nbsp;the&nbsp;current&nbsp;window&#39;s&nbsp;process&nbsp;ID&nbsp;does&nbsp;not&nbsp;match&nbsp;our&nbsp;game&#39;s&nbsp;process&nbsp;ID,<br />	return&nbsp;TRUE&nbsp;to&nbsp;keep&nbsp;searching.<br />	*/<br />	DWORD&nbsp;window_pid&nbsp;=&nbsp;0;<br />	GetWindowThreadProcessId(hWnd,&nbsp;&amp;window_pid);<br />	if&nbsp;(window_pid&nbsp;!=&nbsp;game_pid)<br />		return&nbsp;TRUE;<br />	<br />	/*<br />	Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;grab&nbsp;a&nbsp;handle&nbsp;to&nbsp;our&nbsp;AllocConsole&nbsp;window.<br />	Keep&nbsp;searching&nbsp;if&nbsp;we&nbsp;do.<br />	*/<br />	if&nbsp;(hWnd&nbsp;==&nbsp;GetConsoleWindow())<br />	{<br />		printf(&quot;[*]&nbsp;Skipping&nbsp;console&nbsp;window&nbsp;\n&quot;);<br />		return&nbsp;TRUE;<br />	}<br /><br />	//&nbsp;Done!&nbsp;Return&nbsp;FALSE&nbsp;to&nbsp;stop&nbsp;searching<br />	printf(&quot;[*]&nbsp;Grabbed&nbsp;handle&nbsp;to&nbsp;game&#39;s&nbsp;window&nbsp;(game_pid:&nbsp;%d&nbsp;|&nbsp;window_pid:&nbsp;%d)&nbsp;\n&quot;,&nbsp;game_pid,&nbsp;window_pid);<br />	h_gamewindow&nbsp;=&nbsp;hWnd;<br />	return&nbsp;FALSE;<br />}<br /><br />/*<br />Grabs&nbsp;a&nbsp;handle&nbsp;to&nbsp;the&nbsp;game&#39;s&nbsp;window&nbsp;and&nbsp;then&nbsp;queries&nbsp;for&nbsp;its&nbsp;height&nbsp;and&nbsp;width.<br />Window&nbsp;size&nbsp;is&nbsp;slightly&nbsp;larger&nbsp;than&nbsp;game&#39;s&nbsp;resolution,&nbsp;so&nbsp;subtract&nbsp;6&nbsp;&amp;&nbsp;29&nbsp;to&nbsp;adjust.<br />*/<br />void&nbsp;GetWindowSize()<br /><span style="color:#000000;font-weight:400">{</span><br />	EnumWindows(EnumWindowsProc,&nbsp;0);<br />	RECT&nbsp;window_size&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />	GetWindowRect(h_gamewindow,&nbsp;&amp;window_size);<br />	gamewindow_width&nbsp;=&nbsp;(window_size.right&nbsp;-&nbsp;window_size.left)&nbsp;-&nbsp;6;<br />	gamewindow_height&nbsp;=&nbsp;(window_size.bottom&nbsp;-&nbsp;window_size.top)&nbsp;-&nbsp;29;<br /><br />	printf(&quot;[*]&nbsp;Game&nbsp;window&nbsp;size:&nbsp;%d&nbsp;*&nbsp;%d&nbsp;\n&quot;,&nbsp;gamewindow_width,&nbsp;gamewindow_height);<br /><br />	return;<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
