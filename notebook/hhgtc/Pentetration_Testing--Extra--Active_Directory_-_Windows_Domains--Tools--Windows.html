<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Windows</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Windows Tools</h1></strong><br />Tools to attack Active Directory from Windows.<br /><br /><strong><h2>## PowerView</h2></strong><br /><a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</a><br /><br />You have to be part of the domain to perform domain reconnaissance.<br /><br />&quot;PowerView is a PowerShell tool to gain network situational awareness onWindows domains.<br />Utilizes PowerShell AD hooks and underlying Win32 API function to perform useful Windows domain functionality.&quot;<br /><br />• More powerful than internal tools for pentesters<br />• PowerView might get blocked when you load the script<br />   ◇ This is the <code>Antimalware Scan Interface</code> - <code>AMSI</code> - blocking the script after it&#39;s loaded<br />   ◇ so you have to bypass AMSI<br /><br /><strong><h3>### Loading</h3></strong><br />Load modules/the commands/the script into memory<br /><code>Import-Module .\PowerView.ps1</code><br /><br />Now you can run commands<br /><br /><strong><h2>## ActiveDirectory PowerShell Module </h2></strong><br />ActiveDirectory is a Microsoft signed PowerShell module that consolidates a bunch of cmdlets:<br /><a href="https://docs.microsoft.com/en-us/powershell/module/addsadministration/?view=win10-ps">https://docs.microsoft.com/en-us/powershell/module/addsadministration/?view=win10-ps</a><br /><br />• Very good for basic enumeration<br />• Works well in a constrained language mode (because it&#39;s official)<br />• Low detection (because microsoft signed)<br /><br /><strong><h3>### Install</h3></strong><br /><strong>On domain controller?</strong><br />• Should be installed by default on Windows Server 2012 domain controllers and above as part of RSAT (Remote Server Administration Tools)<br /><br /><strong>On client computer?</strong><br />Won&#39;t be installed, will have to download DLL -&gt; import DLL -&gt; import ActiveDirectory module<br />Can be done without Admin privileges and without installing RSAT.<br /><br />Download module from here (also has install instructions)<br /><a href="https://github.com/samratashok/ADModule">https://github.com/samratashok/ADModule</a><br /><br /><code>Import-Module Microsoft.ActiveDirectory.Management.dll -Verbose</code><br /></div>
</body>
</html>
