<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Find/read binary info</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># How-to - Find/read binary info</h1></strong><br /><code>rabin2</code> is part of <code>radare2</code> - you should have rabin2 if you have radare2 installed.<br /><code>rabin</code>, I&#39;m guessing, just uses readelf except that it formats the output in a much more readable fashion. It&#39;s nicer to use.<br /><br /><strong><h3>Header/Binary Information</h3></strong><br /><code>rabin2 -I &lt;binary&gt;<br />readelf -h &lt;binary&gt;<br />file &lt;binary&gt;</code><br /><br /><strong><h3>Check Protections</h3></strong><br />Open binary with gdb-peda and run checksec - <code>gdb-peda -q &lt;binary&gt;</code> &gt; <code>checksec</code><br /><code>rabin2 -I &lt;binary&gt;</code> - not as readable imo<br /><br /><strong><h3>Imports</h3></strong><br />You can check what functions are imported to the binary and their address<br /><code>rabin2 -i write4</code><br /><br /><strong><h3>User-defined Functions</h3></strong><br />This is more tricky to do.<br /><code>rabin2 -qs &lt;binary&gt; | grep -ve imp -e &#39; 0 &#39;</code> - gives a nice output/potentially not everything<br /><br /><code>readelf -s &lt;binary&gt;</code> - list all the symbols in the binary, which will list all functions<br /><br /><code>nm &lt;binary&gt;</code> - another way to list all symbols in binary. look for <code>t</code> and <code>T</code> - they&#39;re usually interesting/useful/not linked junk<br />    <code>nm &lt;binary&gt; | grep &#39; T &#39;</code><br />    <code>nm &lt;binary&gt; | grep &#39; t &#39;</code> - t or T denotes that the function is in the <code>.code</code> section<br /><br /><strong><h3>Sections</h3></strong><br />The binary&#39;s sections that it will create in memory.<br />Check these if you want to find the read/write/execute permissions of parts of memory.<br /><br /><code>rabin2 -S &lt;binary&gt;</code><br /><code>readelf -S &lt;binary&gt;</code><br /><br /><strong><h3>Relocations</h3></strong><br /><code>rabin2 -R write4</code><br /><code>readelf -r write4</code><br /><br /><strong><h3>Strings</h3></strong><br /><code>strings &lt;binary&gt;</code> - will produce a lot of garbage<br /><code>rabin2 -z &lt;binary&gt;</code> - will list strings the programmer purposefully placed in the binary<br /><br /><strong><h3>Trace library calls</h3></strong><br /><code>ltrace</code> will trace library calls. <br />Can be used to find how many bytes you have available to create your ROP chain<br /><br /><code>ltrace &lt;binary&gt;</code><br /><br /><strong><h3>Gadgets</h3></strong><br /><code>ropper --file &lt;binary&gt;</code> - <a href="https://github.com/sashs/Ropper">https://github.com/sashs/Ropper</a><br /><code>ropper --binary &lt;binary&gt; --only “mov|pop|ret”</code> - <a href="https://github.com/JonathanSalwan/ROPgadget">https://github.com/JonathanSalwan/ROPgadget</a><br /><br />Open binary with gdb-peda &gt; break main &gt; run &gt; <code>ropsearch “pop ?”</code> or <code>ropsearch “mov ?, ?”</code> or <code>ropgadget</code><br /><code>mov [%]</code> for memory addresses<br /><br /><strong><h3>Disassemble binary</h3></strong><br /><code>objdump -M intel -d &lt;binary&gt;</code><br /><code>-M</code> intel specifies IA-32 syntax (no ugly at&amp;t syntax pls)</div>
</body>
</html>
