<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Packer</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Packers</h1></strong><br />The defining characteristic of a packer is compression.<br />Packers were originally created to compress the file size of a binary so that it can be transferred easily between systems and run.<br />This is in the days where network speeds were slow and data rates were high.<br />Packers compress the desired file and then stored within a new binary: perhaps as a PE section, or a resource, in a code cave, whatever.<br />Then, when the binary is run, the binary will find the compressed executable stored within itself, decompress it, and transfer execution over to the decompressed binary.<br /><br />• <a href="https://0x00sec.org/t/packers-executable-compression-and-data-obfuscation/847/1">https://0x00sec.org/t/packers-executable-compression-and-data-obfuscation/847/1</a><br />• <a href="https://medium.com/ax1al/packing-and-obfuscation-fe6b03bbc267">https://medium.com/ax1al/packing-and-obfuscation-fe6b03bbc267</a><br />• <a href="https://www.pouet.net/topic.php?which=8337">https://www.pouet.net/topic.php?which=8337</a> - Old links/discussion<br />• <a href="http://docsresearch.com/research/Files/Progs/Malware/Carberp/Source/CabPacker.cpp">http://docsresearch.com/research/Files/Progs/Malware/Carberp/Source/CabPacker.cpp</a> - Carberp source code<br />• <a href="https://kaimi.io/en/2012/09/developing-pe-file-packer-step-by-step-step-10-overall-architecture/">https://kaimi.io/en/2012/09/developing-pe-file-packer-step-by-step-step-10-overall-architecture/</a> - Tutorial for sophisticated packer<br />• <a href="https://asus1004.tistory.com/m/113?category=96064">https://asus1004.tistory.com/m/113?category=96064</a> - Yoda Protector (old classic)<br />• <a href="https://webserver2.tecgraf.puc-rio.br/~ismael/Cursos/YC++/apostilas/win32_xcoff_pe/tyne-example/Tiny%20PE.htm">https://webserver2.tecgraf.puc-rio.br/~ismael/Cursos/YC++/apostilas/win32_xcoff_pe/tyne-example/Tiny%20PE.htm</a> - Tiny PE, a challenge to create the smallest PE file which will download a file and execute it<br />• <a href="https://cultdeadcow.bnbn.it/tools/pewrap.html">https://cultdeadcow.bnbn.it/tools/pewrap.html</a> - PE Crunch written by <em>Cult of the Dead Cow</em><br /><br /><strong><h2>## Examples</h2></strong><br /><strong><h3>### UPX</h3></strong><br />UPX - the Ultimate Packer for eXecutables.<br /><a href="https://upx.github.io/">https://upx.github.io/</a><br /><br />UPX compresses the binary with UCL compression.<br />It uses UCL because it can decompress in place (doesn&#39;t have to allocate extra memory for decompression)<br /><br />UPX has:<br />• a <code>.UPX0</code> section in the PE file - which will contain decompressed/unpacked executable (it has 0 raw size, and a large virtual size)<br />• The compressed executable<br />• A decompression stub<br /><br />The decompression stub:<br />• Extracts the packed file<br />• Fixes its imports<br />• Marks the memory as executable<br />• And jumps to its entry point<br /><br /></div>
</body>
</html>
