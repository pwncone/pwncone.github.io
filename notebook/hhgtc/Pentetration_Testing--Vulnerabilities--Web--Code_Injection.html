<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Code Injection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Code Injection</h1></strong><br />When a website accepts user input, you might be able to inject code.<br /><em>Code Injection</em> is an umbrella term which covers OS Command Injection, SQL Injection, etc.<br />The information here doesn&#39;t provide direct instruction on how to exploit code injection, but is more about technqiues and knowledge for identifying code injection whilst your assessing a site. For example, checking URL parameters for code injection vulnerabilities is useful for finding both OS Command Injectiona and SQL Injection.<br /><br /><strong><h2>## Finding Code Injection</h2></strong><br />Look for any place in the website takes/reads user input.<br />• Web URLs<br />   ◇ <code>http://example.com/?name=hacker</code><br />• Headers<br />   ◇ Cookies<br />   ◇ X-Forwarded-For<br />   ◇ User-agent<br />   ◇ Referrer<br />   ◇ other<br />• Can also check the source code<br />   ◇ Look for anywhere that&#39;s taking user supplied input via a parameter<br />      ▪ and check if there&#39;s input validation<br />      ▪ and then check what it&#39;s doing with that user input<br />         - there might be code injection possibilties<br /><br /><strong><h2>## Language Recon</h2></strong><br />After you&#39;ve found potential code injection, you should try to identify the langauge that&#39;s parsing your injected code.<br />Code injection should be done in the same language used by the application.<strong><br /></strong><br />• Inject code that will generate an error (which might reveal the language)<br />   ◇ <code>&#39;</code><br />   ◇ <code>&#39;&#39;</code><br />   ◇ <code>&quot;</code><br />   ◇ <code>&quot;&quot;</code><br />• Check response headers of web page<br />• Look at the way special characters are handle by the application (for example by comparing <code>+</code> and <code>.</code> for concatenation of strings - this could reveal the language)<br /><br /><strong><h2>## Inject code<br /></h2></strong>Now that you&#39;ve identified a place for code injection and know the language, try to inject code.<br />This might be:<br />• Command injection / code execution <br />• SQL injection<br />• etc.<br /><br /><strong><h3>### Terminating existing code</h3></strong><br />When you&#39;re injecting code, you will most likely have to terminate out the existing coder afte the inject (with a comment, or <code>&quot;</code>, or similar).<br />Therefore, your inject will most look something like this:<br /><br /><code>&lt;parameter to cause code inject&gt;&lt;code inject&gt;&lt;terminate remaining code&gt;</code><br />PHP example - <code>&quot;;system(&#39;whoami&#39;);//</code><br />• <code>&quot;</code> - cause code injection<br />• <code>;system(&#39;whoami&#39;);</code> - injected PHP code<br />• <code>//</code> - comment out remaining PHP code so that just our inject runs<br /><br /><strong>Techniques</strong><br />How you terminate existing code will depend on the language.<br />Potential methods include:<br />• Use a variable (shoves the remaining code into a variable):<br />   ◇ <code>&quot;.system(&#39;uname -a&#39;); $dummy=&quot;</code>.<br />• Insert a comment<br />   ◇ <code>&quot;.system(&#39;uname -a&#39;);#</code> or <code>&quot;.system(&#39;uname -a&#39;);//</code><br /><br /></div>
</body>
</html>
