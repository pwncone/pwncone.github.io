<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>25,464,587 - SMTP/s</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 25,464,587 - SMTP/s</h1></strong><br />SMTP stands for Simple Mail Transfer Protocol.<br />SMTP transfers email between mail servers.<br />The SMTP server will hold a database of all email addresses that can send or receive mail.<br /><br />• <code>25</code> = Unencrypted SMTP<br />• <code>465, 587</code> = Encrypted SMTP (ssl)<br /><br /><strong><h2>## Checklist</h2></strong><br />• Get victim to send you an email to grab info from headers<br />• Connect &amp; grab banner/version<br />   ◇ <code>nc 10.11.0.4 25 -v</code><br />   ◇ <code>openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587</code><br />• Search for exploits<br />• Nmap scripts<br />   ◇ <code>nmap -p 25,465,587 --script smtp-* 10.11.0.4</code><br />• Find users<br />   ◇ Scripts<br />      ▪ smtp-user-enum<br />      ▪ metasploit auxiliary/scanner/smtp/smtp_enum<br />      ▪ patator<br />   ◇ Manually<br />      ▪ <code>VRFY &lt;username&gt;<br /></code>      ▪ <code>EXPN &lt;username&gt;</code><br />• Brute-force authentication<br /><br /><strong><h2>## Email Headers</h2></strong><br />If you can get the victim to send you an email (contact form, social engineering, etc.) - do it!<br />In the email headers, you might find info on:<br />   ◇ the internal network<br />   ◇ anti-virus being used<br /><br /><strong><h2>## Banner Grabbing</h2></strong><br />For non-encrypted SMTP<br /><code>nc 10.11.0.4 25 -v</code><br /><br />For encrypted SMTP<br /><code>openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587</code><br /><br /><strong><h2>## Find mail servers linked to a domain name</h2></strong><br /><code>dig +short mx google.com</code><br /><br /><strong><h2>## Find Users</h2></strong><br />Wordlists:<br />• <code>/usr/share/wordlists/metasploit/unix_users.txt</code><br />• <code>/usr/share/seclists/Usernames/Names/names.txt</code><br /><br /><strong><h3>### smtp-user-enum</h3></strong><br />• <a href="https://github.com/pentestmonkey/smtp-user-enum/blob/master/smtp-user-enum.pl">https://github.com/pentestmonkey/smtp-user-enum/blob/master/smtp-user-enum.pl</a><br />smtp-user-enum is a perl script by pentestmonkey.<br /><br />For a user list you can use: <em>/usr/share/wordlists/metasploit/unix_users.txt</em><br /><code>smtp-user-enum.pl -M VRFY -U /usr/share/wordlists/metasploit/unix_users.txt -t 10.0.0.1</code><br /><br /><strong><h3>### Metasploit</h3></strong><br /><code>use auxiliary/scanner/smtp/smtp_enum</code><br /><br /><strong><h3>### Patator</h3></strong><br />Haven&#39;t tried yet.<br /><code>smtp_vrfy</code><br /><code>smtp_rcpt</code><br /><br /><strong><h2>## Send email from Linux console</h2></strong><br />Send emails easily with sendEmail.<br /><br /><code>-s</code> SMTP server<br /><code>-t</code> target email<br /><code>-f</code> from email<br /><code>-xu</code> SMTP username<br /><code>-xp</code> SMTP password<br /><code>-u</code> subject<br /><code>-a</code> attachment<br /><code>-m</code> &quot;message&quot;<br /><br /><div class="codebox"><div class="codebox">┌─[root@parrot]─[/oscp/10.11.1.7/pdf]<br />└──╼&nbsp;#sendEmail&nbsp;-t&nbsp;pedro@thinc.local&nbsp;-f&nbsp;jeff@thinc.local&nbsp;-xu&nbsp;jeff@thinc.local&nbsp;-xp&nbsp;woof&nbsp;-u&nbsp;&quot;report&quot;&nbsp;-a&nbsp;report.pdf&nbsp;-m&nbsp;&quot;Hey&nbsp;Pedro,&nbsp;here&#39;s&nbsp;your&nbsp;report&quot;&nbsp;-s&nbsp;10.11.1.229<br />Feb&nbsp;12&nbsp;11:17:22&nbsp;parrot&nbsp;sendEmail[3673]:&nbsp;Email&nbsp;was&nbsp;sent&nbsp;successfully!</div></div><br /><br /><br /></div>
</body>
</html>
