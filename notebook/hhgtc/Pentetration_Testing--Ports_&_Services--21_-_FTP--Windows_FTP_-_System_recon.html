<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Windows FTP - System recon</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Windows FTP - Perform system recon</h1></strong><br />If you&#39;re on a Windows FTP server you can sometimes perform system reconnaissance and gather some useful information.<br /><br /><strong><h2>## What is the root of the FTP directory?</h2></strong><br />Try to download a file that doesn&#39;t exist. The command should error out and tell you a file path.<br /><code>tftp&gt; get no_exist.txt<br />Error code 1: Could not find file &#39;C:\no_exist.txt&#39;.</code><br /><br /><strong><h2>## Get username</h2></strong><br />You can try leaking the username in an error message by downloading a file named %USERNAME% - which is a Windows variable which stores the current username. This doens&#39;t always work.<br /><code>tftp &gt; get /%USERNAME%<br />Error code 1: Could not find file &#39;C:\jerry&#39;.</code><br /><br /><strong><h2>## Are you running as SYSTEM?</h2></strong><br />Check if you/the FTP client is running as SYSTEM by reading a restricted file, like the SAM database.<br />No &quot;Access Denied&quot;? You&#39;re probably system.<br /><code>tftp&gt; get \windows\system32\config\sam<br />Error code 1: The process cannot access the file &#39;C:\windows\system32\config\sam&#39; because it is being used by another process.</code><br /><br /><strong><h2>## Get OS Version</h2></strong><br /><a href="https://security.stackexchange.com/questions/110673/how-to-find-windows-version-from-the-file-on-a-remote-system">https://security.stackexchange.com/questions/110673/how-to-find-windows-version-from-the-file-on-a-remote-system</a><br />You can find the OS version and service pack by reading <code>license.rtf</code> or <code>eula.txt</code><br /><br />Windows XP - <code>C:\Windows\System32\eula.txt</code><br />Windows 7 - <code>C:\Windows\System32\license.rtf</code><br />Windows 10 - <code>C:\Windows\System32\license.rtf</code> - search the EULA code online to find Win10 version<br /><br /><strong><h2>## 32bit or 64bit?</h2></strong><br />The easiest way to do this (if not in eula.txt) is to check Program Files for an (x86) version<br /><br />(I&#39;m using short filenames here, do it however)<br /><code>get Progra~1</code><br /><code>get Progra~2</code><br /><br /><strong><h2>## Get Language Pack</h2></strong><br />The currently available languages will have their language pack stored in <code>C:\Windows\System32</code><br /><code>en-US</code> = English-United States<br /><code>es-MX</code> = Spanish-Mexico<br />etc.<br /><br />Could try checking Documents/Photos/Music to find different languages also.<br /><br /><strong><h2>## Read files with spaces</h2></strong><br />This can be a pain. Here&#39;s some things to try:<br />• <code>get /&quot;Documents and Settings&quot;</code><br />• <code>get &quot;/Documents and Settings&quot;</code><br />• <code>get Documents_and_Settings</code> - should work<br />• <code>get &quot;/Documents_and_Settings&quot;</code> - should work<br />• Short file names - <code>get DOCUME~1</code><br />   ◇ In Windows 10, Microsoft got rid of short file names<br />   ◇ Short file names was a naming convention used in DOS<br />   ◇ Old filesystems (e.g. fat32, fat16) didn&#39;t support long filenames - so they creaed short filenames<br />   ◇ Format<br />      ▪ 6 characters + <code>~</code> + number<br />      ▪ <code>DOCUME~1</code> - this would list the 1st file starting with <code>DOCUME</code><br />      ▪ <code>DOCUME~2</code> - this would list the 2nd file starting with <code>DOCUME</code><br />      ▪ etc.<br />   ◇ Can use short filenames to read files with spaces<br />   ◇ <code>get DOCUME~1</code></div>
</body>
</html>
