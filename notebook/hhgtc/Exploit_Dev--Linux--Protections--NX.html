<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>NX</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Exploit Protections - NX/DEP</h1></strong><br />• <a href="https://en.wikipedia.org/wiki/NX_bit">https://en.wikipedia.org/wiki/NX_bit</a><br />• <a href="https://ocw.cs.pub.ro/courses/cns/labs/lab-08">https://ocw.cs.pub.ro/courses/cns/labs/lab-08</a> (<em>Code Integrity Protection</em> section)<br /><br /><code>NX</code> = Non-Executable<br /><code>DEP</code> = Data Execution Prevention (The Windows version of NX)<br /><br />The NX bit is a technology found in CPUs that can define areas of memory as non-exectuable e.g. the stack.<br />This makes the stack read-only, meaning you can&#39;t just drop shellcode onto the stack and execute it.<br /><br /><strong>W^X</strong><br />W^X memory, or “Write XOR Execute” memory, is a protection that makes use of the NX bit.<br />It defines areas of memory as either writable or executable, never both.<br /><br /><strong>DEP</strong><br />DEP, Data Execution Prevention, is NX on Windows. <br />Why different names? Because Microsoft.<br /><a href="https://blogs.msdn.microsoft.com/ieinternals/2009/10/10/understanding-depnx/">https://blogs.msdn.microsoft.com/ieinternals/2009/10/10/understanding-depnx/</a><br /><br /><strong><h3>### gcc switches</h3></strong><br />• <code>-z noexecstack</code> - make stack non-executable<br />• <code>-z execstack</code> - make stack executable<br /><br /><strong><h2>## Bypassing NX</h2></strong><br />The principle behind bypassing NX is that becuase you can&#39;t execute your own code, instead you re-use code.<br /><br />• ret2libc<br />   ◇ You return to <code>libc</code>, the C standard library, and re-use a whatever functions you like from that library<br />   ◇ <em>Scenario</em>: spawning a shell with system()<br />   ◇ You overwrite EIP and direct execution flow to the <code>system()</code> function in the <code>libc</code> library, a function which can execute system commands, and pass it the <code>/bin/sh</code> parameter. This will spawn a shell.<br />• ROP<br />   ◇ <em>Return Oriented Programming</em><br />   ◇ The attacker uses small pieces of program code, called “gadgets” (e.g. <code>pop rdi</code>) to execute arbitrary instructions</div>
</body>
</html>
