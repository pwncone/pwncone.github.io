<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>web2py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># web2py</h1></strong><br /><a href="http://www.web2py.com/">http://www.web2py.com/</a><br /><br />According to their website, web2py is<br />&quot;A full-stack framework for rapid development of fast, scalable, secure and portable database-driven web-based applications&quot;<br /><br /><strong><h2>## URLs</h2></strong><br /><a href="https://site.com/welcome/default/user">https://site.com/welcome/default/user</a><br /><a href="https://10.11.1.44:8000/user/login">https://10.11.1.44:8000/user/login</a> - User login page<br /><a href="https://10.11.1.44:8000/admin">https://10.11.1.44:8000/admin</a> - Admin login page (don&#39;t bruteforce this - get locked out after ~10 attempts)<br /><a href="https://amce.local:8000/projects?keywords=project.name+starts+with+%22A%22">https://amce.local:8000/projects?keywords=project.name+starts+with+%22A%22</a> - Can try fuzzing for projects (i.e. use patator and go through the alphabet)<br /><br /><strong><h2>## Exploits</h2></strong><br />• <a href="https://www.exploit-db.com/exploits/39821">https://www.exploit-db.com/exploits/39821</a><br /><br /><strong><h3>### CVE-2016-4806 - Web2py 2.14.5 - LFI Vulnerability</h3></strong><br /><a href="https://www.exploit-db.com/exploits/39821">https://www.exploit-db.com/exploits/39821</a><br />This LFI vulnerability requires you to be logged in here - <a href="https://10.11.1.44:8000/admin">https://10.11.1.44:8000/admin</a><br />The URL <code>/admin/default/pack_custom/[applicationmame]</code> is vulnerable to LFI by submitting <code>file=&lt;file&gt;</code> in the body data.<br /><br /><strong>Examples</strong><br />• oscp 10.11.1.44 - Tricia<br /><br />Try grabbing <code>/etc/passwd</code> and <code>/etc/shadow</code><br /><a href=""><img src="images/262-1.png" alt="images/262-1.png" /></a><br /><br /><code>Right click</code> &gt; <code>Show response in browser</code> to download the file.<br /><br />Unpack the files with this - <a href="https://github.com/pigeonflight/web2py-unpacker">https://github.com/pigeonflight/web2py-unpacker</a><br /><code>python web2py-unpacker/unpackw2p.py web2py.app.admin.w2p</code><br /><br />• Don&#39;t rename the <code>web2py.app.admin.w2p</code> files you download, the unpacker doesn&#39;t like it.<br />• Delete the existing <code>web2py.app.admin.w2p</code> and the <code>unpacked</code> directory if you&#39;re downloading more files, otherwise <code>unpackw2p.py</code> will throw errors.</div>
</body>
</html>
