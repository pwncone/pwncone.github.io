<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Directory Discovery</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Directory Discovery</h1></strong><br />Scanning/bruteforcing for directories usually yields pretty useful results.<br /><br /><strong><h2>## Wordlists</h2></strong><br /><a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a><br /><br /><code>/usr/share/seclists/Discovery/Web-Content/common.txt</code><br /><code>/usr/share/seclists/Discovery/Web-Content/big.txt</code><br /><br /><code>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code><br />• Similar to seclists&#39;s big.txt, but slightly bigger and a few different entries<br />• Used to be the classic go-to wordlist, so if you&#39;re playing CTF this wordlist might find results that big.txt won&#39;t<br /><br /><code>/usr/share/seclists/Discovery/Web-Content/Common-PHP-Filenames.txt</code><br /><code>/usr/share/seclists/Discovery/Web-Content/Top1000-RobotsDisallowed.txt</code><br /><br />Also remember to browse for wordlists directly related to the service you&#39;re attacking <br />e.g. wordpress, drupal, etc.<br /><br /><strong><h2>## Tips</h2></strong><br />If you&#39;ve found a file or file extension, check for old versions of that file or backups.<br /><code>file.ext~, #file.ext#, ~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old</code><br /><br /><strong><h2>## gobuster</h2></strong><br /><a href="https://github.com/OJ/gobuster">https://github.com/OJ/gobuster</a><br /><br /><strong><h3>### Notes</h3></strong><br />• <strong><code>gobuster</code></strong> <strong>will ignore pages that respond with </strong><em><strong>&#39;401 Unauthorized’</strong></em><strong> errors by default</strong><br />   ◇ Make sure to include <em>401</em> results using <code>-s</code><br />   ◇ Alternatively, you can just run <code>dirb</code> which includes 401 results by default.<br />• Gobuster doesn&#39;t scan recursively<br />   ◇ so if you scan <a href="http://10.10.10.15">http://10.10.10.15</a> and find <a href="http://10.10.10.15/uploads">http://10.10.10.15/uploads</a><br />   ◇ you can then try gobuster <a href="http://10.10.10.15/uploads/">http://10.10.10.15/uploads/</a> and see if gobuster finds anything<br />   ◇ If you want to scan recursively automatically, use <code>dirb</code><br />• You can also use gobuster to search for file extensions e.g. <code>-x .php,.aspx</code><br /><br /><strong><h3>### Usage</h3></strong><br /><code>dir</code> - scan for directories<br /><code>dns</code> - scan for subdomains<br /><code>vhosts</code> - virtual host brute-forcing mode (not the same as DNS!)<br /><br /><code>-e</code> - print full URLs<br /><code>-o &lt;file&gt;</code> - specify a filename to write the output to<br /><code>-s 200</code> - to get results only with status code 200<br /><code>-k </code> - skip ssl certificate verification<br /><code>-a</code> - specify user agent (otherwise it&#39;ll just be ‘gobuster’)<br /><code>-x .php,.aspx</code> - specify file extensions to search for <br /><br /><code>gobuster dir -e -u </code><a href="http://10.10.10.15">http://10.10.10.15</a><code> -w /usr/share/seclists/Discovery/Web-Content/big.txt -s 200,204,301,302,307,401,403 -o gb-big.txt</code><br /><br />Good list of extensions to brute-force for (not complete) :<br /><code>.txt, .html, .php, .bak, .bin, .py, .pl, .sh</code><br /><br />Windows-only extensions:<br /><code>.asp, .aspx</code><br /><br /><strong><h2>## dirb</h2></strong><br /><code>dirb</code> scans recursively, which makes it different to gobuster, but in my opinion is slow. <br />It&#39;s probably a good idea to use a smaller wordlist with dirb considering it scans recursively.<br /><br /><code>dirb https://10.11.1.44:8000 /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code><br /><br /></div>
</body>
</html>
