<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Forward declaration of structs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Forward declaration of structs</h1></strong><br />Forward declarations for structs work as along as they&#39;re pointers to structs.<br />This is because a pointer is a known size (4 or 8 bytes)<br />whereas if it&#39;s just a struct and not a pointer the compiler won&#39;t know how much space to allocate<br />for the struct because it hasn&#39;t seen the definition, only the declaration.<br /><br />Answers:<br />â€¢ <a href="https://stackoverflow.com/questions/9999512/forward-declaration-of-a-struct-in-c/29477576">https://stackoverflow.com/questions/9999512/forward-declaration-of-a-struct-in-c/29477576</a><br /><br />For example,<br />this is valid because foo contains a pointer to the bar struct.<br />A pointer is a known size.<br /><div class="codebox"><div class="codebox">struct&nbsp;_foo;<br />struct&nbsp;_bar;<br /><br />struct&nbsp;_foo<br />{<br />	int&nbsp;count;<br />	struct&nbsp;_bar*&nbsp;bar;			//&nbsp;Valid<br />	//struct&nbsp;_bar&nbsp;bar;			//&nbsp;Will&nbsp;fail&nbsp;because&nbsp;compiler&nbsp;doesn&#39;t&nbsp;know&nbsp;struct&nbsp;_bar&#39;s&nbsp;size<br />};<br /><br />struct&nbsp;_bar<br />{<br />	int&nbsp;time;<br />};</div></div><br /><br />If you&#39;re not using pointers, I don&#39;t know of a solution.<br />You&#39;re just gonna have to order the structs so that they can see definition it needs.<br />e.g.<br /><div class="codebox"><div class="codebox">struct&nbsp;_bar<br />{<br />	int&nbsp;time;<br />};<br /><br />struct&nbsp;_foo<br />{<br />	int&nbsp;count;<br />	struct&nbsp;_bar&nbsp;bar;<br />};</div></div> ese <br /><br /><strong><h2>## Random junk that works</h2></strong><br />All of these are using pointers.<br /><br /><div class="codebox"><div class="codebox">//&nbsp;Forward&nbsp;declaration&nbsp;of&nbsp;structs<br />typedef&nbsp;struct&nbsp;_ENTITY&nbsp;Entity;<br />typedef&nbsp;struct&nbsp;_CURRENTWEAPON&nbsp;CurrentWeapon;<br />typedef&nbsp;struct&nbsp;_WEAPONCHARACTERISTICS&nbsp;WeaponCharacteristics;<br /><br />typedef&nbsp;struct&nbsp;_ENTITY<br />{<br />	uintptr_t&nbsp;v_table;<br />	vector3&nbsp;head_pos;<br />	CurrentWeapon*&nbsp;current_weapon;<br />}&nbsp;Entity;<br /><br />typedef&nbsp;struct&nbsp;_CURRENTWEAPON<br />{<br />	char&nbsp;pad_0000[4];<br />	int32_t&nbsp;weapon_id;<br />	Entity*&nbsp;weapon_owner;<br />	WeaponCharacteristics*&nbsp;characteristics;<br />}&nbsp;CurrentWeapon;<br /><br />typedef&nbsp;struct&nbsp;_WEAPONCHARACTERISTICS<br />{<br />	char&nbsp;pad_0000[260];<br />	int16_t&nbsp;sound;<br />	int16_t&nbsp;reload;<br />	int16_t&nbsp;reload_time;<br />}&nbsp;WeaponCharacteristics;</div></div><br /><br /><strong><h3>### v2</h3></strong><br />This alternatively works.<br />Looks better?<br /><div class="codebox"><div class="codebox">//&nbsp;Forward&nbsp;declaration&nbsp;of&nbsp;structs<br />struct&nbsp;_ENTITY;<br />struct&nbsp;_CURRENTWEAPON;<br />struct&nbsp;_WEAPONCHARACTERISTICS;<br /><br />typedef&nbsp;struct&nbsp;_ENTITY<br />{<br />	struct&nbsp;_CURRENTWEAPON*&nbsp;current_weapon;&nbsp;//0x0374<br />	char&nbsp;pad_0378[282];		//0x0378<br />}&nbsp;Entity;<br /><br />typedef&nbsp;struct&nbsp;_CURRENTWEAPON<br />{<br />	struct&nbsp;_ENTITY*&nbsp;weapon_owner;			//0x0008<br />	struct&nbsp;_WEAPONCHARACTERISTICS*&nbsp;characteristics;		//0x000C<br />}&nbsp;CurrentWeapon;<br /><br />typedef&nbsp;struct&nbsp;_WEAPONCHARACTERISTICS<br />{<br />	char&nbsp;pad_0000[260];			//0x0000<br />	int16_t&nbsp;sound;				//0x0104<br />	int16_t&nbsp;reload;				//0x0106<br />	int16_t&nbsp;reload_time;		//0x0108<br />}&nbsp;WeaponCharacteristics;</div></div><br /><br /><strong><h3>### Or without the typedefs? I don&#39;t know man :/</h3></strong><br /><div class="codebox"><div class="codebox">//&nbsp;Forward&nbsp;declaration&nbsp;of&nbsp;structs<br />struct&nbsp;Entity;<br />struct&nbsp;CurrentWeapon;<br />struct&nbsp;WeaponCharacteristics;<br /><br />struct&nbsp;Entity<br />{<br />	struct&nbsp;CurrentWeapon*&nbsp;current_weapon;&nbsp;//0x0374<br />};<br /><br />struct&nbsp;CurrentWeapon<br />{<br />	struct&nbsp;Entity*&nbsp;weapon_owner;			//0x0008<br />	struct&nbsp;WeaponCharacteristics*&nbsp;characteristics;		//0x000C<br />};<br /><br />struct&nbsp;WeaponCharacteristics<br />{<br />	char&nbsp;pad_0000[260];			//0x0000<br />	int16_t&nbsp;sound;				//0x0104<br />	int16_t&nbsp;reload;				//0x0106<br />	int16_t&nbsp;reload_time;		//0x0108<br />};</div></div></div>
</body>
</html>
