<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Cyclic Patterns</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Cyclic Patterns</h1></strong><br />How to generate a cyclic pattern so that you find that glorius EIP offset.<br /><br /><strong><h2>## pattern_create</h2></strong><br />• pattern_create doens&#39;t use special characters, so won&#39;t cause conflict in the linux command line<br />• pattern_create location on Kali:<br />   ◇ <code>/usr/share/metasploit-framework/tools/pattern_create.rb</code><br /><br /><code>msf-pattern_create -l &lt;length&gt;</code> - to create a cyclic pattern<br /><code>msf-pattern_offset -q &lt;string&gt;</code> - to check offset of value in pattern<br /><br /><strong><h2>## gdb-peda</h2></strong><br /><code>gdb-peda# pattern create 200</code> - to create cyclic pattern<br /><code>gdb-peda# pattern offset A3A0</code> - to check offset in cyclic pattern<br />    <code>gdb-peda$ pattern offset 0x41344141</code><br />    <br /><strong><h3>### pattern-search</h3></strong><br />You can also use <code>pattern search</code> to search through memory for sections of gdb-peda&#39;s generated pattern.<br /><div class="codebox"><div class="codebox">gdb-peda$&nbsp;pattern&nbsp;search<br />Registers&nbsp;contain&nbsp;pattern&nbsp;buffer:<br />EBP+0&nbsp;found&nbsp;at&nbsp;offset:&nbsp;72<br />EIP+0&nbsp;found&nbsp;at&nbsp;offset:&nbsp;76<br />Registers&nbsp;point&nbsp;to&nbsp;pattern&nbsp;buffer:<br />[EAX]&nbsp;--&gt;&nbsp;offset&nbsp;0&nbsp;-&nbsp;size&nbsp;~100<br />[ESP]&nbsp;--&gt;&nbsp;offset&nbsp;80&nbsp;-&nbsp;size&nbsp;~20<br />Pattern&nbsp;buffer&nbsp;found&nbsp;at:<br />0x0804a160&nbsp;:&nbsp;offset&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;-&nbsp;size&nbsp;&nbsp;100&nbsp;([heap])<br />0xffffd140&nbsp;:&nbsp;offset&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;-&nbsp;size&nbsp;&nbsp;100&nbsp;($sp&nbsp;+&nbsp;-0x50&nbsp;[-20&nbsp;dwords])<br />References&nbsp;to&nbsp;pattern&nbsp;buffer&nbsp;found&nbsp;at:<br />0xf7fa65cc&nbsp;:&nbsp;0x0804a160&nbsp;(/usr/lib32/libc-2.29.so)<br />0xf7fa65d0&nbsp;:&nbsp;0x0804a160&nbsp;(/usr/lib32/libc-2.29.so)<br />0xf7fa65d4&nbsp;:&nbsp;0x0804a160&nbsp;(/usr/lib32/libc-2.29.so)<br />0xf7fa65d8&nbsp;:&nbsp;0x0804a160&nbsp;(/usr/lib32/libc-2.29.so)<br />0xf7fa65dc&nbsp;:&nbsp;0x0804a160&nbsp;(/usr/lib32/libc-2.29.so)<br />0xffffcfb4&nbsp;:&nbsp;0x0804a160&nbsp;($sp&nbsp;+&nbsp;-0x1dc&nbsp;[-119&nbsp;dwords])<br />0xffffd058&nbsp;:&nbsp;0x0804a160&nbsp;($sp&nbsp;+&nbsp;-0x138&nbsp;[-78&nbsp;dwords])<br />0xffffd10c&nbsp;:&nbsp;0xffffd140&nbsp;($sp&nbsp;+&nbsp;-0x84&nbsp;[-33&nbsp;dwords])<br />0xffffd130&nbsp;:&nbsp;0xffffd140&nbsp;($sp&nbsp;+&nbsp;-0x60&nbsp;[-24&nbsp;dwords])</div></div></div>
</body>
</html>
