<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>EAT Hooking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Export Address Table (EAT) Hooking</h1></strong><br />• <a href="https://wikileaks.org/ciav7p1/cms/page_17072425.html">https://wikileaks.org/ciav7p1/cms/page_17072425.html</a><br />• <a href="https://www.unknowncheats.me/forum/c-and-c/50426-eat-hooking-dlls.html">https://www.unknowncheats.me/forum/c-and-c/50426-eat-hooking-dlls.html</a><br />• <a href="https://megamandos.blogspot.com/2012/03/export-address-table-hooking-what-why.html">https://megamandos.blogspot.com/2012/03/export-address-table-hooking-what-why.html</a><br />• <a href="https://gist.github.com/denikson/93ea22c1f4e79e68466a26cbfc58af05">https://gist.github.com/denikson/93ea22c1f4e79e68466a26cbfc58af05</a><br />• <a href="https://www.programmersought.com/article/13142085517/">https://www.programmersought.com/article/13142085517/</a><br />• <a href="https://github.com/stevemk14ebr/PolyHook_2_0/blob/master/sources/EatHook.cpp">https://github.com/stevemk14ebr/PolyHook_2_0/blob/master/sources/EatHook.cpp</a><br />• <a href="https://www.unknowncheats.me/forum/c-and-c/60351-iat-eat-hook-annotations.html">https://www.unknowncheats.me/forum/c-and-c/60351-iat-eat-hook-annotations.html</a><br />• <a href="https://github.com/i-saint/scribble/blob/master/hook/OverrideDLLExport.cpp">https://github.com/i-saint/scribble/blob/master/hook/OverrideDLLExport.cpp</a><br /><br />Hook functions in a target DLL by modifying its export address table.<br /><br /><strong>According the CIA Vault 7 leak:</strong><br />&quot;The best way to ensure this (EAT hooking) works properly is to start the target process suspended, <br />create a thread that loads the target DLL and performs the hook, then resume the process.&quot;<br /><br />You want to modify a DLL&#39;s Export Address Table before the process populates its Import Table.<br />You can do this by starting the process as suspended.<br />The process will have loaded its requried DLLs, but it won&#39;t have populated the Import Table yet (I don&#39;t think).<br /><br />With the DLLs loaded, you can modify the functions you want to hook in the DLLs Export Table to point to your own code.<br />When you resume the process, the PE will populate its Import Table and written into it will be pointers to your hook code.<br /><br />&quot;Subsequent calls to LoadLibrary on the target DLL will return the reference to the already loaded library that has had its EAT entry for the target process patched.&quot;<br /><br /></div>
</body>
</html>
