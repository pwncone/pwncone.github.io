<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>80,443 - HTTP/s</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port 80/443 - HTTP &amp; HTTPS</h1></strong><br />There&#39;s lots going on here.<br />Websites are a good place to perform recon and find a potential entry point into the target.<br /><br /><strong><h2>## Tips</h2></strong><br /><strong><h3>### Use</h3></strong><strong><h3> Burp as a proxy</h3></strong><strong><h3>!</h3></strong><br />Always browse through the website with Burp set up as a proxy.<br />It makes it easy to look at what the web requests are doing, keeps a record of where you&#39;ve been, and is just generally helpful. You spot things you otherwise wouldn&#39;t by checking the raw web requests occasionally.<br /><br /><strong><h3>### Read Config files</h3></strong><br />Have a shell on the system/can read restricted files?<br />Read either <code>httpd.conf</code> or <code>.htaccess</code> to see if you can find the config/setup of the web page, as the configuration might point towards to restricted or otherwise hidden parts of the site which have restricted access<br />e.g. limited to a certain user agent, or restricted to certain IPs like internal IPs<br /><br /><code>/etc/apache22/httpd.conf</code><br /><code>.htaccess</code><br /><br /><strong><h3>### 80 vs. 443 / HTTP vs HTTPS</h3></strong><br />MAKE SURE TO CHECK THE WEBSITES ON BOTH PORTS 80 AND 443!<br />In some cases they might be different websites entirely, or have slight differences. <br />Both are worth investigating.<br /><br /><strong><h2>## Checklist</h2></strong><br /><strong><h3>### Recon</h3></strong><br />• Check for WAF<br />   ◇ <code>wafw00f http://website.com</code><br />• Set up Burp and proxy all your traffic through it<br />• Find server version and web technologies<br />   ◇ <code>nmap</code><br />   ◇ <code>whatweb</code><br />   ◇ <code>webtech</code><br />   ◇ CHECK THE WEB SERVER &amp; ALL TECHNOLOGIES FOR VULNS<br />• Check for virtual hosting<br />   ◇ Access the site via IP - <code>http://10.11.0.120</code>       <br />   ◇ Edit /etc/hosts and access the site via hostname - <code>http://website.com</code><br /><br /><strong><h3>### On website</h3></strong><br />• Check for <code>robots.txt</code> and <code>sitemap.xml</code> and any 404 errors (errors can leak information)<br />• View-source of every page you visit and check for anything interesting<br />   ◇ Comments - <code>&lt;!--</code><br />   ◇ <code>&lt;head&gt;</code> tag might identify the site<br />   ◇ Search for <code>hidden</code> fields<br />   ◇ At login forms, check where the login form is being submitted<br />   ◇ Have a look at any <code>&lt;script&gt;</code> tags if they seem interesting<br />• Spider the site to get an overall picture of it<br />   ◇ <code>wget -r -m -nv http://www.example.org/</code><br />   ◇ <code>nmap -p &lt;port&gt; -Pn --script=http-sitemap-generator 10.10.10.45</code><br />   ◇ skipfish<br />   ◇ dirhunt<br />      ▪ Then grep the pages for useful info<br />• Use a web vuln scanner<br />   ◇ nikto<br />   ◇ uniscan<br />• Discover directories<br />   ◇ gobuster<br />   ◇ dirsearch - if you want recursive<br />      ▪ For every file extension you&#39;ve found, search for backups<br />      ▪ <code>file.ext~, #file.ext#, ~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old</code><br />• Browse the site yourself manually. Get a feel for it. Search for...<br />   ◇ URLs<br />      ▪ for SQL injection<br />      ▪ for LFI and RFI<br />      ▪ for web directory disclosure<br />   ◇ Places for user input<br />   ◇ File upload<br />• Found web app? Scan it with tool<br />   ◇ Found a strange web app? Try to find the source code somewhere<br />      ▪ check changelog/readme/version file for potential vulns<br />      ▪ how and where are credentials stored?<br />• Suspicious page / empty page?<br />   ◇ View-source<br />   ◇ Check Burp for redirects<br />• Really struggling? In-depth manual stuff<br />   ◇ Analyse cookies<br />   ◇ Check JavaScript code, might find...<br />      ▪ Obfuscated code<br />      ▪ Hardcoded info (passwords etc.)<br />      ▪ Exploitable API requests<br /><br /><strong><h3>### Found a login form?</h3></strong><br />• Check for password in source of web page<br />• Try to access the restricted pages &amp; login redirect directly<br />• Just click &#39;login&#39; (don&#39;t send anything) - see what happens<br />• Test common passwords<br />• Test default credenials (if any)<br />• Test for SQL injection in login form<br />• PHP comparisons error?<br />• Create CeWL dictionary -&gt; bruteforce login<br />• Bruteforce the login<br /><br /><strong><h3>### After finished with the site...</h3></strong><br />• Check for Virtual Hosts<br />   ◇ wfuzz<br />      ▪ <code>wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-20000.txt --hc 400,404,403 -H &quot;Host: FUZZ.example.com&quot; -u http://example.com -t 100</code><br />   ◇ <a href="https://github.com/allyshka/vhostbrute">https://github.com/allyshka/vhostbrute</a><br />      ▪ <code>vhostbrute.py --url=&quot;example.com&quot; --remoteip=&quot;10.1.1.15&quot; --base=&quot;www.example.com&quot; --vhosts=&quot;vhosts_full.list&quot;</code><br />• Find subdomains<br />   ◇ <a href="https://github.com/Edu4rdSHL/findomain/">https://github.com/Edu4rdSHL/findomain/</a><br />• Check for subdomain takeover<br />   ◇ <a href="https://github.com/haccer/subjack">https://github.com/haccer/subjack</a><br />   ◇ <a href="https://github.com/anshumanbh/tko-subs">https://github.com/anshumanbh/tko-subs</a><br />   ◇ <a href="https://github.com/EdOverflow/can-i-take-over-xyz">https://github.com/EdOverflow/can-i-take-over-xyz</a> (How to take over using different platforms)<br /><br /><strong><h2>## HTTPS Checklist</h2></strong><br />These are checks specific to HTTPS websites.<br /><br />• Read the SSL certificate<br />   ◇ <code>openssl s_client -showcerts -connect www.domain.com:443</code><br />• Check for SSL vulnerabilities<br />   ◇ <code>./testssl.sh --htmlfile --openssl-timeout 5 213.249.147.82:443</code><br />   ◇ <code>sslscan &lt;host:port&gt;</code><br />   ◇ <code>sslyze --regular &lt;ip:port&gt;</code><br />• Check for Heartbleed<br />   ◇ <code>sslscan 192.168.0.1:443<br /></code>   ◇ <code>nmap -sV --script=ssl-heartbleed 192.168.1.102</code><br />   ◇ Exploit heartbleed - <code>use auxiliary/scanner/ssl/openssl_heartbleed</code><br /><br /></div>
</body>
</html>
