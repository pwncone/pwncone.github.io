<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Evasion</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1># Evading Detection</h1><br />It will differ for every game.<br />Whether or not these detection vectors are implemented into the game or the anticheat or not <br />is a matter you&#39;ll have to find through reversing.<br /><br /><h3>### Inject in a Covert Manner</h3><br />Find/allocate memory, write your DLL, and execute your DLL.<br />All 3 of these need to be done in a covert manner.<br />Difficult.<br />More a topic for DLL injection than here.<br /><br /><h3>### Polymorphism</h3><br />This is only really a problem in paid cheats with multiple users.<br />An anticheat could detect a cheat vendor&#39;s DLL by creating a signature for it, and banning all signs of that signature.<br /><br />To make the cheat different for every user on every run, add some polymorphism to the cheat so that it can&#39;t be effectively signatured.<br /><br /><h3>### Obfuscation</h3><br />Common components and routines in cheats can be signatured:<br />ImGui, DllMain, etc.<br /><br />Get around this signature detection by obfuscating your code:<br />• LLVM<br />• VMProtect<br />• etc.<br /><br />• <a href="https://www.unknowncheats.me/forum/anti-cheat-bypass/445826-llvm-obfuscator-9-0-1-step-step-visual-studio.html?s=d4de0d6272bafd3f9f01a07557a2febc">https://www.unknowncheats.me/forum/anti-cheat-bypass/445826-llvm-obfuscator-9-0-1-step-step-visual-studio.html?s=d4de0d6272bafd3f9f01a07557a2febc</a><br /><br /><h3>### Compile without the CRunTime</h3><br />Similar to signature scanning for common components,<br />they might sig scan for the CRT startup routine contained at the beginning of your DLL.<br />This can detect manually mapped DLLs.<br />Compile without it in Visual Studio.<br /><br /><h3>### Don&#39;t AllocConsole</h3><br />AllocConsole will create a child window of the game. Don&#39;t do this. Games often detect child windows.<br />Write to a log file on the desktop instead or something.<br /><br /><h3>### Don&#39;t Create a Thread</h3><br />They can detect newly created threads.<br />Don&#39;t create a thread for your DLL.<br /><br /><h3>### Be Careful How You Hook</h3><br />Inline hooking can be detected by integrity checks (CRC).<br />VEH hooks can be detected.<br />SetWindowsLongPtr (for ImGui menus etc.) can be detected.<br /><br /><h3>### Be Careful What Functions You Call</h3><br />Common functions, like <code>sqrt</code> from msvcrt, are often hooked to detect foreign modules<br />calling these functions.<br /><br />If it&#39;s a CRunTime function that you can implement yourself (memcpy, etc.), do it.<br />If it&#39;s a Windows API function, syscall it instead.<br /><br /><h3>### Spoof Return Address If Calling Internal Functions</h3><br />If you&#39;re calling a game&#39;s internal function,<br />spoof the return address so that the game can&#39;t see that it&#39;s returning to your injected DLL / an untrusted region of memory / not back to the game&#39;s primary memory region.<br /></div>
</body>
</html>
