<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Password Cracking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Password Cracking - openssl</h1></strong><br />It&#39;s possible to encrypt files with <code>openssl</code>.<br /><br /><strong>Examples</strong><br />• hackthebox Hawk<br /><br /><div class="codebox"><div class="codebox">$&nbsp;file&nbsp;.drupal.txt.enc&nbsp;<br />.drupal.txt.enc:&nbsp;openssl&nbsp;enc&#39;d&nbsp;data&nbsp;with&nbsp;salted&nbsp;password,&nbsp;base64&nbsp;encoded</div></div><br /><br /><strong><h2>## Crack</h2></strong><br /><strong><h3>### john</h3></strong><br />john produces false positives when cracking, but you can try anyway.<br /><code>locate openssl2john</code><br /><code>/usr/share/john/openssl2john.py .drupal.txt.enc &gt; openssl.hash</code><br /><code>john --wordlist=/usr/share/wordlists/rockyou.txt openssl.hash</code><br /><br /><strong><h3>### bruteforce-salted-openssl</h3></strong><br /><a href="https://github.com/glv2/bruteforce-salted-openssl">https://github.com/glv2/bruteforce-salted-openssl</a><br />This is a tool designed to attack salted openssl encrypted files.<br /><br />Base64 decode the file first (if it&#39;s base64 encoded)<br /><code>cat .drupal.txt.enc | base64 -d &gt; drupal.txt.enc.b64d</code><br /><br />Bruteforce an OpenSSL 1.0.x MD5 hash<br /><code>bruteforce-salted-openssl -t 6 -f /usr/share/wordlists/rockyou.txt drupal.txt.enc.b64d -d md5</code><br /><br />Bruteforce an OpenSSL 1.1.x SHA256 hash<br /><code>bruteforce-salted-openssl -t 6 -f /usr/share/wordlists/rockyou.txt drupal.txt.enc.b64d -d sha256</code><br /><br /><strong><h2>### snowscan&#39;s Bash Script</h2></strong><br />&quot;I’ve tried using bruteforce-salted-openssl but that tool is shit so I made my own script that does the same thing&quot;<br /><div class="codebox"><div class="codebox">for&nbsp;pwd&nbsp;in&nbsp;$(cat&nbsp;/root/SecLists/Passwords/rockyou-75.txt)<br />&nbsp;&nbsp;do&nbsp;openssl&nbsp;enc&nbsp;-aes-256-cbc&nbsp;-d&nbsp;-a&nbsp;-in&nbsp;drupal.txt.enc&nbsp;-out&nbsp;file.txt&nbsp;-k&nbsp;$pwd<br />&nbsp;&nbsp;if&nbsp;[&nbsp;$?&nbsp;-eq&nbsp;0&nbsp;]<br />&nbsp;&nbsp;then<br />&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1<br />&nbsp;&nbsp;fi<br />done</div></div><code><br /></code><br /><strong><h2>## Decrypt with openssl</h2></strong><br /><code>-d</code> = decrypt<br /><code>openssl enc -aes-256-cbc -d -in drupal.enc -out drupal.txt</code></div>
</body>
</html>
