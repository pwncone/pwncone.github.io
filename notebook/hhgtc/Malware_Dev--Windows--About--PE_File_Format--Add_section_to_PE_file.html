<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Add section to PE file</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Add section to PE file</h1></strong><br />To add a section to a PE file, you need to:<br />• add the new section info into the PE header<br />• update the PE header<br />   ◇ increase the number of sections by 1<br />   ◇ increase the SizeOfImage by the amount of data you&#39;ve added<br />• write the added data at the PointerToRawData address and save the new file<br /><br />In CFF Explorer, it gives you the option to <code>Add Section</code><br />• just in the PE header<br />• in the PE header + add empty space<br />• in the PE header + create empty space + write data to empty space (add section + data)<br /><a href=""><img src="images/1532-1.png" alt="images/1532-1.png" /></a><br /><br />To add a section just in the PE header, you just do the first step above and only add the new section info into the PE header.<br />To add a section + empty space, you add the new section info into the PE header and allocate extra space to the end of the file.<br />To add a section + create space + write data to section you do all of the above and write the data into the added empty space.<br /><br /><strong>Links</strong><br />• <a href="https://github.com/hMihaiDavid/addscn/tree/master/addscn">https://github.com/hMihaiDavid/addscn/tree/master/addscn</a><br />• <a href="https://www.codeproject.com/Articles/12532/Inject-your-code-to-a-Portable-Executable-file">https://www.codeproject.com/Articles/12532/Inject-your-code-to-a-Portable-Executable-file</a><br />• <a href="http://www.rohitab.com/discuss/topic/41911-pe-header-sections/">http://www.rohitab.com/discuss/topic/41911-pe-header-sections/</a><br />• <a href="http://www.rohitab.com/discuss/topic/41466-add-a-new-pe-section-code-inside-of-it/">http://www.rohitab.com/discuss/topic/41466-add-a-new-pe-section-code-inside-of-it/</a><br /><br /><strong><h2>## Notes</h2></strong><br /><strong><h3>### Aligning the Section</h3></strong><br />The inserted section data needs to be aligned.<br />Virtual data needs to be aligned to the system&#39;s default page size. (<code>0x1000</code> / <code>4096</code> bytes usually)<br />Raw data needs to be aligned to a value divisiable by 2 between 512 and 64k. <code>512k</code> is default (<code>0x200</code> hex)<br /><br />Here&#39;s a section I added to a PE file. I only added 8 bytes of data.<br />The virtual size has been aligned to <code>0x1000</code> bytes (4096 decimal)<br />And the raw size has been aligned to <code>0x200</code> bytes (512 decimal)<br /><a href=""><img src="images/1532-2.png" alt="images/1532-2.png" /></a><br /><br />There&#39;s multiple methods of calculating aligned values (2 examples I found):<br /><div class="codebox"><div class="codebox">//&nbsp;Source:&nbsp;https://blogs.oracle.com/jwadams/macros-and-powers-of-two<br />#define&nbsp;P2ALIGNUP(x,&nbsp;align_value)&nbsp;(-(-(x)&nbsp;&amp;&nbsp;-(align)))		//&nbsp;align&nbsp;x&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;align.&nbsp;align&nbsp;must&nbsp;be&nbsp;a&nbsp;power&nbsp;of&nbsp;2.<br />#define&nbsp;P2ALIGNDOWN(x,&nbsp;align_value)&nbsp;((x)&nbsp;&amp;&nbsp;-(align))		//&nbsp;align&nbsp;x&nbsp;down&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;align.&nbsp;align&nbsp;must&nbsp;be&nbsp;a&nbsp;power&nbsp;of&nbsp;2.<br /><br />/*<br />Source&nbsp;here:&nbsp;http://www.rohitab.com/discuss/topic/41466-add-a-new-pe-section-code-inside-of-it/<br />Align&nbsp;a&nbsp;value&nbsp;to&nbsp;an&nbsp;address.<br />	curr_value&nbsp;is&nbsp;the&nbsp;value&nbsp;to&nbsp;align.<br />	align_value&nbsp;is&nbsp;how&nbsp;to&nbsp;align&nbsp;it&nbsp;(page&nbsp;size,&nbsp;etc.)<br />	target_addr&nbsp;is&nbsp;where&nbsp;to&nbsp;align&nbsp;the&nbsp;value&nbsp;to.<br />*/<br />DWORD&nbsp;align(DWORD&nbsp;curr_value,&nbsp;DWORD&nbsp;align_value,&nbsp;size_t&nbsp;target_addr)<br />{<br />	if&nbsp;(!(curr_value&nbsp;%&nbsp;align_value))<br />		return&nbsp;target_addr&nbsp;+&nbsp;curr_value;<br /><br />	return&nbsp;target_addr&nbsp;+&nbsp;(curr_value&nbsp;/&nbsp;align_value&nbsp;+&nbsp;1)&nbsp;*&nbsp;align_value;<br />}<br /><br />//&nbsp;New&nbsp;section&nbsp;is&nbsp;aligned&nbsp;after&nbsp;last&nbsp;section&nbsp;in&nbsp;PE&nbsp;file<br />new_section-&gt;Misc.VirtualSize&nbsp;=&nbsp;align(data_size,&nbsp;pe_header-&gt;OptionalHeader.SectionAlignment,&nbsp;0);<br />new_section-&gt;VirtualAddress&nbsp;=&nbsp;align(last_section-&gt;Misc.VirtualSize,&nbsp;pe_header-&gt;OptionalHeader.SectionAlignment,&nbsp;last_section-&gt;VirtualAddress);<br />new_section-&gt;SizeOfRawData&nbsp;=&nbsp;align(data_size,&nbsp;pe_header-&gt;OptionalHeader.FileAlignment,&nbsp;0);<br />new_section-&gt;PointerToRawData&nbsp;=&nbsp;align(last_section-&gt;SizeOfRawData,&nbsp;pe_header-&gt;OptionalHeader.FileAlignment,&nbsp;last_section-&gt;PointerToRawData);</div></div><br /><br /><strong><h3>### Section Characteristics</h3></strong><br />• <a href="https://github.com/hMihaiDavid/addscn/blob/ba01c4e69a8f8a5b1e8b9daa49bd93b621317b4a/addscn/addscn.cpp#L178">https://github.com/hMihaiDavid/addscn/blob/ba01c4e69a8f8a5b1e8b9daa49bd93b621317b4a/addscn/addscn.cpp#L178</a><br /><br />Flags for section characteristics can be found here:<br /><a href="https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_section_header">https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_section_header</a><br /><br />This characteristics example is from a 32bit <code>notepad.exe</code><br />(apart from the .rdata section which is from 64bit calc.exe)<br /><br /><a href=""><img src="images/1532-3.png" alt="images/1532-3.png" /></a><br /><br /><strong>.text</strong><br />Typical <code>.text</code> characteristics = <code>60000020</code><br /><code>IMAGE_SCN_CNT_CODE | IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE;</code><br />Section contains code, section is executable, section is readable.<br /><br /><strong>.data</strong><br />Typical <code>.data</code> characteristics = <code>C0000040</code><br /><code>IMAGE_SCN_CNT_INITIALIZED_DATA | IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE;</code><br />Initialized data, readable, writable.<br /><br /><strong>.rdata</strong> (read-only data)<br />Typical .rdata characteristics = <code>40000040</code><br /><code>IMAGE_SCN_CNT_INITIALIZED_DATA | IMAGE_SCN_MEM_READ;</code><br />Initialized data, readable.<br /><br /><strong>.rsrc</strong><br />Typical .rsrc characteristics = <code>40000040</code><br /><code>IMAGE_SCN_CNT_INITIALIZED_DATA | IMAGE_SCN_MEM_READ;</code><br />Initialized data, readable.<br /><br /><strong>Make it everything - 0xE00000E0</strong><br />A <code>0xE00000E0</code> flag sets all the things:<br />read/write/execute/code/initialized data/unitialized data<br /><div class="codebox"><div class="codebox">IMAGE_SCN_MEM_WRITE&nbsp;|<br />IMAGE_SCN_CNT_CODE&nbsp;&nbsp;|<br />IMAGE_SCN_CNT_UNINITIALIZED_DATA&nbsp;&nbsp;|<br />IMAGE_SCN_MEM_EXECUTE&nbsp;|<br />IMAGE_SCN_CNT_INITIALIZED_DATA&nbsp;|<br />IMAGE_SCN_MEM_READ</div></div><br /><br /><strong><h2>## Example Code</h2></strong><br />In this example I&#39;ve created a new section, added data to it, and written the modified PE out to a new file.<br /><div class="codebox"><div class="codebox">/*<br />Open&nbsp;a&nbsp;PE&nbsp;file&nbsp;and&nbsp;add&nbsp;a&nbsp;section&nbsp;to&nbsp;it.<br />Write&nbsp;out&nbsp;the&nbsp;modified&nbsp;PE&nbsp;to&nbsp;a&nbsp;new&nbsp;file.<br />*/<br /><br />#include&nbsp;&lt;stdio.h&gt;<br />#include&nbsp;&lt;Windows.h&gt;<br /><br />//&nbsp;Source:&nbsp;https://blogs.oracle.com/jwadams/macros-and-powers-of-two<br />#define&nbsp;P2ALIGNUP(x,&nbsp;align_value)&nbsp;(-(-(x)&nbsp;&amp;&nbsp;-(align)))		//&nbsp;align&nbsp;x&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;align.&nbsp;align&nbsp;must&nbsp;be&nbsp;a&nbsp;power&nbsp;of&nbsp;2.<br />#define&nbsp;P2ALIGNDOWN(x,&nbsp;align_value)&nbsp;((x)&nbsp;&amp;&nbsp;-(align))		//&nbsp;align&nbsp;x&nbsp;down&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;align.&nbsp;align&nbsp;must&nbsp;be&nbsp;a&nbsp;power&nbsp;of&nbsp;2.<br /><br />/*<br />Source&nbsp;here:&nbsp;http://www.rohitab.com/discuss/topic/41466-add-a-new-pe-section-code-inside-of-it/<br />Align&nbsp;a&nbsp;value&nbsp;to&nbsp;an&nbsp;address.<br />	curr_value&nbsp;is&nbsp;the&nbsp;value&nbsp;to&nbsp;align.<br />	align_value&nbsp;is&nbsp;how&nbsp;to&nbsp;align&nbsp;it&nbsp;(page&nbsp;size,&nbsp;etc.)<br />	target_addr&nbsp;is&nbsp;where&nbsp;to&nbsp;align&nbsp;the&nbsp;value&nbsp;to.<br />*/<br />DWORD&nbsp;align(DWORD&nbsp;curr_value,&nbsp;DWORD&nbsp;align_value,&nbsp;size_t&nbsp;target_addr)<br />{<br />	if&nbsp;(!(curr_value&nbsp;%&nbsp;align_value))<br />		return&nbsp;target_addr&nbsp;+&nbsp;curr_value;<br /><br />	return&nbsp;target_addr&nbsp;+&nbsp;(curr_value&nbsp;/&nbsp;align_value&nbsp;+&nbsp;1)&nbsp;*&nbsp;align_value;<br />}<br /><br />/*<br />Add&nbsp;a&nbsp;new&nbsp;section&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;PE&nbsp;file<br />and&nbsp;write&nbsp;the&nbsp;modified&nbsp;PE&nbsp;out&nbsp;to&nbsp;a&nbsp;new&nbsp;file.<br />Written&nbsp;as&nbsp;1&nbsp;large&nbsp;function&nbsp;because&nbsp;it&nbsp;makes&nbsp;resizing&nbsp;the&nbsp;PE&nbsp;buffer&nbsp;to&nbsp;store&nbsp;the&nbsp;new&nbsp;data&nbsp;easier.<br /><br />0xE00000E0&nbsp;characteristics:<br />	IMAGE_SCN_MEM_WRITE&nbsp;|<br />	IMAGE_SCN_CNT_CODE&nbsp;&nbsp;|<br />	IMAGE_SCN_CNT_UNINITIALIZED_DATA&nbsp;&nbsp;|<br />	IMAGE_SCN_MEM_EXECUTE&nbsp;|<br />	IMAGE_SCN_CNT_INITIALIZED_DATA&nbsp;|<br />	IMAGE_SCN_MEM_READ<br /><br />Parameters:<br />	char*&nbsp;pe_infile&nbsp;-&nbsp;file&nbsp;path&nbsp;to&nbsp;the&nbsp;PE&nbsp;file&nbsp;to&nbsp;open<br />	char*&nbsp;pe_outfile&nbsp;-&nbsp;path&nbsp;of&nbsp;the&nbsp;new&nbsp;PE&nbsp;to&nbsp;write&nbsp;out<br />	void*&nbsp;data_buf&nbsp;-&nbsp;the&nbsp;data&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;section<br />	DWORD&nbsp;data_size&nbsp;-&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;data&nbsp;to&nbsp;add<br />	char*&nbsp;new_sectionname&nbsp;-&nbsp;name&nbsp;of&nbsp;the&nbsp;new&nbsp;section<br />*/<br />BOOL&nbsp;AppendSectionToPEFile(char*&nbsp;pe_infile,&nbsp;char*&nbsp;pe_outfile,&nbsp;char*&nbsp;data_buf,&nbsp;DWORD&nbsp;data_size,&nbsp;char*&nbsp;new_sectionname)<br />{<br />	BOOL&nbsp;ok&nbsp;=&nbsp;TRUE;<br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br /><br />	//&nbsp;Open&nbsp;target&nbsp;PE&nbsp;file&nbsp;&amp;&nbsp;read&nbsp;into&nbsp;buffer<br />	HANDLE&nbsp;h_infile&nbsp;=&nbsp;NULL;<br />	HANDLE&nbsp;h_outfile&nbsp;=&nbsp;NULL;<br />	DWORD&nbsp;pe_size&nbsp;=&nbsp;0;<br />	void*&nbsp;pe_buf&nbsp;=&nbsp;NULL;<br /><br />	h_infile&nbsp;=&nbsp;CreateFileA(pe_infile,&nbsp;GENERIC_READ&nbsp;|&nbsp;GENERIC_WRITE,&nbsp;0,&nbsp;NULL,&nbsp;OPEN_EXISTING,&nbsp;FILE_ATTRIBUTE_NORMAL,&nbsp;NULL);<br />	if&nbsp;(h_infile&nbsp;==&nbsp;INVALID_HANDLE_VALUE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;open&nbsp;target&nbsp;PE&nbsp;file:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		ok&nbsp;=&nbsp;FALSE;<br />		goto&nbsp;cleanup;<br />	}<br /><br />	pe_size&nbsp;=&nbsp;GetFileSize(h_infile,&nbsp;NULL);<br />	pe_buf&nbsp;=&nbsp;malloc(pe_size);<br />	b&nbsp;=&nbsp;ReadFile(h_infile,&nbsp;pe_buf,&nbsp;pe_size,&nbsp;NULL,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;read&nbsp;file&nbsp;into&nbsp;buffer:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		ok&nbsp;=&nbsp;FALSE;<br />		goto&nbsp;cleanup;<br />	}<br /><br />	//&nbsp;Check&nbsp;it&#39;s&nbsp;a&nbsp;valid&nbsp;PE<br />	PIMAGE_DOS_HEADER&nbsp;dos_header&nbsp;=&nbsp;(PIMAGE_DOS_HEADER)pe_buf;<br />	PIMAGE_NT_HEADERS&nbsp;pe_header&nbsp;=&nbsp;(PIMAGE_NT_HEADERS)((size_t)pe_buf&nbsp;+&nbsp;dos_header-&gt;e_lfanew);<br />	PIMAGE_SECTION_HEADER&nbsp;section&nbsp;=&nbsp;IMAGE_FIRST_SECTION(pe_header);<br />	PIMAGE_SECTION_HEADER&nbsp;last_section&nbsp;=&nbsp;(IMAGE_FIRST_SECTION(pe_header)&nbsp;+&nbsp;pe_header-&gt;FileHeader.NumberOfSections)&nbsp;-&nbsp;1;<br />	PIMAGE_SECTION_HEADER&nbsp;new_section&nbsp;=&nbsp;last_section&nbsp;+&nbsp;1;<br /><br />	if&nbsp;(dos_header-&gt;e_magic&nbsp;!=&nbsp;IMAGE_DOS_SIGNATURE)<br />	{<br />		printf(&quot;[-]&nbsp;PE&nbsp;infile&nbsp;not&nbsp;a&nbsp;valid&nbsp;DOS&nbsp;file&nbsp;\n&quot;);<br />		goto&nbsp;cleanup;<br />	}<br />	if&nbsp;(pe_header-&gt;Signature&nbsp;!=&nbsp;IMAGE_NT_SIGNATURE)<br />	{<br />		printf(&quot;[-]&nbsp;infile&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;PE&nbsp;file&nbsp;\n&quot;);<br />		goto&nbsp;cleanup;<br />	}<br /><br />	//&nbsp;Write&nbsp;new&nbsp;section&nbsp;info&nbsp;into&nbsp;PE&nbsp;header<br />	memset(new_section,&nbsp;0,&nbsp;sizeof(IMAGE_SECTION_HEADER));<br />	memcpy_s(new_section-&gt;Name,&nbsp;8,&nbsp;new_sectionname,&nbsp;8);		//&nbsp;max&nbsp;section&nbsp;name&nbsp;length&nbsp;is&nbsp;8&nbsp;bytes<br />	new_section-&gt;Misc.VirtualSize&nbsp;=&nbsp;align(data_size,&nbsp;pe_header-&gt;OptionalHeader.SectionAlignment,&nbsp;0);<br />	new_section-&gt;VirtualAddress&nbsp;=&nbsp;align(last_section-&gt;Misc.VirtualSize,&nbsp;pe_header-&gt;OptionalHeader.SectionAlignment,&nbsp;last_section-&gt;VirtualAddress);<br />	new_section-&gt;SizeOfRawData&nbsp;=&nbsp;align(data_size,&nbsp;pe_header-&gt;OptionalHeader.FileAlignment,&nbsp;0);<br />	new_section-&gt;PointerToRawData&nbsp;=&nbsp;align(last_section-&gt;SizeOfRawData,&nbsp;pe_header-&gt;OptionalHeader.FileAlignment,&nbsp;last_section-&gt;PointerToRawData);<br />	new_section-&gt;Characteristics&nbsp;=&nbsp;0xE00000E0;<br /><br />	//&nbsp;Update&nbsp;PE&nbsp;header&nbsp;with&nbsp;+1&nbsp;section&nbsp;and&nbsp;increased&nbsp;size<br />	pe_header-&gt;FileHeader.NumberOfSections&nbsp;+=&nbsp;1;<br />	pe_header-&gt;OptionalHeader.SizeOfImage&nbsp;=&nbsp;pe_header-&gt;OptionalHeader.SizeOfImage&nbsp;+&nbsp;data_size;<br /><br />	/*&nbsp;<br />	Resize&nbsp;PE&nbsp;buffer&nbsp;to&nbsp;store&nbsp;new&nbsp;data&nbsp;<br />	New&nbsp;size&nbsp;should&nbsp;be&nbsp;(pe_size&nbsp;+&nbsp;data_size&nbsp;after&nbsp;alignment)<br />	(pe_size&nbsp;+&nbsp;data_size)&nbsp;doesn&#39;t&nbsp;allocate&nbsp;enough&nbsp;space.<br />	Therefore,&nbsp;SizeOfRawData&nbsp;is&nbsp;used&nbsp;because&nbsp;it&#39;s&nbsp;aligned.<br />	*/<br />	DWORD&nbsp;final_pe_size&nbsp;=&nbsp;pe_size&nbsp;+&nbsp;new_section-&gt;SizeOfRawData;<br />	void*&nbsp;tmp_pointer&nbsp;=&nbsp;realloc(pe_buf,&nbsp;final_pe_size);<br />	if&nbsp;(tmp_pointer&nbsp;==&nbsp;NULL)<br />		goto&nbsp;cleanup;<br />	else<br />		pe_buf&nbsp;=&nbsp;tmp_pointer;<br /><br />	//&nbsp;Write&nbsp;data&nbsp;into&nbsp;new&nbsp;section<br />	void*&nbsp;rawdata_addr&nbsp;=&nbsp;(void*)((size_t)pe_buf&nbsp;+&nbsp;new_section-&gt;PointerToRawData);<br />	memset(rawdata_addr,&nbsp;0,&nbsp;new_section-&gt;SizeOfRawData);<br />	memcpy_s(rawdata_addr,&nbsp;new_section-&gt;SizeOfRawData,&nbsp;data_buf,&nbsp;data_size);<br /><br />	//&nbsp;Write&nbsp;buffer&nbsp;out&nbsp;to&nbsp;new&nbsp;file<br />	h_outfile&nbsp;=&nbsp;CreateFileA(pe_outfile,&nbsp;GENERIC_READ&nbsp;|&nbsp;GENERIC_WRITE,&nbsp;0,&nbsp;NULL,&nbsp;CREATE_ALWAYS,&nbsp;FILE_ATTRIBUTE_NORMAL,&nbsp;NULL);<br />	if&nbsp;(h_outfile&nbsp;==&nbsp;INVALID_HANDLE_VALUE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;create&nbsp;output&nbsp;file:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		ok&nbsp;=&nbsp;FALSE;<br />		goto&nbsp;cleanup;<br />	}<br /><br />	DWORD&nbsp;bytes_written&nbsp;=&nbsp;0;<br />	b&nbsp;=&nbsp;WriteFile(h_outfile,&nbsp;pe_buf,&nbsp;final_pe_size,&nbsp;&amp;bytes_written,&nbsp;NULL);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;write&nbsp;buffer&nbsp;out&nbsp;to&nbsp;file:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		ok&nbsp;=&nbsp;FALSE;<br />		goto&nbsp;cleanup;<br />	}<br /><br />cleanup:<br />	if&nbsp;(h_infile)&nbsp;CloseHandle(h_infile);<br />	if&nbsp;(h_outfile)&nbsp;CloseHandle(h_outfile);<br />	if&nbsp;(pe_buf)&nbsp;free(pe_buf);<br /><br />	return&nbsp;ok;<br />}<br /><br />int&nbsp;main(void)<br /><span style="color:#000000;font-weight:400">{</span><br />	BOOL&nbsp;b&nbsp;=&nbsp;FALSE;<br />	char&nbsp;pe_infile[]&nbsp;=&nbsp;&quot;C:\\Users\\Bob\\Desktop\\tmp\\notepad32.exe&quot;;<br />	char&nbsp;pe_outfile[]&nbsp;=&nbsp;&quot;C:\\Users\\Bob\\Desktop\\tmp\\mo_sections.exe&quot;;<br />	char&nbsp;section_name[8]&nbsp;=&nbsp;&quot;.hey&quot;;		//&nbsp;max&nbsp;section&nbsp;name&nbsp;length&nbsp;is&nbsp;8&nbsp;bytes&nbsp;e.g.&nbsp;&quot;.bigtest&quot;<br /><br />	char*&nbsp;data&nbsp;=&nbsp;&quot;much&nbsp;nightowl&nbsp;very&nbsp;code&nbsp;O_O&quot;;<br />	b&nbsp;=&nbsp;AppendSectionToPEFile(pe_infile,&nbsp;pe_outfile,&nbsp;data,&nbsp;strlen(data),&nbsp;section_name);<br />	if&nbsp;(b&nbsp;==&nbsp;FALSE)<br />		return&nbsp;1;<br /><br />	printf(&quot;[+]&nbsp;done!&nbsp;\n&quot;);<br />	printf(&quot;[*]&nbsp;added&nbsp;%s&nbsp;to&nbsp;%s&nbsp;\n&quot;,&nbsp;section_name,&nbsp;pe_outfile);<br /><br />	return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><a href=""><img src="images/1532-4.png" alt="images/1532-4.png" /></a></div>
</body>
</html>
