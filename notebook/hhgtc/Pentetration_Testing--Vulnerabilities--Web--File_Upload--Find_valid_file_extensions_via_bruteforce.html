<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Find valid file extensions via bruteforce</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># File Upload - Find valid file extensions via bruteforce</h1></strong><br />If every file extension you upload seems to be blocked, you can trying using a wordlist and bruteforcing file uploads until you&#39;ve found a valid extension<br /><br /><strong><h2>## with Burp Intruder</h2></strong><br />This is made quite easy using Burp Intruder.<br />You can grab a file extension list and a bruteforce upload files until one&#39;s successful.<br /><br /><strong><h3>### 1) Set up burp as a proxy and capture an ‘upload file’ request by uploading a file to the webserver </h3></strong><br />You should see the request under the Proxy &gt; HTTP history tab<br />Copy/paste the entire request under Raw &gt; Request into Intruder &gt; Positions<br /><a href=""><img src="images/169-1.png" alt="images/169-1.png" /></a><br /><br /><a href=""><img src="images/169-2.png" alt="images/169-2.png" /></a><br /><br /><br /><strong><h3>### 2) Highlight the file extension in the upload request and click </h3></strong><strong><code><h3>Add §</h3></code></strong><br />This will mark the file extension as the string you want to bruteforce<br /><a href=""><img src="images/169-3.png" alt="images/169-3.png" /></a><br /><br /><strong><h3>### 3) Configure target</h3></strong><br />Under <code>Target</code>, set the Host and Port<br /><a href=""><img src="images/169-4.png" alt="images/169-4.png" /></a><br /><br /><strong><h3>### 4) Payload Options - Set wordlist</h3></strong><br />Under Intruder &gt; Payloads input your list of file extensions to bruteforce in Payload Options<br /><a href=""><img src="images/169-5.png" alt="images/169-5.png" /></a><br /><br /><strong><h3>### 5) Set success flag</h3></strong><br />You need to be able to tell when a file has uploaded successfully.<br />I know that, on this site, when a file uploads successfully the web page prints a <code>File uploaded successfully!</code> string.<br />Under <code>Intruder</code> &gt; <code>Options</code> &gt; <code>Grep - Match</code>, I added a string of &quot;uploaded&quot; that Burp will search the requrest response for to notify me if a file uploaded successfully.<br /><br />If you don&#39;t have/don&#39;t know/can&#39;t get a success string, you can observe the length of the responses in the results.<br />If a certain file extension has a different response than the rest of the attempts, that means something different has happened and you should check the response manaully.<br /><br /><a href=""><img src="images/169-6.png" alt="images/169-6.png" /></a><br /><br /><strong><h3>### 6) Start attack</h3></strong><br />Start the attack and wait for th results.<br />Burp slows their attack down after the first few requests because they want you to buy premium.<br /><br /><a href=""><img src="images/169-7.png" alt="images/169-7.png" /></a> </div>
</body>
</html>
