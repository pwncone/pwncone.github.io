<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>List all files in directory</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># List all files in a directory</h1></strong><br />This function is recursive because it calls itself.<br /><div class="codebox"><div class="codebox">BOOL&nbsp;ListFiles(const&nbsp;char*&nbsp;dir)<br />{<br />	BOOL&nbsp;okay&nbsp;=&nbsp;TRUE;<br />	HANDLE&nbsp;h_search&nbsp;=&nbsp;NULL;<br />	WIN32_FIND_DATAA&nbsp;file_data&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />	char&nbsp;search_path[2048]&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br />	char&nbsp;file_path[2048]&nbsp;=&nbsp;{&nbsp;0&nbsp;};<br /><br />	sprintf_s(search_path,&nbsp;2047,&nbsp;&quot;%s\\*.*&quot;,&nbsp;dir);<br /><br />	h_search&nbsp;=&nbsp;FindFirstFileA(search_path,&nbsp;&amp;file_data);<br />	if&nbsp;(h_search&nbsp;==&nbsp;INVALID_HANDLE_VALUE)<br />	{<br />		printf(&quot;[-]&nbsp;failed&nbsp;to&nbsp;find&nbsp;file:&nbsp;%d&nbsp;\n&quot;,&nbsp;GetLastError());<br />		return&nbsp;FALSE;<br />	}<br /><br />	do<br />	{<br />		//&nbsp;ignore&nbsp;&quot;.&quot;&nbsp;and&nbsp;&quot;..&quot;&nbsp;in&nbsp;the&nbsp;directory,&nbsp;which&nbsp;is&nbsp;what&nbsp;FindFirstFile&nbsp;will&nbsp;always&nbsp;find&nbsp;first<br />		if&nbsp;(strcmp(file_data.cFileName,&nbsp;&quot;.&quot;)&nbsp;!=&nbsp;0&nbsp;&amp;&amp;&nbsp;strcmp(file_data.cFileName,&nbsp;&quot;..&quot;)&nbsp;!=&nbsp;0)<br />		{<br />			//&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;a&nbsp;directory<br />			if&nbsp;(file_data.dwFileAttributes&nbsp;&amp;&nbsp;FILE_ATTRIBUTE_DIRECTORY)<br />			{<br />				//&nbsp;build&nbsp;next&nbsp;search&nbsp;path&nbsp;using&nbsp;the&nbsp;file&nbsp;we&nbsp;just&nbsp;found&nbsp;&amp;&nbsp;search&nbsp;that&nbsp;directory<br />				sprintf_s(search_path,&nbsp;2047,&nbsp;&quot;%s\\%s&quot;,&nbsp;dir,&nbsp;file_data.cFileName);<br />				ListFiles(search_path);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;recursion!<br />			}<br />			//&nbsp;if&nbsp;not&nbsp;a&nbsp;directory<br />			else<br />			{<br />				printf(&quot;%s&nbsp;\n&quot;,&nbsp;file_data.cFileName);<br />			}<br />		}<br />	}&nbsp;while&nbsp;(FindNextFileA(h_search,&nbsp;&amp;file_data));<br /><br />	FindClose(h_search);<br /><br />	return&nbsp;okay;<br />}<br /><br />int&nbsp;main(void)<br /><span style="color:#000000;font-weight:400">{</span><br />	ListFiles(&quot;C:\\&quot;);<br />	<br />	return&nbsp;0;<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><br /></div>
</body>
</html>
